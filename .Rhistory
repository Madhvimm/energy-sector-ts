model_output_e <- capture.output(sarima(returns_exxon,1,0,1))
#model_output_e
cat(model_output_e[22:34], model_output_e[length(model_output_e)], sep = "\n")
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
exxon.res<-fit_exxon$residuals
plot1 <- ggAcf(exxon.res, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
plot2<- ggPacf(exxon.res, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
grid.arrange(plot1, plot2,nrow=2)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
plot3 <- ggAcf(exxon.res^2, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
plot4<- ggPacf(exxon.res^2, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
grid.arrange(plot3, plot4,nrow=2)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
sarima(returns_chevron,0,0,1)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
chevron.res<-fit_chevron$residuals
plot5 <- ggAcf(chevron.res, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
plot6 <- ggPacf(chevron.res, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
grid.arrange(plot5, plot6,nrow=2)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
plot7 <- ggAcf(chevron.res^2, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
plot8 <- ggPacf(chevron.res^2, 40) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
grid.arrange(plot7,plot8,nrow=2)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model <- list()
cc <- 1
for (p in 1:9) {
for (q in 1:9) {
suppressWarnings({
model[[cc]] <- garch(exxon.res, order=c(p,q), trace=F)
})
cc <- cc + 1
}
}
## get AIC values for model evaluation
GARCH_AIC <- sapply(model, AIC) ## model with lowest AIC is the best
which(GARCH_AIC == min(GARCH_AIC))
model[[which(GARCH_AIC == min(GARCH_AIC))]]
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#Fit the GARCH(1,1) model on the residuals
garch_fit_exxon <- garchFit(~garch(1, 1), data = exxon.res, trace = F)
#Summary of the fitted GARCH model
summary(garch_fit_exxon)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model <- list() ## set counter
cc <- 1
for (p in 1:7) {
for (q in 1:7) {
model[[cc]] <- garch(chevron.res,order=c(q,p),trace=F)
cc <- cc + 1
}
}
## get AIC values for model evaluation
GARCH_AIC <- sapply(model, AIC) ## model with lowest AIC is the best
which(GARCH_AIC == min(GARCH_AIC))
model[[which(GARCH_AIC == min(GARCH_AIC))]]
summary(garchFit(~garch(1,1), chevron.res,trace = F))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model <- list()
cc <- 1
for (p in 1:9) {
for (q in 1:9) {
suppressWarnings({
model[[cc]] <- garch(returns_exxon, order=c(p,q), trace=F)
})
cc <- cc + 1
}
}
## get AIC values for model evaluation
GARCH_AIC <- sapply(model, AIC) ## model with lowest AIC is the best
which(GARCH_AIC == min(GARCH_AIC))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model[[which(GARCH_AIC == min(GARCH_AIC))]]
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
garch_fit_returns_exxon <- garchFit(~garch(1,1), data = returns_exxon, trace = F)
summary(garch_fit_returns_exxon)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
summary(fit_exxon)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
garch_exxon <- garchFit(~garch(1,1), exxon.res,trace = F)
summary(garch_exxon)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
summary(garch(exxon.res, order = c(1,1),trace = F))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
checkresiduals(garch(exxon.res, order = c(1,1),trace = F))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
garch_returns_exxon1 <- garch(returns_exxon, order = c(1,1), trace = F)
summary(garch_returns_exxon1)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
checkresiduals(garch_returns_exxon1)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
k <- 900
n <- length(returns_exxon)
err1 <- c()
err2 <- c()
for(i in 1:(n-k)) {
xtrain <- returns_exxon[1:(k-1)+i]
xtest <- returns_exxon[k+i]
# ARIMA(1,0,1) + GARCH(1,1)
arima.fit <- Arima(xtrain, order = c(1, 0, 1), include.drift = TRUE)
arima.res <- residuals(arima.fit)
fit1 <- garchFit(~garch(1, 1), data = arima.res, trace = FALSE)
fcast1 <- predict(fit1, n.ahead = 1)
# GARCH(1,1)
returns_diff <- diff(xtrain)
fit2 <- garchFit(~garch(1, 1), data = xtrain, trace = FALSE)
fcast2 <- predict(fit2, n.ahead = 1)
err1 <- c(err1, (fcast1$meanForecast - xtest)^2)
err2 <- c(err2, (fcast2$meanForecast - xtest)^2)
}
RMSE1 <- sqrt(mean(err1))
RMSE2 <- sqrt(mean(err2))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
cat("The RMSE for model 1 -", RMSE1, "\n")
cat("The RMSE for model 2 -", RMSE2, "\n")
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#Fit the ARIMA model
arima_exxon_final <- Arima(returns_exxon, order = c(1, 0, 1))
#Extract the residuals
residuals_exxon_final <- residuals(arima_exxon_final)
# Fit the GARCH model on the residuals
garch_exxon_final <- garchFit(~garch(1,1), data = residuals_exxon_final, trace = FALSE)
summary(garch_exxon_final)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
predict(garch_exxon_final, n.ahead = 100, plot = TRUE)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
ht <- garch_exxon_final@h.t
exxon_stockprice_df = data.frame(Exxon_stockprice)
exxon_stockprice_df <- head(exxon_stockprice_df, -1)
exxon_stockprice_df <- data.frame(exxon_stockprice_df,rownames(exxon_stockprice_df))
colnames(exxon_stockprice_df)[7] = "date"
exxon_stockprice_df$date<-as.Date(exxon_stockprice_df$date,"%Y-%m-%d")
data_spot = data.frame(ht,exxon_stockprice_df$date)
ggplot(data_spot, aes(y = ht, x = exxon_stockprice_df.date)) + geom_line() + ylab('Conditional Variance') + xlab('Date') +
theme_minimal() +
ggtitle("Volatility plot for Exxon Mobil Stock Price") +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model_output_c <- capture.output(sarima(returns_chevron,0,0,1))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model_output_c <- capture.output(sarima(returns_chevron,0,0,1))
model_output_c
#cat(model_output_c[22:34], model_output_c[length(model_output_c)], sep = "\n")
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model_output_c <- capture.output(sarima(returns_chevron,0,0,1))
#model_output_c
cat(model_output_c[11:23], model_output_c[length(model_output_c)], sep = "\n")
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model_output_c <- capture.output(sarima(returns_chevron,0,0,1))
#model_output_c
cat(model_output_c[11:22], model_output_c[length(model_output_c)], sep = "\n")
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model <- list()
cc <- 1
for (p in 1:9) {
for (q in 1:9) {
suppressWarnings({
model[[cc]] <- garch(chevron.res, order=c(p,q), trace=F)
})
cc <- cc + 1
}
}
## get AIC values for model evaluation
GARCH_AIC <- sapply(model, AIC) ## model with lowest AIC is the best
which(GARCH_AIC == min(GARCH_AIC))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model <- list()
cc <- 1
for (p in 1:9) {
for (q in 1:9) {
suppressWarnings({
model[[cc]] <- garch(chevron.res, order=c(p,q), trace=F)
})
cc <- cc + 1
}
}
## get AIC values for model evaluation
GARCH_AIC <- sapply(model, AIC) ## model with lowest AIC is the best
which(GARCH_AIC == min(GARCH_AIC))
model[[which(GARCH_AIC == min(GARCH_AIC))]]
best_model <- model[[which.min(GARCH_AIC)]]
summary(best_model)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#Fit the GARCH(1,1) model on the residuals
garch_fit_chevron <- garchFit(~garch(1, 1), data = chevron.res, trace = F)
#Summary of the fitted GARCH model
summary(garch_fit_chevron)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
model <- list()
cc <- 1
for (p in 1:9) {
for (q in 1:9) {
suppressWarnings({
model[[cc]] <- garch(returns_chevron, order=c(p,q), trace=F)
})
cc <- cc + 1
}
}
## get AIC values for model evaluation
GARCH_AIC <- sapply(model, AIC) ## model with lowest AIC is the best
which(GARCH_AIC == min(GARCH_AIC))
model[[which(GARCH_AIC == min(GARCH_AIC))]]
best_model <- model[[which.min(GARCH_AIC)]]
summary(best_model)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
garch_fit_returns_chevron <- garchFit(~garch(1,1), data = returns_chevron, trace = F)
summary(garch_fit_returns_chevron)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
summary(fit_chevron)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
garch_chevron <- garchFit(~garch(1,1), chevron.res,trace = F)
summary(garch_chevron)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
summary(garch(chevron.res, order = c(1,1),trace = F))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
checkresiduals(garch(chevron.res, order = c(1,1),trace = F))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
garch_returns_chevron1 <- garch(returns_chevron, order = c(1,1), trace = F)
summary(garch_returns_chevron1)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
checkresiduals(garch_returns_chevron1)
n <- length(returns_exxon)
n
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
k <- 900
n <- length(returns_chevron)
err1 <- c()
err2 <- c()
for(i in 1:(n-k)) {
xtrain <- returns_chevron[1:(k-1)+i]
xtest <- returns_chevron[k+i]
# ARIMA(0,0,1) + GARCH(1,1)
arima.fit <- Arima(xtrain, order = c(0, 0, 1), include.drift = TRUE)
arima.res <- residuals(arima.fit)
fit1 <- garchFit(~garch(1, 1), data = arima.res, trace = FALSE)
fcast1 <- predict(fit1, n.ahead = 1)
# GARCH(1,1)
returns_diff <- diff(xtrain)
fit2 <- garchFit(~garch(1, 1), data = xtrain, trace = FALSE)
fcast2 <- predict(fit2, n.ahead = 1)
err1 <- c(err1, (fcast1$meanForecast - xtest)^2)
err2 <- c(err2, (fcast2$meanForecast - xtest)^2)
}
RMSE1_c <- sqrt(mean(err1))
RMSE2_c <- sqrt(mean(err2))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
cat("The RMSE for model 1 -", RMSE1_c, "\n")
cat("The RMSE for model 2 -", RMSE2_c, "\n")
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
#Fit the ARIMA model
arima_chevron_final <- Arima(returns_chevron, order = c(0, 0, 1))
#Extract the residuals
residuals_chevron_final <- residuals(arima_chevron_final)
# Fit the GARCH model on the residuals
garch_chevron_final <- garchFit(~garch(1,1), data = residuals_chevron_final, trace = FALSE)
summary(garch_chevron_final)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
predict(garch_chevron_final, n.ahead = 100, plot = TRUE)
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
ht <- garch_chevron_final@h.t
chevron_stockprice_df = data.frame(Chevron_stockprice)
chevron_stockprice_df <- head(chevron_stockprice_df, -1)
chevron_stockprice_df <- data.frame(chevron_stockprice_df,rownames(chevron_stockprice_df))
colnames(chevron_stockprice_df)[7] = "date"
chevron_stockprice_df$date<-as.Date(chevron_stockprice_df$date,"%Y-%m-%d")
data_spot = data.frame(ht,chevron_stockprice_df$date)
ggplot(data_spot, aes(y = ht, x = chevron_stockprice_df.date)) + geom_line() + ylab('Conditional Variance') + xlab('Date') +
theme_minimal() +
ggtitle("Volatility plot for Chevron Corporation Stock Price") +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
ht <- garch_chevron_final@h.t
chevron_stockprice_df = data.frame(Chevron_stockprice)
chevron_stockprice_df <- head(chevron_stockprice_df, -1)
chevron_stockprice_df <- data.frame(chevron_stockprice_df,rownames(chevron_stockprice_df))
colnames(chevron_stockprice_df)[7] = "date"
chevron_stockprice_df$date<-as.Date(chevron_stockprice_df$date,"%Y-%m-%d")
data_spot = data.frame(ht,chevron_stockprice_df$date)
ggplot(data_spot, aes(y = ht, x = chevron_stockprice_df.date)) +
geom_line() +
ylab('Conditional Variance') +
xlab('Date') +
theme_minimal() +
ggtitle("Volatility plot for Chevron Corporation Stock Price") +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
ht <- garch_chevron_final@h.t
chevron_stockprice_df = data.frame(Chevron_stockprice)
chevron_stockprice_df <- head(chevron_stockprice_df, -1)
chevron_stockprice_df <- data.frame(chevron_stockprice_df,rownames(chevron_stockprice_df))
colnames(chevron_stockprice_df)[7] = "date"
chevron_stockprice_df$date<-as.Date(chevron_stockprice_df$date,"%Y-%m-%d")
data_spot = data.frame(ht,chevron_stockprice_df$date)
ggplot(data_spot, aes(y = ht, x = chevron_stockprice_df.date)) +
geom_line(color = "dodgerblue") +
ylab('Conditional Variance') +
xlab('Date') +
theme_minimal() +
ggtitle("Volatility plot for Chevron Corporation Stock Price") +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
ht <- garch_chevron_final@h.t
chevron_stockprice_df = data.frame(Chevron_stockprice)
chevron_stockprice_df <- head(chevron_stockprice_df, -1)
chevron_stockprice_df <- data.frame(chevron_stockprice_df,rownames(chevron_stockprice_df))
colnames(chevron_stockprice_df)[7] = "date"
chevron_stockprice_df$date<-as.Date(chevron_stockprice_df$date,"%Y-%m-%d")
data_spot = data.frame(ht,chevron_stockprice_df$date)
ggplot(data_spot, aes(y = ht, x = chevron_stockprice_df.date)) +
geom_line(color = "dodgerblue3") +
ylab('Conditional Variance') +
xlab('Date') +
theme_minimal() +
ggtitle("Volatility plot for Chevron Corporation Stock Price") +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
#| code-fold: true
#| code-summary: 'Code'
#| warning: false
#| output: true
ht <- garch_exxon_final@h.t
exxon_stockprice_df = data.frame(Exxon_stockprice)
exxon_stockprice_df <- head(exxon_stockprice_df, -1)
exxon_stockprice_df <- data.frame(exxon_stockprice_df,rownames(exxon_stockprice_df))
colnames(exxon_stockprice_df)[7] = "date"
exxon_stockprice_df$date<-as.Date(exxon_stockprice_df$date,"%Y-%m-%d")
data_spot = data.frame(ht,exxon_stockprice_df$date)
ggplot(data_spot, aes(y = ht, x = exxon_stockprice_df.date)) +
geom_line(color = "dodgerblue3")  +
ylab('Conditional Variance') +
xlab('Date') +
theme_minimal() +
ggtitle("Volatility plot for Exxon Mobil Stock Price") +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
