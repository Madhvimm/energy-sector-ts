#| code-summary: 'VAR Select'
#| warning: false
#| output: true
#n=length(oil_cpi) 816;
#n-k=744; 744/12=62;
n=length(oil_cpi_mts)
k <- 72
rmse1 <- matrix(NA,62,12)
rmse2 <- matrix(NA,62,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for (i in 1:62) {
xtrain <- window(ts_obj, end=st + i - 1)
xtest <- window(ts_obj, start=st + (i-1) + 1/12, end=st + i)
xtest <- as.data.frame(xtest[, c("Oil_Price", "CPI")])
print(paste("Iteration:", i))
print(paste("Train end:", st + i - 1))
print(paste("Test start:", st + (i-1) + 1/12))
print(paste("Test end:", st + i))
fit <- VAR(xtrain, p=2, type='both')
fcast <- predict(fit, n.ahead=12)
foil <- fcast$fcst$Oil_Price[, "fcst"]
fcpi <- fcast$fcst$CPI[, "fcst"]
start_year <- floor(st + (i-1) + 1/12)
start_month <- as.integer(((st + (i-1) + 1/12) - start_year) * 12) + 1
if (start_month > 12) {
start_month <- start_month %% 12
start_year <- start_year + 1
}
ff <- cbind(foil, fcpi)
ff_ts <- ts(ff, start=c(start_year, start_month), frequency=12)
print(paste("Forecast start:", c(start_year, start_month), "Frequency:", 12))
if (!all(time(ff_ts) == time(xtest))) {
print("Mismatch in forecast and actual data times at iteration " + toString(i))
} else {
errors <- (as.data.frame(ff_ts) - xtest)^2
rmse1[i, ] <- sqrt(colMeans(errors, na.rm=TRUE))
}
fit2 <- VAR(xtrain, p=4, type='both')
fcast2 <- predict(fit2, n.ahead=12)
foil2 <- fcast2$fcst$Oil_Price[, "fcst"]
fcpi2 <- fcast2$fcst$CPI[, "fcst"]
ff2 <- cbind(foil2, fcpi2)
ff2_ts <- ts(ff2, start=c(start_year, start_month), frequency=12)
if (!all(time(ff2_ts) == time(xtest))) {
print("Mismatch in second model forecast and actual data times at iteration " + toString(i))
} else {
errors2 <- (as.data.frame(ff2_ts) - xtest)^2
rmse2[i, ] <- sqrt(colMeans(errors2, na.rm=TRUE))
}
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for(i in 1:3)
{
xtrain <- window(ts_obj, end=st + i-1)
xtest <- window(ts_obj, start=st + (i-1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead = 12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
ff<-data.frame(foil[,1],fcpi[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
## it's going from 1978 Q1(1)-Q4(4); 1979 Q1(5)-Q4(8); 1980 Q1(9)-Q4(12)....
##### collecting errors ######
rmse1[c(a:b),]  <-sqrt((ff-xtest)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
ff2<-data.frame(ftemp[,1],fprecip[,1])
year<-st + (i-1) + 1/12
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
rmse2[c(a:b),]  <-sqrt((ff2-xtest)^2)
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for(i in 1:3)
{
xtrain <- window(ts_obj, end=st + i-1)
xtest <- window(ts_obj, start=st + (i-1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead = 12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
#ff<-data.frame(foil[,1],fcpi[,1]) #collecting the forecasts for 3 variables
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(year, 1), frequency=12)
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
## it's going from 1978 Q1(1)-Q4(4); 1979 Q1(5)-Q4(8); 1980 Q1(9)-Q4(12)....
##### collecting errors ######
rmse1[c(a:b),]  <-sqrt((ff-xtest)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
#ff2<-data.frame(ftemp[,1],fprecip[,1])
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(year, 1), frequency=12)
year<-st + (i-1) + 1/12
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
rmse2[c(a:b),]  <-sqrt((ff2-xtest)^2)
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for(i in 1:3)
{
xtrain <- window(ts_obj, end=st + i-1)
xtest <- window(ts_obj, start=st + (i-1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead = 12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
#ff<-data.frame(foil[,1],fcpi[,1]) #collecting the forecasts for 3 variables
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(year, 1), frequency=12)
year<-st + (i-1) + 1/12 #starting year
#ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
## it's going from 1978 Q1(1)-Q4(4); 1979 Q1(5)-Q4(8); 1980 Q1(9)-Q4(12)....
##### collecting errors ######
rmse1[c(a:b),]  <-sqrt((ff-xtest)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
#ff2<-data.frame(ftemp[,1],fprecip[,1])
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(year, 1), frequency=12)
year<-st + (i-1) + 1/12
# ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
rmse2[c(a:b),]  <-sqrt((ff2-xtest)^2)
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for(i in 1:40)
{
xtrain <- window(ts_obj, end=st + i-1)
xtest <- window(ts_obj, start=st + (i-1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead = 12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
#ff<-data.frame(foil[,1],fcpi[,1]) #collecting the forecasts for 3 variables
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(year, 1), frequency=12)
year<-st + (i-1) + 1/12 #starting year
#ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
## it's going from 1978 Q1(1)-Q4(4); 1979 Q1(5)-Q4(8); 1980 Q1(9)-Q4(12)....
##### collecting errors ######
rmse1[c(a:b),]  <-sqrt((ff-xtest)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
#ff2<-data.frame(ftemp[,1],fprecip[,1])
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(year, 1), frequency=12)
year<-st + (i-1) + 1/12
# ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11 #going from 1,13,25,37
b= 12*i #12, 24, 36
rmse2[c(a:b),]  <-sqrt((ff2-xtest)^2)
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for (i in 1:3) {
xtrain <- window(ts_obj, end=st + i - 1)
xtest <- window(ts_obj, start=st + (i - 1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead=12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
# Get the starting point of xtest
xtest_start <- tsp(xtest)[1]
xtest_end <- tsp(xtest)[2]
# Create ff with the same starting point as xtest
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
a = 12 * i - 11
b = 12 * i
rmse1[c(a:b), ] <- sqrt((ff - xtest)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead=12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
# Create ff2 with the same starting point as xtest
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
rmse2[c(a:b), ] <- sqrt((ff2 - xtest)^2)
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for (i in 1:3) {
xtrain <- window(ts_obj, end=st + i - 1)
xtest <- window(ts_obj, start=st + (i - 1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead=12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
# Get the starting point of xtest
xtest_start <- tsp(xtest)[1]
xtest_end <- tsp(xtest)[2]
# Create ff with the same starting point as xtest
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
a = 12 * i - 11
b = 12 * i
rmse1[c(a:b), ] <- sqrt((ff - xtest_subset)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead=12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
# Create ff2 with the same starting point as xtest
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
rmse2[c(a:b), ] <- sqrt((ff2 - xtest_subset)^2)
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for (i in 1:40) {
xtrain <- window(ts_obj, end=st + i - 1)
xtest <- window(ts_obj, start=st + (i - 1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead=12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
# Get the starting point of xtest
xtest_start <- tsp(xtest)[1]
xtest_end <- tsp(xtest)[2]
# Create ff with the same starting point as xtest
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
a = 12 * i - 11
b = 12 * i
rmse1[c(a:b), ] <- sqrt((ff - xtest_subset)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead=12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
# Create ff2 with the same starting point as xtest
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
rmse2[c(a:b), ] <- sqrt((ff2 - xtest_subset)^2)
}
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for (i in 1:3) {
xtrain <- window(ts_obj, end=st + i - 1)
xtest <- window(ts_obj, start=st + (i - 1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead=12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
# Get the starting point of xtest
xtest_start <- tsp(xtest)[1]
xtest_end <- tsp(xtest)[2]
# Create ff with the same starting point as xtest
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
a = 12 * i - 11
b = 12 * i
rmse1[c(a:b), ] <- sqrt((ff - xtest_subset)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead=12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
# Create ff2 with the same starting point as xtest
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
rmse2[c(a:b), ] <- sqrt((ff2 - xtest_subset)^2)
}
plot(1:12, colMeans(rmse1,na.rm=TRUE), type="l", col=2, xlab="Year", ylab="RMSE")
lines(1:12, colMeans(rmse2,na.rm=TRUE), type="l",col=3)
legend("topleft",legend=c("VAR 6","VAR 10"),col=2:4,lty=1)
#| code-fold: true
#| code-summary: 'VAR Select'
#| warning: false
#| output: true
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for (i in 1:3) {
xtrain <- window(ts_obj, end=st + i - 1)
xtest <- window(ts_obj, start=st + (i - 1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=6, type='both')
fcast <- predict(fit, n.ahead=12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
# Get the starting point of xtest
xtest_start <- tsp(xtest)[1]
xtest_end <- tsp(xtest)[2]
# Create ff with the same starting point as xtest
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
a = 12 * i - 11
b = 12 * i
rmse1[c(a:b), ] <- sqrt((ff - xtest_subset)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=10, type='both')
fcast2 <- predict(fit2, n.ahead=12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
# Create ff2 with the same starting point as xtest
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
a = 12 * i - 11
b = 12 * i
rmse2[c(a:b), ] <- sqrt((ff2 - xtest_subset)^2)
}
plot(1:12, colMeans(rmse1,na.rm=TRUE), type="l", col=2, xlab="Year", ylab="RMSE")
lines(1:12, colMeans(rmse2,na.rm=TRUE), type="l",col=3)
legend("topleft",legend=c("VAR 6","VAR 10"),col=2:4,lty=1)
#| code-fold: true
#| code-summary: 'VAR Select'
#| warning: false
#| output: true
#n=length(temp_month_ts) 525; 525-45
#n-k=480; 480/12=40;
n=length(oil_cpi_mts)
k=45 #19*4
rmse1 <- matrix(NA, 40,12)
rmse2 <- matrix(NA, 40,12)
year<-c()
# Convert data frame to time series object
ts_obj <- ts(oil_cpi_df, star=decimal_date(as.Date("1990-01-01",format = "%Y-%m-%d")),frequency = 12)
st <- tsp(ts_obj )[1]+(k-1)/12
for (i in 1:3) {
xtrain <- window(ts_obj, end=st + i - 1)
xtest <- window(ts_obj, start=st + (i - 1) + 1/12, end=st + i)
######## first Model ############
fit <- VAR(ts_obj, p=2, type='both')
fcast <- predict(fit, n.ahead=12)
foil <- fcast$fcst$Oil_Price
fcpi <- fcast$fcst$CPI
# Get the starting point of xtest
xtest_start <- tsp(xtest)[1]
xtest_end <- tsp(xtest)[2]
# Create ff with the same starting point as xtest
ff <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
a = 12 * i - 11
b = 12 * i
rmse1[c(a:b), ] <- sqrt((ff - xtest_subset)^2)
######## Second Model ############
fit2 <- vars::VAR(ts_obj, p=4, type='both')
fcast2 <- predict(fit2, n.ahead=12)
foil <- fcast2$fcst$Oil_Price
fcpi <- fcast2$fcst$CPI
# Create ff2 with the same starting point as xtest
ff2 <- ts(cbind(foil[, 1], fcpi[, 1]), start=c(xtest_start), end=c(xtest_end), frequency=12)
# Subset xtest to include only Oil_Price and CPI columns
xtest_subset <- xtest[, c("Oil_Price", "CPI")]
a = 12 * i - 11
b = 12 * i
rmse2[c(a:b), ] <- sqrt((ff2 - xtest_subset)^2)
}
plot(1:12, colMeans(rmse1,na.rm=TRUE), type="l", col=2, xlab="Year", ylab="RMSE")
lines(1:12, colMeans(rmse2,na.rm=TRUE), type="l",col=3)
legend("topleft",legend=c("VAR 2","VAR 4"),col=2:4,lty=1)
#| code-fold: true
#| code-summary: 'Forecasting'
#| warning: false
#| output: false
var1 <- VAR(oil_cpi_mts, p=1, type="const")
forecast(var1) %>%
autoplot() + xlab("Week")+ theme_bw()
#| code-fold: true
#| code-summary: 'Forecasting'
#| warning: false
#| output: false
var1 <- VAR(oil_cpi_mts, p=10, type="const")
forecast(var1) %>%
autoplot() + xlab("Week")+ theme_bw()
#| code-fold: true
#| code-summary: 'Forecasting'
#| warning: false
#| output: false
var1 <- VAR(oil_cpi_mts, p=12, type="const")
forecast(var1) %>%
autoplot() + xlab("Week")+ theme_bw()
#| code-fold: true
#| code-summary: 'Forecasting'
#| warning: false
#| output: false
var1 <- VAR(oil_cpi_mts, p=2, type="const")
forecast(var1) %>%
autoplot() + xlab("Week")+ theme_bw()
#| code-fold: true
#| code-summary: 'Forecasting'
#| warning: false
#| output: false
var1 <- VAR(oil_cpi_mts, p=2, type="const")
forecast(var1) %>%
autoplot() + xlab("Week")+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
#| code-fold: true
#| code-summary: 'Forecasting'
#| warning: false
#| output: false
var2 <- VAR(oil_cpi_mts, p=2, type="const")
forecast(var1) %>%
autoplot() + xlab("Week")+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
