<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Powering Change - Deep Learning for TS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Powering Change</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data-sources.html"> 
<span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data-visualization.html"> 
<span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./exploratory-data-analysis.html"> 
<span class="menu-text">EDA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./univariate-ts-models.html"> 
<span class="menu-text">Univariate TS Models (ARIMA/SARIMA)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./multivariate-ts-models.html"> 
<span class="menu-text">Multivariate TS Models (ARIMAX/SARIMAX/VAR)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./financial-ts-models.html"> 
<span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./deep-learning-ts.ipynb"> 
<span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusions.qmd"> 
<span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization">2. Data Visualization</a></li>
  <li><a href="#normalize-split-the-data" id="toc-normalize-split-the-data" class="nav-link" data-scroll-target="#normalize-split-the-data">3. Normalize &amp; Split the Data</a></li>
  <li><a href="#mini-batching" id="toc-mini-batching" class="nav-link" data-scroll-target="#mini-batching">4. Mini Batching</a></li>
  <li><a href="#recurrent-neural-networks-rnns" id="toc-recurrent-neural-networks-rnns" class="nav-link" data-scroll-target="#recurrent-neural-networks-rnns">5. Recurrent Neural Networks (RNNs)</a></li>
  <li><a href="#lstm" id="toc-lstm" class="nav-link" data-scroll-target="#lstm">6. LSTM</a></li>
  <li><a href="#gru" id="toc-gru" class="nav-link" data-scroll-target="#gru">7. GRU</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">8. Discussion</a>
  <ul class="collapse">
  <li><a href="#how-do-the-results-from-the-3-different-ann-models-compare-with-each-other-in-terms-of-accuracy-and-predictive-power" id="toc-how-do-the-results-from-the-3-different-ann-models-compare-with-each-other-in-terms-of-accuracy-and-predictive-power" class="nav-link" data-scroll-target="#how-do-the-results-from-the-3-different-ann-models-compare-with-each-other-in-terms-of-accuracy-and-predictive-power">8.1 How do the results from the 3 different ANN models compare with each other in terms of accuracy and predictive power?</a></li>
  <li><a href="#what-effect-does-including-regularization-have-on-your-results" id="toc-what-effect-does-including-regularization-have-on-your-results" class="nav-link" data-scroll-target="#what-effect-does-including-regularization-have-on-your-results">8.2 What effect does including regularization have on your results?</a></li>
  <li><a href="#how-far-into-the-future-can-the-deep-learning-model-accurately-predict-the-future" id="toc-how-far-into-the-future-can-the-deep-learning-model-accurately-predict-the-future" class="nav-link" data-scroll-target="#how-far-into-the-future-can-the-deep-learning-model-accurately-predict-the-future">8.3 How far into the future can the deep learning model accurately predict the future?</a></li>
  <li><a href="#how-does-your-deep-learning-modeling-compare-to-the-traditional-single-variable-time-series-armaarima-models-from-hw-3" id="toc-how-does-your-deep-learning-modeling-compare-to-the-traditional-single-variable-time-series-armaarima-models-from-hw-3" class="nav-link" data-scroll-target="#how-does-your-deep-learning-modeling-compare-to-the-traditional-single-variable-time-series-armaarima-models-from-hw-3">8.4. How does your deep learning modeling compare to the traditional single-variable time-series ARMA/ARIMA models from HW-3?</a></li>
  </ul></li>
  <li><a href="#write-a-discussion-paragraph-comparing-your-models-use-rmse-and-forecasts-from-these-sections-with-your-deep-learning-models." id="toc-write-a-discussion-paragraph-comparing-your-models-use-rmse-and-forecasts-from-these-sections-with-your-deep-learning-models." class="nav-link" data-scroll-target="#write-a-discussion-paragraph-comparing-your-models-use-rmse-and-forecasts-from-these-sections-with-your-deep-learning-models.">9. Write a discussion paragraph Comparing your models (use RMSE) and forecasts from these sections with your Deep Learning Models.</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Deep Learning for TS</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<p>Time series forecasting plays a pivotal role in various domains, including economics, finance, and business operations. Accurately predicting future trends based on historical data can provide valuable insights for decision-making and strategic planning. Traditionally, statistical methods such as Autoregressive Integrated Moving Average (ARIMA) models have been widely employed for time series analysis. However, these conventional approaches often struggle to capture intricate patterns, non-linear relationships, and long-term dependencies present in complex time series data.</p>
<p>In recent years, deep learning techniques have emerged as powerful alternatives, offering new avenues for time series forecasting. Neural networks, with their ability to learn from data and uncover intricate patterns, have shown remarkable potential in handling sequential data and capturing temporal dependencies. This exploration focuses on three prominent deep learning architectures: Recurrent Neural Networks (RNNs), Long Short-Term Memory Networks (LSTMs), and Gated Recurrent Units (GRUs), each designed to tackle the unique challenges of time series data.</p>
<p>The objective of this study is to evaluate the performance of these deep learning models in forecasting [specify the time series data or domain, e.g., energy prices, stock market trends, or sales data]. By leveraging their capability to handle complex non-linear relationships and long-term dependencies, we aim to enhance our forecasting accuracy and extend the predictive horizon compared to traditional methods.</p>
<p>Furthermore, this exploration will provide insights into the relative strengths and weaknesses of each neural network architecture, informing future decisions on selecting the most suitable approach for specific time series forecasting tasks. We will thoroughly analyze and compare the accuracy, predictive power, and generalization capabilities of RNNs, LSTMs, and GRUs, offering a comprehensive understanding of their applicability in the realm of time series analysis.</p>
<p>By embracing deep learning techniques, we strive to push the boundaries of time series forecasting, enabling more informed decision-making and strategic planning across various industries and domains. This study will contribute to the growing body of knowledge in the field, advancing our understanding of the potential and limitations of deep learning for time series analysis.</p>
</section>
<section id="data-visualization" class="level1">
<h1>2. Data Visualization</h1>
<p>To better understand the patterns in our data, we will first visualize it to examine any trends, seasonality, or anomalies. The visualization helps provide insights into how this time series behaves over time.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Crude Oil</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Natural Gas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Electricity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">GDP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">CPI</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>oil_plot <span class="op">=</span> px.line(composite_crude_oil_prices, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                   title<span class="op">=</span><span class="st">'Crude Oil Prices Over Time'</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                   labels<span class="op">=</span>{<span class="st">'Date'</span>: <span class="st">'Date'</span>, <span class="st">'Value'</span>: <span class="st">'Crude Oil Prices'</span>},</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                   template<span class="op">=</span><span class="st">'plotly_white'</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                   color_discrete_sequence<span class="op">=</span>[<span class="st">'#99494d'</span>])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>oil_plot</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="16b20906-ad17-4a55-a1e0-f1e6bdb3f254" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("16b20906-ad17-4a55-a1e0-f1e6bdb3f254")) {                    Plotly.newPlot(                        "16b20906-ad17-4a55-a1e0-f1e6bdb3f254",                        [{"hovertemplate":"Date=%{x}\u003cbr\u003eCrude Oil Prices=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"#99494d","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00","2017-02-01T00:00:00","2017-03-01T00:00:00","2017-04-01T00:00:00","2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00","2023-12-01T00:00:00"],"xaxis":"x","y":[20.64,20.31,19.14,17.05,16.27,15.11,16.19,23.55,30.03,33.14,30.52,26.09,22.85,19.03,17.89,18.46,18.7,17.98,18.57,18.92,19.17,20.16,19.72,17.56,16.5,16.3,16.56,17.66,18.83,19.99,20.1,19.56,19.59,19.49,18.66,17.43,17.11,17.64,18.08,18.42,18.16,17.26,16.1,15.83,15.59,15.81,14.51,12.51,12.83,13.07,13.16,14.64,15.8,17.21,17.62,16.92,16.18,16.31,16.54,16.03,16.54,17.18,17.26,18.43,18.62,17.69,16.68,16.75,16.91,16.55,16.62,17.54,17.74,17.95,19.76,21.63,20.61,19.31,19.76,20.54,21.96,23.08,22.87,23.3,23.59,21.64,19.82,18.35,18.79,17.8,17.84,18.19,18.14,19.17,18.52,16.91,15.04,13.98,12.84,13.06,12.95,11.94,11.9,11.77,13.01,12.61,11.56,9.81,10.43,10.55,12.13,14.95,15.95,16.06,18.07,19.57,21.68,21.93,23.12,24.51,25.49,27.55,28.41,24.97,26.46,29.13,28.74,29.01,31.13,30.63,31.0,26.31,25.45,26.09,24.05,23.87,25.31,24.92,23.76,24.44,23.73,20.04,17.24,16.52,17.38,18.43,22.0,24.1,25.03,24.05,25.16,26.19,27.66,26.7,24.6,26.93,30.52,33.0,30.65,26.02,25.74,27.92,28.55,29.15,26.39,27.75,28.28,29.28,30.93,31.72,33.1,33.47,36.32,34.59,36.68,40.3,41.35,46.13,41.77,36.6,39.01,41.05,46.78,46.71,44.84,50.3,53.83,59.3,60.18,57.18,52.13,52.51,57.33,54.82,56.38,62.98,65.34,65.13,68.86,67.77,58.92,54.04,53.61,55.98,50.77,54.45,56.84,60.68,61.71,65.14,71.24,69.46,73.54,79.87,86.78,85.29,86.48,89.09,97.96,106.09,117.64,127.32,129.03,113.74,98.91,74.22,53.33,37.67,37.45,38.15,45.57,48.78,55.96,65.72,63.58,67.99,67.74,72.08,74.48,72.95,75.48,74.58,77.43,80.83,72.66,72.66,73.73,74.58,73.85,77.76,80.85,85.95,88.04,90.66,102.43,112.51,107.84,104.23,104.68,97.7,99.39,100.57,107.28,105.69,104.71,107.18,110.92,109.68,103.17,91.96,92.84,97.7,101.97,100.02,96.78,95.06,100.78,101.45,101.23,99.5,100.17,98.67,103.85,106.2,105.7,100.41,93.32,94.32,93.58,99.36,100.09,100.15,100.61,102.51,101.22,95.61,92.26,84.99,75.66,60.7,47.0,48.92,47.99,53.51,58.65,60.12,53.4,44.97,44.38,44.77,41.43,35.63,29.99,28.53,33.82,37.71,42.88,45.96,43.26,42.7,42.73,46.85,44.06,48.66,49.99,51.24,48.65,49.47,48.47,45.25,46.27,48.22,50.78,52.67,57.75,59.53,63.25,61.74,60.81,64.41,68.91,68.35,70.29,67.68,69.29,70.99,59.01,48.83,52.29,57.62,61.64,66.51,65.11,59.16,60.53,56.9,58.6,55.85,57.88,60.27,57.92,51.37,32.55,19.32,23.55,36.8,40.08,42.42,39.81,39.21,40.68,46.2,51.39,58.41,61.97,62.4,65.15,70.55,71.98,67.89,71.1,78.83,78.47,71.98,80.26,90.21,106.98,105.22,110.43,114.44,102.82,95.8,86.57,88.02,84.57,76.56,75.63,74.8,72.96,78.38,72.35,71.43,76.41,81.76,89.33,86.63,79.57,73.97],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Crude Oil Prices"}},"legend":{"tracegroupgap":0},"title":{"text":"Crude Oil Prices Over Time"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ng_plot <span class="op">=</span> px.line(citygate_gas_prices, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  title<span class="op">=</span><span class="st">'Natural Gas Price Over Time'</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                  labels<span class="op">=</span>{<span class="st">'Date'</span>: <span class="st">'Date'</span>, <span class="st">'Value'</span>: <span class="st">'Price (USD)'</span>},</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                  template<span class="op">=</span><span class="st">'plotly_white'</span>,  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                  color_discrete_sequence<span class="op">=</span>[<span class="st">'#99494d'</span>])</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ng_plot</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="c60319ef-e4cd-4de9-8285-0a519d30c38d" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c60319ef-e4cd-4de9-8285-0a519d30c38d")) {                    Plotly.newPlot(                        "c60319ef-e4cd-4de9-8285-0a519d30c38d",                        [{"hovertemplate":"Date=%{x}\u003cbr\u003ePrice (USD)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"#99494d","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00","2017-02-01T00:00:00","2017-03-01T00:00:00","2017-04-01T00:00:00","2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00"],"xaxis":"x","y":[3.24,3.1,2.94,2.83,2.81,3.0,3.03,2.91,2.92,2.81,3.14,3.19,3.08,2.94,2.78,2.74,2.76,2.86,2.74,2.78,2.91,2.92,2.92,3.05,2.9,2.7,2.61,2.74,2.9,3.0,3.01,3.18,3.23,3.5,3.33,3.17,3.11,2.94,3.06,3.24,3.58,3.44,3.34,3.35,3.54,3.15,3.15,3.27,3.04,3.26,3.33,3.15,3.17,3.17,3.12,3.15,2.92,2.8,2.84,2.86,2.79,2.71,2.74,2.72,2.8,2.89,2.89,2.87,2.89,2.83,2.67,2.83,3.14,3.16,3.17,3.22,3.18,3.41,3.49,3.46,3.05,2.94,3.46,4.18,4.28,3.76,3.07,2.92,3.11,3.41,3.44,3.34,3.5,3.86,4.76,3.42,3.08,3.08,3.06,3.23,3.12,2.98,3.31,3.01,2.78,2.99,2.99,3.1,2.85,2.92,2.77,2.88,3.25,3.12,3.11,3.39,3.59,3.21,3.71,3.19,3.27,3.48,3.54,3.72,4.15,5.19,5.2,4.63,5.21,5.66,5.2,6.64,8.91,7.08,6.1,6.3,5.77,5.38,4.03,4.32,3.66,3.37,4.02,3.9,3.79,3.76,3.84,4.21,4.07,4.15,3.95,3.67,3.99,4.32,4.65,4.74,5.28,5.83,7.63,5.6,5.69,6.4,5.83,5.48,5.58,5.33,5.54,5.89,6.41,6.35,6.23,6.31,6.48,6.94,6.68,6.51,6.06,6.3,7.5,7.49,7.05,7.09,7.24,7.79,7.51,7.3,7.68,8.2,10.26,12.16,11.57,10.77,10.8,9.34,8.81,8.29,7.99,7.39,7.4,8.1,7.68,6.42,8.47,8.66,7.88,8.57,8.79,8.2,8.41,8.45,8.02,7.6,7.0,7.43,8.14,8.27,8.37,8.91,9.49,9.84,11.05,11.85,12.48,10.2,8.99,7.8,7.93,8.16,7.97,7.26,6.85,5.71,5.49,5.55,5.7,5.61,5.37,5.65,6.34,6.22,6.84,6.64,6.5,5.88,5.81,6.02,6.31,6.22,5.72,5.7,5.48,5.74,5.69,5.75,5.73,5.62,5.8,6.12,6.16,6.19,5.94,5.45,5.29,5.03,4.85,4.73,4.84,4.19,4.3,4.63,4.88,5.13,4.76,4.65,4.79,4.79,4.52,4.56,4.75,5.16,5.55,5.74,5.51,5.24,5.21,4.88,4.78,4.93,5.56,6.41,6.57,5.64,5.9,6.05,5.99,5.49,5.51,5.16,4.91,5.15,4.48,4.57,4.35,3.93,4.25,4.44,4.65,4.59,4.56,4.0,3.69,3.75,3.39,3.48,3.49,3.22,3.44,3.84,4.42,4.33,4.6,4.19,3.9,3.96,4.21,4.13,3.84,4.2,4.42,4.82,4.73,4.61,4.52,4.03,3.97,4.0,4.36,3.99,3.69,3.65,4.14,4.49,4.5,5.25,4.72,4.1,4.28,4.72,4.03,3.91,4.07,3.72,3.66,4.17,4.17,4.15,4.07,3.42,3.46,3.5,3.26,3.09,3.25,3.05,3.31,3.81,3.92,4.09,4.07,3.5,3.81,3.57,3.27,12.1,4.09,3.92,4.34,5.05,5.58,5.72,5.95,6.43,6.04,5.87,5.48,5.77,5.55,6.53,8.51,9.77,8.72,10.31,9.69,6.79,6.72,8.12,7.15,6.55,5.28,4.33,4.17,4.67,5.04,4.79,5.03,4.16,4.36],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Price (USD)"}},"legend":{"tracegroupgap":0},"title":{"text":"Natural Gas Price Over Time"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Plot Electricity Prices</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>electricity_plot <span class="op">=</span> px.line(total_electricity_prices, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                           title<span class="op">=</span><span class="st">'Average Price of Electricity to Ultimate Customers'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                           labels<span class="op">=</span>{<span class="st">'Date'</span>: <span class="st">'Date'</span>, <span class="st">'Value'</span>: <span class="st">'Price (Cents per Kilowatthour)'</span>},</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                           template<span class="op">=</span><span class="st">'plotly_white'</span>,  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                           color_discrete_sequence<span class="op">=</span>[<span class="st">'#99494d'</span>])</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>electricity_plot.show()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="44c15da0-5bab-4ece-b001-08270a8417ca" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("44c15da0-5bab-4ece-b001-08270a8417ca")) {                    Plotly.newPlot(                        "44c15da0-5bab-4ece-b001-08270a8417ca",                        [{"hovertemplate":"Date=%{x}\u003cbr\u003ePrice (Cents per Kilowatthour)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"#99494d","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00","2017-02-01T00:00:00","2017-03-01T00:00:00","2017-04-01T00:00:00","2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00"],"xaxis":"x","y":[6.27,6.33,6.37,6.35,6.46,6.71,6.92,6.89,6.85,6.67,6.46,6.43,6.43,6.53,6.55,6.53,6.63,6.92,7.1,7.07,7.02,6.87,6.59,6.57,6.58,6.58,6.6,6.57,6.72,6.99,7.18,7.15,7.14,6.92,6.64,6.66,6.61,6.59,6.59,6.62,6.82,7.13,7.36,7.35,7.32,7.16,6.75,6.65,6.65,6.69,6.68,6.67,6.8,7.16,7.36,7.28,7.24,6.9,6.64,6.63,6.6,6.68,6.66,6.65,6.74,7.1,7.35,7.34,7.08,6.95,6.7,6.64,6.61,6.6,6.65,6.63,6.77,7.03,7.27,7.3,7.16,6.91,6.65,6.58,6.62,6.61,6.66,6.59,6.72,7.08,7.25,7.23,7.12,6.9,6.65,6.6,6.57,6.52,6.53,6.51,6.67,6.97,7.21,7.14,6.95,6.69,6.39,6.46,6.42,6.5,6.43,6.4,6.5,6.83,7.11,7.08,6.87,6.7,6.39,6.41,6.4,6.39,6.44,6.43,6.64,7.06,7.25,7.34,7.11,6.94,6.66,6.85,6.75,6.87,7.01,7.02,7.17,7.58,7.87,7.84,7.62,7.43,7.02,7.03,6.95,6.97,6.95,6.95,7.11,7.45,7.68,7.58,7.36,7.2,6.94,6.96,7.0,7.05,7.16,7.27,7.42,7.78,8.02,7.97,7.61,7.39,7.19,7.14,7.22,7.25,7.3,7.34,7.46,7.93,8.11,8.18,7.97,7.6,7.42,7.36,7.47,7.58,7.59,7.65,7.84,8.38,8.6,8.71,8.68,8.37,8.21,8.21,8.31,8.49,8.44,8.56,8.71,9.3,9.55,9.58,9.32,8.89,8.63,8.55,8.71,8.74,8.8,8.82,8.96,9.45,9.64,9.68,9.43,9.17,8.94,8.91,8.92,8.9,9.03,9.22,9.47,10.27,10.65,10.59,10.27,9.94,9.67,9.53,9.68,9.78,9.64,9.57,9.77,10.13,10.28,10.27,10.09,9.7,9.34,9.4,9.28,9.47,9.48,9.53,9.72,10.18,10.46,10.4,10.17,9.81,9.55,9.52,9.48,9.56,9.55,9.54,9.78,10.26,10.47,10.49,10.29,9.83,9.58,9.53,9.61,9.58,9.52,9.47,9.64,10.13,10.3,10.32,10.26,9.74,9.58,9.64,9.64,9.77,9.71,9.66,9.92,10.45,10.69,10.58,10.43,10.02,9.79,9.86,10.12,10.33,10.28,10.0,10.21,10.75,11.03,10.91,10.83,10.34,10.13,10.12,10.18,10.36,10.29,10.01,10.21,10.64,10.95,10.85,10.79,10.31,10.05,9.98,9.97,10.0,10.0,9.83,10.06,10.52,10.7,10.81,10.68,10.15,10.1,10.09,10.13,10.28,10.28,10.07,10.34,10.83,10.95,10.91,10.86,10.4,10.28,10.17,10.41,10.42,10.34,10.18,10.35,10.75,10.99,11.01,10.66,10.41,10.35,10.21,10.24,10.4,10.34,10.24,10.38,10.74,11.0,11.05,10.82,10.39,10.38,10.22,10.22,10.22,10.21,10.34,10.39,10.88,11.06,11.02,10.99,10.65,10.38,10.37,10.29,11.16,10.84,10.63,10.69,11.25,11.45,11.55,11.59,11.24,11.14,11.03,11.24,11.42,11.48,11.56,11.98,12.75,13.12,13.44,13.31,12.66,12.3,12.4,12.78,12.77,12.43,12.18,12.25,12.75,13.13,13.31,13.25,12.68,12.55],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Price (Cents per Kilowatthour)"}},"legend":{"tracegroupgap":0},"title":{"text":"Average Price of Electricity to Ultimate Customers"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Plot GDP</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>gdp_plot <span class="op">=</span> px.line(gdp_data, x<span class="op">=</span><span class="st">'DATE'</span>, y<span class="op">=</span><span class="st">'GDP'</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   title<span class="op">=</span><span class="st">'Gross Domestic Product Over Time'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                   labels<span class="op">=</span>{<span class="st">'DATE'</span>: <span class="st">'Date'</span>, <span class="st">'GDP'</span>: <span class="st">'GDP (Billion USD)'</span>},</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                   template<span class="op">=</span><span class="st">'plotly_white'</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                   color_discrete_sequence<span class="op">=</span>[<span class="st">'#99494d'</span>])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>gdp_plot.show()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="ccb0a5cc-b281-4961-adf8-a56c4b03135f" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ccb0a5cc-b281-4961-adf8-a56c4b03135f")) {                    Plotly.newPlot(                        "ccb0a5cc-b281-4961-adf8-a56c4b03135f",                        [{"hovertemplate":"Date=%{x}\u003cbr\u003eGDP (Billion USD)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"#99494d","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":["1990-01-01T00:00:00","1990-04-01T00:00:00","1990-07-01T00:00:00","1990-10-01T00:00:00","1991-01-01T00:00:00","1991-04-01T00:00:00","1991-07-01T00:00:00","1991-10-01T00:00:00","1992-01-01T00:00:00","1992-04-01T00:00:00","1992-07-01T00:00:00","1992-10-01T00:00:00","1993-01-01T00:00:00","1993-04-01T00:00:00","1993-07-01T00:00:00","1993-10-01T00:00:00","1994-01-01T00:00:00","1994-04-01T00:00:00","1994-07-01T00:00:00","1994-10-01T00:00:00","1995-01-01T00:00:00","1995-04-01T00:00:00","1995-07-01T00:00:00","1995-10-01T00:00:00","1996-01-01T00:00:00","1996-04-01T00:00:00","1996-07-01T00:00:00","1996-10-01T00:00:00","1997-01-01T00:00:00","1997-04-01T00:00:00","1997-07-01T00:00:00","1997-10-01T00:00:00","1998-01-01T00:00:00","1998-04-01T00:00:00","1998-07-01T00:00:00","1998-10-01T00:00:00","1999-01-01T00:00:00","1999-04-01T00:00:00","1999-07-01T00:00:00","1999-10-01T00:00:00","2000-01-01T00:00:00","2000-04-01T00:00:00","2000-07-01T00:00:00","2000-10-01T00:00:00","2001-01-01T00:00:00","2001-04-01T00:00:00","2001-07-01T00:00:00","2001-10-01T00:00:00","2002-01-01T00:00:00","2002-04-01T00:00:00","2002-07-01T00:00:00","2002-10-01T00:00:00","2003-01-01T00:00:00","2003-04-01T00:00:00","2003-07-01T00:00:00","2003-10-01T00:00:00","2004-01-01T00:00:00","2004-04-01T00:00:00","2004-07-01T00:00:00","2004-10-01T00:00:00","2005-01-01T00:00:00","2005-04-01T00:00:00","2005-07-01T00:00:00","2005-10-01T00:00:00","2006-01-01T00:00:00","2006-04-01T00:00:00","2006-07-01T00:00:00","2006-10-01T00:00:00","2007-01-01T00:00:00","2007-04-01T00:00:00","2007-07-01T00:00:00","2007-10-01T00:00:00","2008-01-01T00:00:00","2008-04-01T00:00:00","2008-07-01T00:00:00","2008-10-01T00:00:00","2009-01-01T00:00:00","2009-04-01T00:00:00","2009-07-01T00:00:00","2009-10-01T00:00:00","2010-01-01T00:00:00","2010-04-01T00:00:00","2010-07-01T00:00:00","2010-10-01T00:00:00","2011-01-01T00:00:00","2011-04-01T00:00:00","2011-07-01T00:00:00","2011-10-01T00:00:00","2012-01-01T00:00:00","2012-04-01T00:00:00","2012-07-01T00:00:00","2012-10-01T00:00:00","2013-01-01T00:00:00","2013-04-01T00:00:00","2013-07-01T00:00:00","2013-10-01T00:00:00","2014-01-01T00:00:00","2014-04-01T00:00:00","2014-07-01T00:00:00","2014-10-01T00:00:00","2015-01-01T00:00:00","2015-04-01T00:00:00","2015-07-01T00:00:00","2015-10-01T00:00:00","2016-01-01T00:00:00","2016-04-01T00:00:00","2016-07-01T00:00:00","2016-10-01T00:00:00","2017-01-01T00:00:00","2017-04-01T00:00:00","2017-07-01T00:00:00","2017-10-01T00:00:00","2018-01-01T00:00:00","2018-04-01T00:00:00","2018-07-01T00:00:00","2018-10-01T00:00:00","2019-01-01T00:00:00","2019-04-01T00:00:00","2019-07-01T00:00:00","2019-10-01T00:00:00","2020-01-01T00:00:00","2020-04-01T00:00:00","2020-07-01T00:00:00","2020-10-01T00:00:00","2021-01-01T00:00:00","2021-04-01T00:00:00","2021-07-01T00:00:00","2021-10-01T00:00:00","2022-01-01T00:00:00","2022-04-01T00:00:00","2022-07-01T00:00:00","2022-10-01T00:00:00","2023-01-01T00:00:00","2023-04-01T00:00:00","2023-07-01T00:00:00","2023-10-01T00:00:00"],"xaxis":"x","y":[5872.701,5960.028,6015.116,6004.733,6035.178,6126.862,6205.937,6264.54,6363.102,6470.763,6566.641,6680.803,6729.459,6808.939,6882.098,7013.738,7115.652,7246.931,7331.075,7455.288,7522.289,7580.997,7683.125,7772.586,7868.468,8032.84,8131.408,8259.771,8362.655,8518.825,8662.823,8765.907,8866.48,8969.699,9121.097,9293.991,9411.682,9526.21,9686.626,9900.169,10002.179,10247.72,10318.165,10435.744,10470.231,10599.0,10598.02,10660.465,10783.5,10887.46,10984.04,11061.433,11174.129,11312.766,11566.669,11772.234,11923.447,12112.815,12305.307,12527.214,12767.286,12922.656,13142.642,13324.204,13599.16,13753.424,13870.188,14039.56,14215.651,14402.082,14564.117,14715.058,14706.538,14865.701,14898.999,14608.209,14430.902,14381.236,14448.882,14651.249,14764.61,14980.193,15141.607,15309.474,15351.448,15557.539,15647.68,15842.259,16068.805,16207.115,16319.541,16420.419,16648.189,16728.687,16953.838,17192.019,17197.738,17518.508,17804.228,17912.079,18063.529,18279.784,18401.626,18435.137,18525.933,18711.702,18892.639,19089.379,19280.084,19438.643,19692.595,20037.088,20328.553,20580.912,20798.73,20917.867,21104.133,21384.775,21694.282,21902.39,21706.513,19913.143,21647.64,22024.502,22600.185,23292.362,23828.973,24654.603,25029.116,25544.273,25994.639,26408.405,26813.601,27063.012,27610.128,27944.627],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"GDP (Billion USD)"}},"legend":{"tracegroupgap":0},"title":{"text":"Gross Domestic Product Over Time"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Plot CPI</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cpi_plot <span class="op">=</span> px.line(cpi_data, x<span class="op">=</span><span class="st">'DATE'</span>, y<span class="op">=</span><span class="st">'CPIAUCSL'</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                   title<span class="op">=</span><span class="st">'Consumer Price Index Over Time'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                   labels<span class="op">=</span>{<span class="st">'DATE'</span>: <span class="st">'Date'</span>, <span class="st">'CPIAUCSL'</span>: <span class="st">'CPI'</span>},</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                   template<span class="op">=</span><span class="st">'plotly_white'</span>,  <span class="co"># Using the 'plotly_white' as a minimal theme</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                   color_discrete_sequence<span class="op">=</span>[<span class="st">'#99494d'</span>])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>cpi_plot.show()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="975f75ec-dab5-49f0-ae67-f4f110069d96" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("975f75ec-dab5-49f0-ae67-f4f110069d96")) {                    Plotly.newPlot(                        "975f75ec-dab5-49f0-ae67-f4f110069d96",                        [{"hovertemplate":"Date=%{x}\u003cbr\u003eCPI=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"#99494d","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00","2017-02-01T00:00:00","2017-03-01T00:00:00","2017-04-01T00:00:00","2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00","2023-12-01T00:00:00","2024-01-01T00:00:00","2024-02-01T00:00:00"],"xaxis":"x","y":[127.5,128.0,128.6,128.9,129.1,129.9,130.5,131.6,132.5,133.4,133.7,134.2,134.7,134.8,134.8,135.1,135.6,136.0,136.2,136.6,137.0,137.2,137.8,138.2,138.3,138.6,139.1,139.4,139.7,140.1,140.5,140.8,141.1,141.7,142.1,142.3,142.8,143.1,143.3,143.8,144.2,144.3,144.5,144.8,145.0,145.6,146.0,146.3,146.3,146.7,147.1,147.2,147.5,147.9,148.4,149.0,149.3,149.4,149.8,150.1,150.5,150.9,151.2,151.8,152.1,152.4,152.6,152.9,153.1,153.5,153.7,153.9,154.7,155.0,155.5,156.1,156.4,156.7,157.0,157.2,157.7,158.2,158.7,159.1,159.4,159.7,159.8,159.9,159.9,160.2,160.4,160.8,161.2,161.5,161.7,161.8,162.0,162.0,162.0,162.2,162.6,162.8,163.2,163.4,163.5,163.9,164.1,164.4,164.7,164.7,164.8,165.9,166.0,166.0,166.7,167.1,167.8,168.1,168.4,168.8,169.3,170.0,171.0,170.9,171.2,172.2,172.7,172.7,173.6,173.9,174.2,174.6,175.6,176.0,176.1,176.4,177.3,177.7,177.4,177.4,178.1,177.6,177.5,177.4,177.7,178.0,178.5,179.3,179.5,179.6,180.0,180.5,180.8,181.2,181.5,181.8,182.6,183.6,183.9,183.2,182.9,183.1,183.7,184.5,185.1,184.9,185.0,185.5,186.3,186.7,187.1,187.4,188.2,188.9,189.1,189.2,189.8,190.8,191.7,191.7,191.6,192.4,193.1,193.7,193.6,193.7,194.9,196.1,198.8,199.1,198.1,198.1,199.3,199.4,199.7,200.7,201.3,201.8,202.9,203.8,202.8,201.9,202.0,203.1,203.437,204.226,205.288,205.904,206.755,207.234,207.603,207.667,208.547,209.19,210.834,211.445,212.174,212.687,213.448,213.942,215.208,217.463,219.016,218.69,218.877,216.995,213.153,211.398,211.933,212.705,212.495,212.709,213.022,214.79,214.726,215.445,215.861,216.509,217.234,217.347,217.488,217.281,217.353,217.403,217.29,217.199,217.605,217.923,218.275,219.035,219.59,220.472,221.187,221.898,223.046,224.093,224.806,224.806,225.395,226.106,226.597,226.75,227.169,227.223,227.842,228.329,228.807,229.187,228.713,228.524,228.59,229.918,231.015,231.638,231.249,231.221,231.679,232.937,232.282,231.797,231.893,232.445,232.9,233.456,233.544,233.669,234.1,234.719,235.288,235.547,236.028,236.468,236.918,237.231,237.498,237.46,237.477,237.43,236.983,236.252,234.747,235.342,235.976,236.222,237.001,237.657,238.034,238.033,237.498,237.733,238.017,237.761,237.652,237.336,238.08,238.992,239.557,240.222,240.101,240.545,241.176,241.741,242.026,242.637,243.618,244.006,243.892,244.193,244.004,244.163,244.243,245.183,246.435,246.626,247.284,247.805,248.859,249.529,249.577,250.227,250.792,251.018,251.214,251.663,252.182,252.772,252.594,252.767,252.561,253.319,254.277,255.233,255.296,255.213,255.802,256.036,256.43,257.155,257.879,258.63,258.906,259.246,258.15,256.126,255.848,257.004,258.408,259.366,259.951,260.249,260.895,262.005,262.518,263.583,264.91,266.752,268.452,270.664,271.994,272.789,273.887,276.434,278.799,280.808,282.39,284.535,287.553,288.764,291.359,294.996,294.977,295.209,296.341,297.863,298.648,298.812,300.356,301.509,301.744,303.032,303.365,304.003,304.628,306.187,307.288,307.531,308.024,308.742,309.685,311.054],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"CPI"}},"legend":{"tracegroupgap":0},"title":{"text":"Consumer Price Index Over Time"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="normalize-split-the-data" class="level1">
<h1>3. Normalize &amp; Split the Data</h1>
<p>To improve the accuracy of our models, we will normalize the time series data and split it into training and testing sets. Normalizing helps align the data distributions and prepares the data for training. We’ll use a common split ratio of 80% training and 20% testing.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Crude Oil</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Natural Gas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Electricity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">GDP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">CPI</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the crude oil data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>oil_normalized <span class="op">=</span> (composite_crude_oil_prices[<span class="st">'Value'</span>] <span class="op">-</span> composite_crude_oil_prices[<span class="st">'Value'</span>].mean()) <span class="op">/</span> composite_crude_oil_prices[<span class="st">'Value'</span>].std()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>split_index <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.8</span> <span class="op">*</span> <span class="bu">len</span>(oil_normalized))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>oil_train <span class="op">=</span> oil_normalized[:split_index]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>oil_test <span class="op">=</span> oil_normalized[split_index:]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Crude Oil Data:"</span>, <span class="bu">len</span>(oil_normalized))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Crude Oil Data: 408</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Crude Oil Train Data:"</span>, <span class="bu">len</span>(oil_train))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Crude Oil Train Data: 326</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Crude Oil Test Data:"</span>, <span class="bu">len</span>(oil_test))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Crude Oil Test Data: 82</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train_dates <span class="op">=</span> composite_crude_oil_prices[<span class="st">'Date'</span>].iloc[:split_index]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>test_dates <span class="op">=</span> composite_crude_oil_prices[<span class="st">'Date'</span>].iloc[split_index:]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>oil_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Date'</span>: pd.concat([train_dates, test_dates]),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: pd.concat([oil_train, oil_test]),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Set'</span>: [<span class="st">'Training'</span>] <span class="op">*</span> <span class="bu">len</span>(oil_train) <span class="op">+</span> [<span class="st">'Testing'</span>] <span class="op">*</span> <span class="bu">len</span>(oil_test)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the training and testing sets</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>oil_plot1 <span class="op">=</span> px.area(oil_data, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>, color<span class="op">=</span><span class="st">'Set'</span>, title<span class="op">=</span><span class="st">'Crude Oil Training and Testing Sets'</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                    labels<span class="op">=</span>{<span class="st">'Value'</span>: <span class="st">'Normalized Crude Oil Prices'</span>}, template<span class="op">=</span><span class="st">'plotly_white'</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>oil_plot1.update_layout(title_x<span class="op">=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="0b350c6e-6ec4-4cf3-b8cc-e36d7c066829" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0b350c6e-6ec4-4cf3-b8cc-e36d7c066829")) {                    Plotly.newPlot(                        "0b350c6e-6ec4-4cf3-b8cc-e36d7c066829",                        [{"fillpattern":{"shape":""},"hovertemplate":"Set=Training\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized Crude Oil Prices=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Training","line":{"color":"#636efa"},"marker":{"symbol":"circle"},"mode":"lines","name":"Training","orientation":"v","showlegend":true,"stackgroup":"1","x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00","2017-02-01T00:00:00"],"xaxis":"x","y":[-0.9347928484087844,-0.945663762578467,-0.9842060946346141,-1.0530552177092702,-1.0787501057467017,-1.1169630161613435,-1.0813854788787458,-0.8389311507306746,-0.6254659270350901,-0.5230157965268697,-0.6093242666013191,-0.7552580537882696,-0.8619906656360619,-0.9878297326911749,-1.0253837998228055,-1.0066067662569902,-0.9987006468608576,-1.0224190050492559,-1.0029831282004293,-0.9914533707477358,-0.9832178297100975,-0.9506050872010499,-0.9650996394272934,-1.0362547139924883,-1.0711734079920745,-1.077761840822185,-1.0691968781430414,-1.032960497577433,-0.9944181655212857,-0.956205255106644,-0.952581617050083,-0.9703703856913818,-0.9693821207668653,-0.9726763371819206,-1.0000183334268797,-1.0405371953320601,-1.0510786878602372,-1.033619340860444,-1.0191247886342005,-1.0079244528230125,-1.0164894155021562,-1.046137363237654,-1.0843502736522956,-1.0932446579729451,-1.101150777369078,-1.0939035012559561,-1.1367283146516753,-1.2026126429527817,-1.1920711504246047,-1.184165031028472,-1.1812002362549219,-1.1324458333121035,-1.0942329228974617,-1.0477844714451816,-1.034278184143455,-1.0573376990488421,-1.0817149005202515,-1.0774324191806797,-1.0698557214260525,-1.0866562251428344,-1.0698557214260525,-1.0487727363696984,-1.046137363237654,-1.007595031181507,-1.0013360199929018,-1.0319722326529162,-1.0652438184449748,-1.0629378669544363,-1.0576671206903476,-1.0695262997845467,-1.0672203482940081,-1.0369135572754993,-1.0303251244453886,-1.0234072699737724,-0.9637819528612711,-0.9021801058997367,-0.9357811133333009,-0.9786059267290201,-0.9637819528612711,-0.9380870648238397,-0.8913091917300542,-0.8544139678814346,-0.8613318223530507,-0.8471666917683129,-0.8376134641646525,-0.9018506842582312,-0.9618054230122379,-1.010230404313551,-0.9957358520873077,-1.0283485945963553,-1.0270309080303333,-1.0155011505776397,-1.0171482587851672,-0.9832178297100975,-1.0046302364079571,-1.0576671206903476,-1.119268967651882,-1.1541876616514686,-1.1917417287830991,-1.1844944526699772,-1.1881180907265383,-1.221389676518597,-1.222707363084619,-1.226989844424191,-1.1861415608775052,-1.1993184265377264,-1.233907698895807,-1.2915564861592752,-1.2711323443859321,-1.2671792846878658,-1.2151306653299918,-1.122233762425432,-1.089291598274879,-1.0856679602183181,-1.019454210275706,-0.9700409640498763,-0.9005329976922091,-0.8922974566545708,-0.8530962813154125,-0.8073066731461436,-0.7750233522786015,-0.707162494128462,-0.6788322329589862,-0.7921532776368891,-0.7430694530525649,-0.655113874770588,-0.6679613187893038,-0.6590669344686543,-0.5892295464694817,-0.6057006285447583,-0.5935120278090535,-0.7480107776751479,-0.7763410388446237,-0.7552580537882696,-0.822460068655398,-0.8283896582024977,-0.7809529418257011,-0.7938003858444167,-0.8320132962590584,-0.8096126246366823,-0.833001561183575,-0.9545581468991163,-1.0467962065206653,-1.0705145647090633,-1.0421843035395877,-1.007595031181507,-0.889991505164032,-0.8208129604478703,-0.790176747787856,-0.822460068655398,-0.7858942664482841,-0.7519638373732143,-0.7035388560719011,-0.7351633336564322,-0.8043418783725937,-0.727586635901805,-0.6093242666013191,-0.5276276995079472,-0.6050417852617472,-0.7575640052788083,-0.7667878112409633,-0.6949738933927573,-0.6742203299779088,-0.654455031487577,-0.7453754045431036,-0.7005740612983513,-0.6831147142985581,-0.6501725501480049,-0.5958179792995922,-0.5697936696206553,-0.5243334830928918,-0.5121448823571872,-0.41825971452811067,-0.47524965850856754,-0.4064005354339115,-0.28714990120890915,-0.2525606288508282,-0.09509708421118401,-0.2387249199075958,-0.40903590856595573,-0.3296452929631227,-0.26244327809599427,-0.0736846775133245,-0.07599062900386322,-0.13759247596539756,0.04227174029662253,0.15855757974807524,0.33875121765160104,0.3677403221040879,0.26891382965242844,0.10255590069213501,0.11507392306934507,0.27385515427501134,0.19117032225712297,0.24256009833198597,0.4599783817256367,0.5377218891209424,0.530804034649326,0.6536783069308895,0.6177713480067863,0.326233195274391,0.16547543421969144,0.1513103036349536,0.22938323267176453,0.05775455744738272,0.17898172152141836,0.2577134938412405,0.3842114041793645,0.4181418332544343,0.5311334562908316,0.7320806576092058,0.6734436054212212,0.8078476351554785,1.01637153422848,1.2440018885088022,1.1949180639244783,1.2341192392636364,1.32009828769658,1.6122952837119864,1.8801150782559841,2.260597074194873,2.579477223172227,2.6358083238696732,2.132122634007716,1.643590339655012,0.8302483067778544,0.14208649767279866,-0.37378779292486386,-0.3810350690379855,-0.3579755541325984,-0.11354469613549385,-0.007800349212218156,0.22872438938875359,0.5502399114981524,0.47974368021596864,0.625018624119908,0.6167830830822697,0.7597520754956706,0.8388132694569984,0.788411758306652,0.8717554336075516,0.8421074858720535,0.9359926537011303,1.0479960118130107,0.7788585307029914,0.7788585307029914,0.8141066463440835,0.8421074858720535,0.8180597060421496,0.9468635678708128,1.0486548550960217,1.2166598922638432,1.2855090153384994,1.3718174854129483,1.7595467574649595,2.0916037721025353,1.937763865519452,1.8188426529359552,1.8336666268037043,1.6037303210328429,1.6594025784472777,1.6982743321449303,1.9193162535951422,1.8669382125957625,1.8346548917282204,1.9160220371800871,2.039225731103156,1.99837744755647,1.7839239589363687,1.4146422988086675,1.4436314032611546,1.6037303210328429,1.7443933619557048,1.680156141862126,1.573423530014334,1.5167630076753826,1.7051921866165467,1.7272634365974173,1.7200161604842956,1.6630262165038385,1.6850974664847091,1.6356842202588795,1.8063246305587446,1.883738716312545,1.8672676342372683,1.6930035858808419,1.4594436420534198,1.492385806203973,1.4680086047325638,1.6584143135227611,1.682462093352665,1.6844386232016983,1.6995920187109526,1.7621821305970038,1.7196867388427899,1.5348811979581867,1.4245249480538338,1.1850354146793118,0.8776850231546509,0.3848702474623757,-0.06643740140020284,-0.0031884462311406936,-0.03382465889115513,0.14801608721989823,0.31733881095374156,0.3657637922550547,0.1443924491633374,-0.1333099946258258,-0.15274587147465205,-0.1398984274559363,-0.249925255718784,-0.44098980779199226,-0.6267836136011123,-0.6748791732609198,-0.5006151249044936,-0.37247010635884176,-0.2021591177004818,-0.1006972521167781,-0.18964109532327175,-0.20808870724758136,-0.20710044232306496,-0.07137872602278576,-0.1632873640028291,-0.011753408910284686,0.032059669409951204,0.07323737459814267],"yaxis":"y","type":"scatter"},{"fillpattern":{"shape":""},"hovertemplate":"Set=Testing\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized Crude Oil Prices=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Testing","line":{"color":"#EF553B"},"marker":{"symbol":"circle"},"mode":"lines","name":"Testing","orientation":"v","showlegend":true,"stackgroup":"1","x":["2017-03-01T00:00:00","2017-04-01T00:00:00","2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00","2023-12-01T00:00:00"],"xaxis":"x","y":[-0.012082830551790153,0.014929744051663456,-0.018012420098889714,-0.12408618866367088,-0.09048518123010654,-0.026247961136528004,0.05808397908888818,0.12034466933343368,0.2876908632182437,0.3463279154062284,0.46887276604628614,0.41913009817895097,0.3884938855189365,0.5070856764609277,0.655325415138417,0.6368778032141071,0.7007856016661806,0.614806553233237,0.6678434375156275,0.7238451165715675,0.32919799004794065,-0.006153241004690591,0.1078266469562234,0.28340838187867173,0.4158358817638956,0.5762642211770896,0.530145191366315,0.3341393146705236,0.3792700795567816,0.2596900236902735,0.315691702746214,0.22510075133219276,0.2919733445578157,0.3707051168776378,0.2932910311238378,0.07751985593771443,-0.5424516733756962,-0.9782765050875145,-0.8389311507306746,-0.4024474757358453,-0.2943971773220308,-0.2173125132097363,-0.30329156164268006,-0.323056860133012,-0.2746318788316989,-0.09279113272064528,0.0781786992207256,0.3094326915576087,0.4267067959335781,0.4408719265183159,0.5314628779323374,0.7093505643453242,0.7564578590806155,0.6217244077048529,0.7274687546281283,0.9821116835119045,0.9702525044177054,0.7564578590806155,1.0292189782471957,1.3569935115451994,1.9094336043499764,1.8514553954450026,2.023084070669385,2.1551821489131027,1.7723942014836749,1.5411402091467916,1.2370840340371858,1.2848501720554881,1.1711997057360795,0.907332970890149,0.8766967582301343,0.8493547619851751,0.7887411799481572,0.9672877096441554,0.7686464598163198,0.7383396687978113,0.9023916462675657,1.0786322244730255,1.3280044070927128,1.239060563886219,1.0064888849833136,0.8220127657402161],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Normalized Crude Oil Prices"}},"legend":{"title":{"text":"Set"},"tracegroupgap":0},"title":{"text":"Crude Oil Training and Testing Sets","x":0.5}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the natural gas data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>gas_normalized <span class="op">=</span> (citygate_gas_prices[<span class="st">'Value'</span>] <span class="op">-</span> citygate_gas_prices[<span class="st">'Value'</span>].mean()) <span class="op">/</span> citygate_gas_prices[<span class="st">'Value'</span>].std()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>split_index <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.8</span> <span class="op">*</span> <span class="bu">len</span>(gas_normalized))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>gas_train <span class="op">=</span> gas_normalized[:split_index]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>gas_test <span class="op">=</span> gas_normalized[split_index:]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Natural Gas Data:"</span>, <span class="bu">len</span>(gas_normalized))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Natural Gas Data: 407</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Natural Gas Train Data:"</span>, <span class="bu">len</span>(gas_train))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Natural Gas Train Data: 325</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Natural Gas Test Data:"</span>, <span class="bu">len</span>(gas_test))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Natural Gas Test Data: 82</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>train_dates_gas <span class="op">=</span> citygate_gas_prices[<span class="st">'Date'</span>].iloc[:split_index]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>test_dates_gas <span class="op">=</span> citygate_gas_prices[<span class="st">'Date'</span>].iloc[split_index:]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>gas_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Date'</span>: pd.concat([train_dates_gas, test_dates_gas]),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: pd.concat([gas_train, gas_test]),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Set'</span>: [<span class="st">'Training'</span>] <span class="op">*</span> <span class="bu">len</span>(gas_train) <span class="op">+</span> [<span class="st">'Testing'</span>] <span class="op">*</span> <span class="bu">len</span>(gas_test)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the training and testing sets</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>gas_plot <span class="op">=</span> px.area(gas_data, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>, color<span class="op">=</span><span class="st">'Set'</span>, title<span class="op">=</span><span class="st">'Natural Gas Training and Testing Sets'</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                   labels<span class="op">=</span>{<span class="st">'Value'</span>: <span class="st">'Normalized Natural Gas Prices'</span>}, template<span class="op">=</span><span class="st">'plotly_white'</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>gas_plot.update_layout(title_x<span class="op">=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="2103ab58-b686-424a-b91c-55e2a778aeed" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2103ab58-b686-424a-b91c-55e2a778aeed")) {                    Plotly.newPlot(                        "2103ab58-b686-424a-b91c-55e2a778aeed",                        [{"fillpattern":{"shape":""},"hovertemplate":"Set=Training\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized Natural Gas Prices=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Training","line":{"color":"#636efa"},"marker":{"symbol":"circle"},"mode":"lines","name":"Training","orientation":"v","showlegend":true,"stackgroup":"1","x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00"],"xaxis":"x","y":[-0.8561108690522492,-0.9263077223858663,-1.0065326976242859,-1.061687368100699,-1.0717154900055017,-0.9764483319098786,-0.961406149052675,-1.0215748804814895,-1.0165608195290883,-1.0717154900055017,-0.9062514785762614,-0.8811811738142554,-0.9363358442906687,-1.0065326976242859,-1.0867576728627053,-1.10681391667231,-1.096785794767508,-1.0466451852434957,-1.10681391667231,-1.0867576728627053,-1.0215748804814895,-1.0165608195290883,-1.0165608195290883,-0.9513780271478726,-1.0265889414338907,-1.126870160481915,-1.1719967090535262,-1.10681391667231,-1.0265889414338907,-0.9764483319098786,-0.9714342709574774,-0.8861952347666565,-0.8611249300046505,-0.7257452842898175,-0.8109843204806383,-0.8912092957190578,-0.9212936614334651,-1.0065326976242859,-0.9463639661954711,-0.8561108690522492,-0.6856327966706078,-0.755829650004225,-0.8059702595282372,-0.8009561985758358,-0.7056890404802127,-0.9012374176238602,-0.9012374176238602,-0.8410686861950456,-0.9563920881002737,-0.8460827471474469,-0.8109843204806383,-0.9012374176238602,-0.8912092957190578,-0.8912092957190578,-0.9162796004810638,-0.9012374176238602,-1.0165608195290883,-1.076729550957903,-1.056673307148298,-1.0466451852434957,-1.081743611910304,-1.121856099529514,-1.10681391667231,-1.1168420385771125,-1.076729550957903,-1.0316030023862919,-1.0316030023862919,-1.0416311242910943,-1.0316030023862919,-1.061687368100699,-1.1419123433391187,-1.061687368100699,-0.9062514785762614,-0.8962233566714589,-0.8912092957190578,-0.8661389909570516,-0.8861952347666565,-0.7708718328614285,-0.7307593452422187,-0.7458015280994225,-0.9513780271478726,-1.0065326976242859,-0.7458015280994225,-0.3847891395265349,-0.3346485300025224,-0.595379699527386,-0.94134990524307,-1.0165608195290883,-0.9212936614334651,-0.7708718328614285,-0.755829650004225,-0.8059702595282372,-0.7257452842898175,-0.5452390900033738,-0.09397360428726419,-0.7658577719090274,-0.9363358442906687,-0.9363358442906687,-0.9463639661954711,-0.8611249300046505,-0.9162796004810638,-0.986476453814681,-0.8210124423854407,-0.9714342709574774,-1.0867576728627053,-0.9814623928622797,-0.9814623928622797,-0.9263077223858663,-1.0516592461958967,-1.0165608195290883,-1.0917717338151065,-1.036617063338693,-0.851096808099848,-0.9162796004810638,-0.9212936614334651,-0.780899954766231,-0.6806187357182067,-0.8711530519094529,-0.620450004289392,-0.8811811738142554,-0.8410686861950456,-0.7357734061946201,-0.7056890404802127,-0.6154359433369907,-0.3998313223837382,0.12163101666598851,0.1266450776183896,-0.15915639666847997,0.13165913857079073,0.35729188142884566,0.1266450776183896,0.8486698547641648,1.9868616909592416,1.0692885366698186,0.577910563334499,0.6781917823825234,0.41244655190525875,0.2168981747616114,-0.4600000538125529,-0.31459228619291757,-0.645520309051398,-0.7909280766710334,-0.46501411476495447,-0.5251828461937689,-0.5803375166701823,-0.595379699527386,-0.5552672119081763,-0.3697469566693311,-0.439943810002948,-0.3998313223837382,-0.5001125414317626,-0.6405062480989969,-0.4800562976221578,-0.31459228619291757,-0.1491282747636773,-0.10400172619206641,0.1667575652375994,0.44253091761966634,1.3450618890518855,0.32720751571443807,0.3723340642860494,0.7283323919065359,0.44253091761966634,0.26703878428562383,0.3171793938096359,0.1918278699996054,0.297123150000031,0.47261528333407343,0.7333464528589371,0.7032620871445294,0.6430933557157152,0.6832058433349246,0.7684448795257457,0.9990916833362017,0.8687260985737697,0.7834870623829491,0.5578543195248941,0.6781917823825234,1.2798790966706697,1.2748650357182687,1.0542463538126148,1.0743025976222198,1.1495135119082383,1.4252868642903052,1.2848931576230709,1.1795978776226452,1.3701321938138915,1.6308633633387546,2.663759919533406,3.6164315004896377,3.3206019042979658,2.919477028105868,2.9345192109630722,2.202466311912494,1.9367210814352296,1.6759899119103656,1.5255680833383296,1.2247244261942563,1.2297384871466577,1.5807227538147426,1.3701321938138915,0.7383605138113382,1.7662430090535883,1.8615101671492111,1.470413412861916,1.8163836185776003,1.9266929595304265,1.6308633633387546,1.7361586433391807,1.756214887148785,1.540610266195533,1.3300197061946817,1.0291760490506088,1.244780670003861,1.600778997624348,1.6659617900055634,1.7161023995295754,1.9868616909592416,2.2776772261985125,2.4531693595325548,3.0598707347731025,3.4609956109651994,3.7768814509664765,2.6336755538189984,2.026974178578451,1.4303009252427061,1.495483717623922,1.6108071195291502,1.515539961433527,1.1595416338130404,0.9539651347645904,0.38236218619085166,0.272052845238025,0.30213721095243207,0.3773481252384505,0.33222157666683966,0.2118841138092103,0.3522778204764445,0.6982480261921283,0.6380792947633137,0.9489510738121892,0.8486698547641648,0.7784730014305479,0.46760122238167234,0.43250279571486366,0.5377980757152893,0.6832058433349246,0.6380792947633137,0.38737624714325275,0.3773481252384505,0.26703878428562383,0.39740436904805543,0.3723340642860494,0.4024184300004565,0.39239030809565434,0.33723563761924075,0.4274887347624625,0.5879386852393017,0.6079949290489066,0.6230371119061103,0.4976855880960799,0.25199660142842006,0.17177162619000053,0.04140604142756894,-0.048847055715653294,-0.10901578714446752,-0.053861116668054404,-0.37977507857413334,-0.3246204080977202,-0.15915639666847997,-0.03380487285844951,0.09154665095158095,-0.09397360428726419,-0.1491282747636773,-0.0789314214300604,-0.0789314214300604,-0.21431106714489354,-0.19425482333528865,-0.09898766523966529,0.10658883380878473,0.30213721095243207,0.39740436904805543,0.2820809671428272,0.14670132142799452,0.13165913857079073,-0.03380487285844951,-0.08394548238246152,-0.008734568096443508,0.3071512719048332,0.7333464528589371,0.8135714280973566,0.347263759524043,0.477629344286475,0.552840258572493,0.5227558928580859,0.272052845238025,0.2820809671428272,0.10658883380878473,-0.01876269000124573,0.10157477285638361,-0.23436731095449798,-0.1892407623828871,-0.2995501033357142,-0.5101406633365652,-0.3496907128597262,-0.2544235547641029,-0.1491282747636773,-0.17921264047808486,-0.19425482333528865,-0.4750422366697567,-0.6304781261941945,-0.6003937604797871,-0.780899954766231,-0.7357734061946201,-0.7307593452422187,-0.8661389909570516,-0.755829650004225,-0.5552672119081763,-0.2644516766689055,-0.3095782252405164,-0.17419857952568374,-0.37977507857413334,-0.5251828461937689,-0.49509848047936156,-0.3697469566693311],"yaxis":"y","type":"scatter"},{"fillpattern":{"shape":""},"hovertemplate":"Set=Testing\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized Natural Gas Prices=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Testing","line":{"color":"#EF553B"},"marker":{"symbol":"circle"},"mode":"lines","name":"Testing","orientation":"v","showlegend":true,"stackgroup":"1","x":["2017-02-01T00:00:00","2017-03-01T00:00:00","2017-04-01T00:00:00","2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00"],"xaxis":"x","y":[-0.4098594442885409,-0.5552672119081763,-0.3747610176217322,-0.2644516766689055,-0.06388923857285662,-0.10901578714446752,-0.1691845185732822,-0.21431106714489354,-0.4600000538125529,-0.49008441952696025,-0.4750422366697567,-0.29453604238331266,-0.4800562976221578,-0.6304781261941945,-0.6505343700037993,-0.4048453833361398,-0.22935325000209686,-0.22433918904969577,0.1517153823803956,-0.11402984809686907,-0.42490162714574464,-0.3346485300025224,-0.11402984809686907,-0.4600000538125529,-0.5201687852413676,-0.439943810002948,-0.6154359433369907,-0.645520309051398,-0.389803200478936,-0.389803200478936,-0.3998313223837382,-0.439943810002948,-0.7658577719090274,-0.7458015280994225,-0.7257452842898175,-0.8460827471474469,-0.9313217833382677,-0.851096808099848,-0.9513780271478726,-0.8210124423854407,-0.5703093947653798,-0.5151547242889665,-0.4299156880981458,-0.439943810002948,-0.7257452842898175,-0.5703093947653798,-0.6906468576230091,-0.8410686861950456,3.58634713477523,-0.4299156880981458,-0.5151547242889665,-0.30456416428811534,0.05143416333237116,0.3171793938096359,0.38737624714325275,0.502699649048481,0.7433745747637392,0.5478261976200919,0.4625871614292712,0.26703878428562383,0.41244655190525875,0.30213721095243207,0.7935151842877517,1.7862992528631927,2.418070932865746,1.8915945328636188,2.6888302242954123,2.3779584452465365,0.9238807690501832,0.8887823423833746,1.590750875719545,1.1043869633366272,0.8035433061925539,0.1667575652375994,-0.3095782252405164,-0.389803200478936,-0.1391001528588751,0.04642010237997005,-0.0789314214300604,0.04140604142756894,-0.3948172614313371,-0.29453604238331266],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Normalized Natural Gas Prices"}},"legend":{"title":{"text":"Set"},"tracegroupgap":0},"title":{"text":"Natural Gas Training and Testing Sets","x":0.5}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the electricity data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>electricity_normalized <span class="op">=</span> (total_electricity_prices[<span class="st">'Value'</span>] <span class="op">-</span> total_electricity_prices[<span class="st">'Value'</span>].mean()) <span class="op">/</span> total_electricity_prices[<span class="st">'Value'</span>].std()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>split_index <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.8</span> <span class="op">*</span> <span class="bu">len</span>(electricity_normalized))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>electricity_train <span class="op">=</span> electricity_normalized[:split_index]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>electricity_test <span class="op">=</span> electricity_normalized[split_index:]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Electricity Prices Data:"</span>, <span class="bu">len</span>(electricity_normalized))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Electricity Prices Data: 407</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Electricity Prices Train Data:"</span>, <span class="bu">len</span>(electricity_train))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Electricity Prices Train Data: 325</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the Electricity Prices Test Data:"</span>, <span class="bu">len</span>(electricity_test))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the Electricity Prices Test Data: 82</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>train_dates_elec <span class="op">=</span> total_electricity_prices[<span class="st">'Date'</span>].iloc[:split_index]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>test_dates_elec <span class="op">=</span> total_electricity_prices[<span class="st">'Date'</span>].iloc[split_index:]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>elec_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Date'</span>: pd.concat([train_dates_elec, test_dates_elec]),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: pd.concat([electricity_train, electricity_test]),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Set'</span>: [<span class="st">'Training'</span>] <span class="op">*</span> <span class="bu">len</span>(electricity_train) <span class="op">+</span> [<span class="st">'Testing'</span>] <span class="op">*</span> <span class="bu">len</span>(electricity_test)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the training and testing sets</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>elec_plot <span class="op">=</span> px.area(elec_data, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>, color<span class="op">=</span><span class="st">'Set'</span>, title<span class="op">=</span><span class="st">'Electricity Training and Testing Sets'</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                    labels<span class="op">=</span>{<span class="st">'Value'</span>: <span class="st">'Normalized Electricity Prices'</span>}, template<span class="op">=</span><span class="st">'plotly_white'</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>elec_plot.update_layout(title_x<span class="op">=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="bf429f5d-5805-4128-90e8-989183c2ec5d" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("bf429f5d-5805-4128-90e8-989183c2ec5d")) {                    Plotly.newPlot(                        "bf429f5d-5805-4128-90e8-989183c2ec5d",                        [{"fillpattern":{"shape":""},"hovertemplate":"Set=Training\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized Electricity Prices=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Training","line":{"color":"#636efa"},"marker":{"symbol":"circle"},"mode":"lines","name":"Training","orientation":"v","showlegend":true,"stackgroup":"1","x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00"],"xaxis":"x","y":[-1.353328422786196,-1.320794503958424,-1.2991052247399093,-1.3099498643491667,-1.2503043464982515,-1.1147463513825357,-1.0008776354853344,-1.0171445948992204,-1.038833874117735,-1.1364356306010501,-1.2503043464982515,-1.2665713059121377,-1.2665713059121377,-1.212348107865851,-1.201503468256594,-1.212348107865851,-1.1581249098195647,-1.0008776354853344,-0.903275879002019,-0.9195428384159046,-0.9466544374390481,-1.0279892345084773,-1.1798141890380793,-1.1906588286473363,-1.185236508842708,-1.185236508842708,-1.1743918692334507,-1.1906588286473363,-1.1093240315779072,-0.9629213968529337,-0.8598973205649898,-0.8761642799788754,-0.8815865997835044,-1.0008776354853344,-1.1527025900149364,-1.1418579504056787,-1.168969549428822,-1.1798141890380793,-1.1798141890380793,-1.1635472296241933,-1.0551008335316205,-0.8870089195881329,-0.762295564081674,-0.767717883886303,-0.7839848433001886,-0.8707419601742469,-1.0930570721640211,-1.1472802702103073,-1.1472802702103073,-1.1255909909917927,-1.1310133107964218,-1.1364356306010501,-1.065945473140878,-0.8707419601742469,-0.762295564081674,-0.8056741225187032,-0.8273634017372177,-1.0117222750945913,-1.1527025900149364,-1.1581249098195647,-1.1743918692334507,-1.1310133107964218,-1.1418579504056787,-1.1472802702103073,-1.0984793919686495,-0.903275879002019,-0.767717883886303,-0.7731402036909315,-0.914120518611276,-0.9846106760714483,-1.1201686711871641,-1.1527025900149364,-1.168969549428822,-1.1743918692334507,-1.1472802702103073,-1.1581249098195647,-1.082212432554764,-0.941232117634419,-0.8110964423233321,-0.7948294829094461,-0.8707419601742469,-1.0062999552899627,-1.1472802702103073,-1.185236508842708,-1.1635472296241933,-1.168969549428822,-1.1418579504056787,-1.1798141890380793,-1.1093240315779072,-0.914120518611276,-0.8219410819325892,-0.8327857215418463,-0.8924312393927614,-1.0117222750945913,-1.1472802702103073,-1.1743918692334507,-1.1906588286473363,-1.21777042767048,-1.212348107865851,-1.2231927474751085,-1.1364356306010501,-0.9737660364621912,-0.8436303611511038,-0.8815865997835044,-0.9846106760714483,-1.1255909909917927,-1.2882605851306521,-1.2503043464982515,-1.271993625716766,-1.228615067279737,-1.2665713059121377,-1.2828382653260233,-1.228615067279737,-1.049678513726992,-0.89785355919739,-0.914120518611276,-1.0279892345084773,-1.1201686711871641,-1.2882605851306521,-1.2774159455213947,-1.2828382653260233,-1.2882605851306521,-1.2611489861075087,-1.2665713059121377,-1.1527025900149364,-0.9249651582205335,-0.8219410819325892,-0.7731402036909315,-0.89785355919739,-0.9900329958760767,-1.1418579504056787,-1.038833874117735,-1.0930570721640211,-1.0279892345084773,-0.9520767572436766,-0.9466544374390481,-0.8653196403696183,-0.6430045283798441,-0.4857572540456136,-0.5020242134594997,-0.6213152491613295,-0.7243393254492738,-0.9466544374390481,-0.941232117634419,-0.9846106760714483,-0.9737660364621912,-0.9846106760714483,-0.9846106760714483,-0.89785355919739,-0.7134946858400163,-0.588781330333558,-0.6430045283798441,-0.762295564081674,-0.8490526809557323,-0.9900329958760767,-0.9791883562668197,-0.9574990770483052,-0.9303874780251621,-0.8707419601742469,-0.8110964423233321,-0.7297616452539024,-0.5345581322872712,-0.40442245697618434,-0.4315340559993274,-0.6267375689659581,-0.7460286046677884,-0.8544750007603608,-0.8815865997835044,-0.8382080413464752,-0.8219410819325892,-0.7948294829094461,-0.7731402036909315,-0.7080723660353878,-0.45322333521784197,-0.35562157873452666,-0.31766534010212605,-0.4315340559993274,-0.632159888770587,-0.7297616452539024,-0.762295564081674,-0.7026500462307593,-0.6430045283798441,-0.6375822085752156,-0.6050482897474435,-0.5020242134594997,-0.2092189440095527,-0.08992790830772329,-0.030282390456807626,-0.04654934987069415,-0.2146412638141822,-0.3013983806882395,-0.3013983806882395,-0.24717518264195332,-0.149573426158638,-0.17668502518178159,-0.11161718752623738,-0.030282390456807626,0.28963447801628195,0.4251924731319979,0.44145943254588343,0.30047911762553897,0.0673193660265077,-0.07366094889383676,-0.1170395073308659,-0.030282390456807626,-0.014015431042922058,0.01851848778485004,0.029363127394107083,0.10527560465890831,0.3709692750857107,0.4739933513736555,0.4956826305921696,0.3601246354764537,0.21914432055610922,0.09443096504965032,0.07816400563576474,0.08358632544039327,0.07274168583113622,0.14323184329130798,0.24625591957925277,0.3818139146949687,0.8155994990652592,1.021647651641148,0.9891137328133757,0.8155994990652592,0.6366629455125141,0.4902603107875411,0.41434783352273985,0.4956826305921696,0.5499058286384558,0.4739933513736555,0.4360371127412549,0.5444835088338272,0.7396870218004589,0.8210218188698877,0.8155994990652592,0.7179977425819438,0.5065272702014266,0.311323757234796,0.3438576760625681,0.2787898384070239,0.3818139146949687,0.38723623449959726,0.41434783352273985,0.5173719098106847,0.7667986208236015,0.9186235753532039,0.8860896565254319,0.761376301018973,0.5661727880523423,0.4251924731319979,0.4089255137181113,0.38723623449959726,0.4306147929366264,0.4251924731319979,0.4197701533273684,0.5499058286384558,0.8101771792606306,0.9240458951578325,0.9348905347670895,0.8264441386745162,0.5770174276615994,0.44145943254588343,0.41434783352273985,0.457726391959769,0.44145943254588343,0.4089255137181113,0.3818139146949687,0.4739933513736555,0.7396870218004589,0.8318664584791456,0.8427110980884027,0.8101771792606306,0.5282165494199417,0.44145943254588343,0.4739933513736555,0.4739933513736555,0.5444835088338272,0.5119495900060561,0.4848379909829126,0.625818305903257,0.9132012555485745,1.0433369308596618,0.9836914130087472,0.9023566159393175,0.6800415039495432,0.5553281484430843,0.5932843870754849,0.7342647019958294,0.8481334178930312,0.8210218188698877,0.6691968643402861,0.7830655802374881,1.075870849687434,1.2276958042170356,1.1626279665614923,1.119249408124463,0.8535557376976598,0.7396870218004589,0.7342647019958294,0.7667986208236015,0.8644003773069169,0.8264441386745162,0.6746191841449147,0.7830655802374881,1.0162253318365193,1.1843172457800064,1.1300940477337202,1.097560128905948,0.8372887782837742,0.6963084633634298,0.6583522247310292,0.6529299049264006,0.6691968643402861,0.6691968643402861,0.5770174276615994,0.7017307831680583,0.9511574941809751,1.0487592506642904,1.108404768515206,1.0379146110550335,0.7505316614097159,0.7234200623865723,0.7179977425819438,0.7396870218004589],"yaxis":"y","type":"scatter"},{"fillpattern":{"shape":""},"hovertemplate":"Set=Testing\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized Electricity Prices=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Testing","line":{"color":"#EF553B"},"marker":{"symbol":"circle"},"mode":"lines","name":"Testing","orientation":"v","showlegend":true,"stackgroup":"1","x":["2017-02-01T00:00:00","2017-03-01T00:00:00","2017-04-01T00:00:00","2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00"],"xaxis":"x","y":[0.8210218188698877,0.8210218188698877,0.7071531029726867,0.8535557376976598,1.119249408124463,1.1843172457800064,1.1626279665614923,1.1355163675383486,0.8860896565254319,0.8210218188698877,0.761376301018973,0.8915119763300604,0.8969342961346889,0.8535557376976598,0.7667986208236015,0.8589780575022883,1.075870849687434,1.2060065249985215,1.2168511646077784,1.0270699714457763,0.8915119763300604,0.8589780575022883,0.7830655802374881,0.7993325396513736,0.8860896565254319,0.8535557376976598,0.7993325396513736,0.8752450169161748,1.0704485298828055,1.21142884480315,1.2385404438262935,1.1138270883198347,0.8806673367208033,0.8752450169161748,0.7884879000421166,0.7884879000421166,0.7884879000421166,0.7830655802374881,0.8535557376976598,0.8806673367208033,1.1463610071476067,1.243962763630922,1.222273484412407,1.2060065249985215,1.021647651641148,0.8752450169161748,0.8698226971115454,0.8264441386745162,1.2981859616772082,1.1246717279290916,1.0108030120318907,1.0433369308596618,1.3469868399188658,1.4554332360114381,1.5096564340577254,1.5313457132762396,1.3415645201142374,1.2873413220679513,1.2276958042170356,1.3415645201142374,1.4391662765975526,1.4717001954253248,1.515078753862354,1.7428161856567568,2.1603348106131617,2.360960643384421,2.534474877132537,2.4639847196723657,2.1115339323715037,1.9163304194048731,1.9705536174511593,2.1766017700270472,2.1711794502224184,1.9868205768650449,1.8512625817493291,1.8892188203817297,2.1603348106131617,2.36638296318905,2.4639847196723657,2.4314508008445936,2.122378571980761,2.0518884145205893],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Normalized Electricity Prices"}},"legend":{"title":{"text":"Set"},"tracegroupgap":0},"title":{"text":"Electricity Training and Testing Sets","x":0.5}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the GDP data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>gdp_normalized <span class="op">=</span> (gdp_data[<span class="st">'GDP'</span>] <span class="op">-</span> gdp_data[<span class="st">'GDP'</span>].mean()) <span class="op">/</span> gdp_data[<span class="st">'GDP'</span>].std()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>split_index <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.8</span> <span class="op">*</span> <span class="bu">len</span>(gdp_normalized))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>gdp_train <span class="op">=</span> gdp_normalized[:split_index]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>gdp_test <span class="op">=</span> gdp_normalized[split_index:]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the GDP Data:"</span>, <span class="bu">len</span>(gdp_normalized))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the GDP Data: 136</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the GDP Train Data:"</span>, <span class="bu">len</span>(gdp_train))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the GDP Train Data: 108</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the GDP Test Data:"</span>, <span class="bu">len</span>(gdp_test))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the GDP Test Data: 28</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>train_dates_gdp <span class="op">=</span> gdp_data[<span class="st">'DATE'</span>].iloc[:split_index]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>test_dates_gdp <span class="op">=</span> gdp_data[<span class="st">'DATE'</span>].iloc[split_index:]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>gdp_data_plot <span class="op">=</span> pd.DataFrame({</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Date'</span>: pd.concat([train_dates_gdp, test_dates_gdp]),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: pd.concat([gdp_train, gdp_test]),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Set'</span>: [<span class="st">'Training'</span>] <span class="op">*</span> <span class="bu">len</span>(gdp_train) <span class="op">+</span> [<span class="st">'Testing'</span>] <span class="op">*</span> <span class="bu">len</span>(gdp_test)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the training and testing sets</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>gdp_plot1 <span class="op">=</span> px.area(gdp_data_plot, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>, color<span class="op">=</span><span class="st">'Set'</span>, title<span class="op">=</span><span class="st">'GDP Training and Testing Sets'</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                    labels<span class="op">=</span>{<span class="st">'Value'</span>: <span class="st">'Normalized GDP'</span>}, template<span class="op">=</span><span class="st">'plotly_white'</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>gdp_plot1.update_layout(title_x<span class="op">=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="0b9f88dc-ce6e-4e43-b178-b4bdf7388de8" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0b9f88dc-ce6e-4e43-b178-b4bdf7388de8")) {                    Plotly.newPlot(                        "0b9f88dc-ce6e-4e43-b178-b4bdf7388de8",                        [{"fillpattern":{"shape":""},"hovertemplate":"Set=Training\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized GDP=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Training","line":{"color":"#636efa"},"marker":{"symbol":"circle"},"mode":"lines","name":"Training","orientation":"v","showlegend":true,"stackgroup":"1","x":["1990-01-01T00:00:00","1990-04-01T00:00:00","1990-07-01T00:00:00","1990-10-01T00:00:00","1991-01-01T00:00:00","1991-04-01T00:00:00","1991-07-01T00:00:00","1991-10-01T00:00:00","1992-01-01T00:00:00","1992-04-01T00:00:00","1992-07-01T00:00:00","1992-10-01T00:00:00","1993-01-01T00:00:00","1993-04-01T00:00:00","1993-07-01T00:00:00","1993-10-01T00:00:00","1994-01-01T00:00:00","1994-04-01T00:00:00","1994-07-01T00:00:00","1994-10-01T00:00:00","1995-01-01T00:00:00","1995-04-01T00:00:00","1995-07-01T00:00:00","1995-10-01T00:00:00","1996-01-01T00:00:00","1996-04-01T00:00:00","1996-07-01T00:00:00","1996-10-01T00:00:00","1997-01-01T00:00:00","1997-04-01T00:00:00","1997-07-01T00:00:00","1997-10-01T00:00:00","1998-01-01T00:00:00","1998-04-01T00:00:00","1998-07-01T00:00:00","1998-10-01T00:00:00","1999-01-01T00:00:00","1999-04-01T00:00:00","1999-07-01T00:00:00","1999-10-01T00:00:00","2000-01-01T00:00:00","2000-04-01T00:00:00","2000-07-01T00:00:00","2000-10-01T00:00:00","2001-01-01T00:00:00","2001-04-01T00:00:00","2001-07-01T00:00:00","2001-10-01T00:00:00","2002-01-01T00:00:00","2002-04-01T00:00:00","2002-07-01T00:00:00","2002-10-01T00:00:00","2003-01-01T00:00:00","2003-04-01T00:00:00","2003-07-01T00:00:00","2003-10-01T00:00:00","2004-01-01T00:00:00","2004-04-01T00:00:00","2004-07-01T00:00:00","2004-10-01T00:00:00","2005-01-01T00:00:00","2005-04-01T00:00:00","2005-07-01T00:00:00","2005-10-01T00:00:00","2006-01-01T00:00:00","2006-04-01T00:00:00","2006-07-01T00:00:00","2006-10-01T00:00:00","2007-01-01T00:00:00","2007-04-01T00:00:00","2007-07-01T00:00:00","2007-10-01T00:00:00","2008-01-01T00:00:00","2008-04-01T00:00:00","2008-07-01T00:00:00","2008-10-01T00:00:00","2009-01-01T00:00:00","2009-04-01T00:00:00","2009-07-01T00:00:00","2009-10-01T00:00:00","2010-01-01T00:00:00","2010-04-01T00:00:00","2010-07-01T00:00:00","2010-10-01T00:00:00","2011-01-01T00:00:00","2011-04-01T00:00:00","2011-07-01T00:00:00","2011-10-01T00:00:00","2012-01-01T00:00:00","2012-04-01T00:00:00","2012-07-01T00:00:00","2012-10-01T00:00:00","2013-01-01T00:00:00","2013-04-01T00:00:00","2013-07-01T00:00:00","2013-10-01T00:00:00","2014-01-01T00:00:00","2014-04-01T00:00:00","2014-07-01T00:00:00","2014-10-01T00:00:00","2015-01-01T00:00:00","2015-04-01T00:00:00","2015-07-01T00:00:00","2015-10-01T00:00:00","2016-01-01T00:00:00","2016-04-01T00:00:00","2016-07-01T00:00:00","2016-10-01T00:00:00"],"xaxis":"x","y":[-1.4181308062612128,-1.4031151008879903,-1.3936428279643804,-1.3954281643310271,-1.390193206642251,-1.3744283237144221,-1.3608315334618364,-1.3507548632225408,-1.3338073217634785,-1.3152952252047223,-1.2988091922507239,-1.279179261566997,-1.2708129583544796,-1.2571465291508688,-1.2445669834273287,-1.2219317451238143,-1.2044078338775035,-1.1818346688118164,-1.1673662740092419,-1.1460080937039059,-1.1344874039319994,-1.1243926791498455,-1.1068319710257093,-1.091449328562395,-1.0749626078162877,-1.0466991666857404,-1.0297505935385145,-1.0076788289202068,-0.9899881280874905,-0.9631350046762186,-0.9383748326522938,-0.9206497422141333,-0.9033564132723273,-0.8856081098504914,-0.8595755224251234,-0.8298467402065893,-0.8096100049347956,-0.7899171412731057,-0.7623339265382487,-0.7256156289611646,-0.7080752107042404,-0.6658549201521042,-0.6537420413744447,-0.6335245642817,-0.6275945926668923,-0.6054530171495326,-0.6056215262162101,-0.5948842316563275,-0.5737286061270592,-0.5558528892170521,-0.5392461487479435,-0.5259385750771453,-0.5065607202013259,-0.4827223615513389,-0.43906424159557156,-0.40371774537966504,-0.377716968339333,-0.34515551432034247,-0.3120568946643102,-0.27390042378754065,-0.23262051699628192,-0.20590495200678752,-0.16807879329031164,-0.13685956557181672,-0.08958142379894302,-0.0630560333275562,-0.04297869387699761,-0.01385551261033992,0.01642298745122308,0.04847943011426239,0.07634102870519177,0.10229503588211958,0.1008300386901874,0.12819780254693477,0.13392332795737563,0.08392256112146773,0.05343497225880263,0.04489500153879103,0.056526597788255514,0.09132320421310582,0.11081540452702793,0.14788447607964494,0.17563929494566957,0.20450369443135819,0.2117210409259777,0.24715798180420304,0.26265754892602833,0.296115024114873,0.3350691618899259,0.35885129353501144,0.37818272244348067,0.3955284955335899,0.4346930976939621,0.4485345699892854,0.48724884026636317,0.528203593338145,0.5291869641058282,0.5843427327978543,0.6334717231357461,0.6520164898196747,0.678058018542458,0.7152426391693686,0.7361931307021612,0.7419552810423999,0.7575674741220562,0.7895100871910744,0.8206218473925552,0.8544509022682271],"yaxis":"y","type":"scatter"},{"fillpattern":{"shape":""},"hovertemplate":"Set=Testing\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized GDP=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Testing","line":{"color":"#EF553B"},"marker":{"symbol":"circle"},"mode":"lines","name":"Testing","orientation":"v","showlegend":true,"stackgroup":"1","x":["2017-01-01T00:00:00","2017-04-01T00:00:00","2017-07-01T00:00:00","2017-10-01T00:00:00","2018-01-01T00:00:00","2018-04-01T00:00:00","2018-07-01T00:00:00","2018-10-01T00:00:00","2019-01-01T00:00:00","2019-04-01T00:00:00","2019-07-01T00:00:00","2019-10-01T00:00:00","2020-01-01T00:00:00","2020-04-01T00:00:00","2020-07-01T00:00:00","2020-10-01T00:00:00","2021-01-01T00:00:00","2021-04-01T00:00:00","2021-07-01T00:00:00","2021-10-01T00:00:00","2022-01-01T00:00:00","2022-04-01T00:00:00","2022-07-01T00:00:00","2022-10-01T00:00:00","2023-01-01T00:00:00","2023-04-01T00:00:00","2023-07-01T00:00:00","2023-10-01T00:00:00"],"xaxis":"x","y":[0.8872422507996132,0.9145061580479188,0.9581727034570201,1.0174075951988353,1.0675244269531183,1.1109170591548547,1.1483704345483132,1.1688558066674697,1.2008838779060178,1.2491397161616762,1.3023588342230994,1.3381425942722318,1.3044619305440528,0.9960954969647948,1.2943388343374074,1.3591395117723744,1.458127067927662,1.5771455375661583,1.669414740401825,1.8113801901171886,1.8757769616362112,1.964357191495855,2.0417967367237533,2.1129429841553233,2.1826156369936007,2.2255013664110863,2.3195768832727213,2.377093326430479],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Normalized GDP"}},"legend":{"title":{"text":"Set"},"tracegroupgap":0},"title":{"text":"GDP Training and Testing Sets","x":0.5}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the CPI data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cpi_normalized <span class="op">=</span> (cpi_data[<span class="st">'CPIAUCSL'</span>] <span class="op">-</span> cpi_data[<span class="st">'CPIAUCSL'</span>].mean()) <span class="op">/</span> cpi_data[<span class="st">'CPIAUCSL'</span>].std()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>split_index <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.8</span> <span class="op">*</span> <span class="bu">len</span>(cpi_normalized))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>cpi_train <span class="op">=</span> cpi_normalized[:split_index]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>cpi_test <span class="op">=</span> cpi_normalized[split_index:]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the CPI Data:"</span>, <span class="bu">len</span>(cpi_normalized))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the CPI Data: 410</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the CPI Train Data:"</span>, <span class="bu">len</span>(cpi_train))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the CPI Train Data: 328</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of the CPI Test Data:"</span>, <span class="bu">len</span>(cpi_test))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of the CPI Test Data: 82</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>train_dates_cpi <span class="op">=</span> cpi_data[<span class="st">'DATE'</span>].iloc[:split_index]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>test_dates_cpi <span class="op">=</span> cpi_data[<span class="st">'DATE'</span>].iloc[split_index:]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>cpi_data_plot <span class="op">=</span> pd.DataFrame({</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Date'</span>: pd.concat([train_dates_cpi, test_dates_cpi]),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: pd.concat([cpi_train, cpi_test]),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Set'</span>: [<span class="st">'Training'</span>] <span class="op">*</span> <span class="bu">len</span>(cpi_train) <span class="op">+</span> [<span class="st">'Testing'</span>] <span class="op">*</span> <span class="bu">len</span>(cpi_test)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the training and testing sets</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>cpi_plot1 <span class="op">=</span> px.area(cpi_data_plot, x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>, color<span class="op">=</span><span class="st">'Set'</span>, title<span class="op">=</span><span class="st">'CPI Training and Testing Sets'</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                    labels<span class="op">=</span>{<span class="st">'Value'</span>: <span class="st">'Normalized CPI'</span>}, template<span class="op">=</span><span class="st">'plotly_white'</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>cpi_plot1.update_layout(title_x<span class="op">=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="04a48c16-864a-4c9c-b485-6fae3a8851e8" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("04a48c16-864a-4c9c-b485-6fae3a8851e8")) {                    Plotly.newPlot(                        "04a48c16-864a-4c9c-b485-6fae3a8851e8",                        [{"fillpattern":{"shape":""},"hovertemplate":"Set=Training\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized CPI=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Training","line":{"color":"#636efa"},"marker":{"symbol":"circle"},"mode":"lines","name":"Training","orientation":"v","showlegend":true,"stackgroup":"1","x":["1990-01-01T00:00:00","1990-02-01T00:00:00","1990-03-01T00:00:00","1990-04-01T00:00:00","1990-05-01T00:00:00","1990-06-01T00:00:00","1990-07-01T00:00:00","1990-08-01T00:00:00","1990-09-01T00:00:00","1990-10-01T00:00:00","1990-11-01T00:00:00","1990-12-01T00:00:00","1991-01-01T00:00:00","1991-02-01T00:00:00","1991-03-01T00:00:00","1991-04-01T00:00:00","1991-05-01T00:00:00","1991-06-01T00:00:00","1991-07-01T00:00:00","1991-08-01T00:00:00","1991-09-01T00:00:00","1991-10-01T00:00:00","1991-11-01T00:00:00","1991-12-01T00:00:00","1992-01-01T00:00:00","1992-02-01T00:00:00","1992-03-01T00:00:00","1992-04-01T00:00:00","1992-05-01T00:00:00","1992-06-01T00:00:00","1992-07-01T00:00:00","1992-08-01T00:00:00","1992-09-01T00:00:00","1992-10-01T00:00:00","1992-11-01T00:00:00","1992-12-01T00:00:00","1993-01-01T00:00:00","1993-02-01T00:00:00","1993-03-01T00:00:00","1993-04-01T00:00:00","1993-05-01T00:00:00","1993-06-01T00:00:00","1993-07-01T00:00:00","1993-08-01T00:00:00","1993-09-01T00:00:00","1993-10-01T00:00:00","1993-11-01T00:00:00","1993-12-01T00:00:00","1994-01-01T00:00:00","1994-02-01T00:00:00","1994-03-01T00:00:00","1994-04-01T00:00:00","1994-05-01T00:00:00","1994-06-01T00:00:00","1994-07-01T00:00:00","1994-08-01T00:00:00","1994-09-01T00:00:00","1994-10-01T00:00:00","1994-11-01T00:00:00","1994-12-01T00:00:00","1995-01-01T00:00:00","1995-02-01T00:00:00","1995-03-01T00:00:00","1995-04-01T00:00:00","1995-05-01T00:00:00","1995-06-01T00:00:00","1995-07-01T00:00:00","1995-08-01T00:00:00","1995-09-01T00:00:00","1995-10-01T00:00:00","1995-11-01T00:00:00","1995-12-01T00:00:00","1996-01-01T00:00:00","1996-02-01T00:00:00","1996-03-01T00:00:00","1996-04-01T00:00:00","1996-05-01T00:00:00","1996-06-01T00:00:00","1996-07-01T00:00:00","1996-08-01T00:00:00","1996-09-01T00:00:00","1996-10-01T00:00:00","1996-11-01T00:00:00","1996-12-01T00:00:00","1997-01-01T00:00:00","1997-02-01T00:00:00","1997-03-01T00:00:00","1997-04-01T00:00:00","1997-05-01T00:00:00","1997-06-01T00:00:00","1997-07-01T00:00:00","1997-08-01T00:00:00","1997-09-01T00:00:00","1997-10-01T00:00:00","1997-11-01T00:00:00","1997-12-01T00:00:00","1998-01-01T00:00:00","1998-02-01T00:00:00","1998-03-01T00:00:00","1998-04-01T00:00:00","1998-05-01T00:00:00","1998-06-01T00:00:00","1998-07-01T00:00:00","1998-08-01T00:00:00","1998-09-01T00:00:00","1998-10-01T00:00:00","1998-11-01T00:00:00","1998-12-01T00:00:00","1999-01-01T00:00:00","1999-02-01T00:00:00","1999-03-01T00:00:00","1999-04-01T00:00:00","1999-05-01T00:00:00","1999-06-01T00:00:00","1999-07-01T00:00:00","1999-08-01T00:00:00","1999-09-01T00:00:00","1999-10-01T00:00:00","1999-11-01T00:00:00","1999-12-01T00:00:00","2000-01-01T00:00:00","2000-02-01T00:00:00","2000-03-01T00:00:00","2000-04-01T00:00:00","2000-05-01T00:00:00","2000-06-01T00:00:00","2000-07-01T00:00:00","2000-08-01T00:00:00","2000-09-01T00:00:00","2000-10-01T00:00:00","2000-11-01T00:00:00","2000-12-01T00:00:00","2001-01-01T00:00:00","2001-02-01T00:00:00","2001-03-01T00:00:00","2001-04-01T00:00:00","2001-05-01T00:00:00","2001-06-01T00:00:00","2001-07-01T00:00:00","2001-08-01T00:00:00","2001-09-01T00:00:00","2001-10-01T00:00:00","2001-11-01T00:00:00","2001-12-01T00:00:00","2002-01-01T00:00:00","2002-02-01T00:00:00","2002-03-01T00:00:00","2002-04-01T00:00:00","2002-05-01T00:00:00","2002-06-01T00:00:00","2002-07-01T00:00:00","2002-08-01T00:00:00","2002-09-01T00:00:00","2002-10-01T00:00:00","2002-11-01T00:00:00","2002-12-01T00:00:00","2003-01-01T00:00:00","2003-02-01T00:00:00","2003-03-01T00:00:00","2003-04-01T00:00:00","2003-05-01T00:00:00","2003-06-01T00:00:00","2003-07-01T00:00:00","2003-08-01T00:00:00","2003-09-01T00:00:00","2003-10-01T00:00:00","2003-11-01T00:00:00","2003-12-01T00:00:00","2004-01-01T00:00:00","2004-02-01T00:00:00","2004-03-01T00:00:00","2004-04-01T00:00:00","2004-05-01T00:00:00","2004-06-01T00:00:00","2004-07-01T00:00:00","2004-08-01T00:00:00","2004-09-01T00:00:00","2004-10-01T00:00:00","2004-11-01T00:00:00","2004-12-01T00:00:00","2005-01-01T00:00:00","2005-02-01T00:00:00","2005-03-01T00:00:00","2005-04-01T00:00:00","2005-05-01T00:00:00","2005-06-01T00:00:00","2005-07-01T00:00:00","2005-08-01T00:00:00","2005-09-01T00:00:00","2005-10-01T00:00:00","2005-11-01T00:00:00","2005-12-01T00:00:00","2006-01-01T00:00:00","2006-02-01T00:00:00","2006-03-01T00:00:00","2006-04-01T00:00:00","2006-05-01T00:00:00","2006-06-01T00:00:00","2006-07-01T00:00:00","2006-08-01T00:00:00","2006-09-01T00:00:00","2006-10-01T00:00:00","2006-11-01T00:00:00","2006-12-01T00:00:00","2007-01-01T00:00:00","2007-02-01T00:00:00","2007-03-01T00:00:00","2007-04-01T00:00:00","2007-05-01T00:00:00","2007-06-01T00:00:00","2007-07-01T00:00:00","2007-08-01T00:00:00","2007-09-01T00:00:00","2007-10-01T00:00:00","2007-11-01T00:00:00","2007-12-01T00:00:00","2008-01-01T00:00:00","2008-02-01T00:00:00","2008-03-01T00:00:00","2008-04-01T00:00:00","2008-05-01T00:00:00","2008-06-01T00:00:00","2008-07-01T00:00:00","2008-08-01T00:00:00","2008-09-01T00:00:00","2008-10-01T00:00:00","2008-11-01T00:00:00","2008-12-01T00:00:00","2009-01-01T00:00:00","2009-02-01T00:00:00","2009-03-01T00:00:00","2009-04-01T00:00:00","2009-05-01T00:00:00","2009-06-01T00:00:00","2009-07-01T00:00:00","2009-08-01T00:00:00","2009-09-01T00:00:00","2009-10-01T00:00:00","2009-11-01T00:00:00","2009-12-01T00:00:00","2010-01-01T00:00:00","2010-02-01T00:00:00","2010-03-01T00:00:00","2010-04-01T00:00:00","2010-05-01T00:00:00","2010-06-01T00:00:00","2010-07-01T00:00:00","2010-08-01T00:00:00","2010-09-01T00:00:00","2010-10-01T00:00:00","2010-11-01T00:00:00","2010-12-01T00:00:00","2011-01-01T00:00:00","2011-02-01T00:00:00","2011-03-01T00:00:00","2011-04-01T00:00:00","2011-05-01T00:00:00","2011-06-01T00:00:00","2011-07-01T00:00:00","2011-08-01T00:00:00","2011-09-01T00:00:00","2011-10-01T00:00:00","2011-11-01T00:00:00","2011-12-01T00:00:00","2012-01-01T00:00:00","2012-02-01T00:00:00","2012-03-01T00:00:00","2012-04-01T00:00:00","2012-05-01T00:00:00","2012-06-01T00:00:00","2012-07-01T00:00:00","2012-08-01T00:00:00","2012-09-01T00:00:00","2012-10-01T00:00:00","2012-11-01T00:00:00","2012-12-01T00:00:00","2013-01-01T00:00:00","2013-02-01T00:00:00","2013-03-01T00:00:00","2013-04-01T00:00:00","2013-05-01T00:00:00","2013-06-01T00:00:00","2013-07-01T00:00:00","2013-08-01T00:00:00","2013-09-01T00:00:00","2013-10-01T00:00:00","2013-11-01T00:00:00","2013-12-01T00:00:00","2014-01-01T00:00:00","2014-02-01T00:00:00","2014-03-01T00:00:00","2014-04-01T00:00:00","2014-05-01T00:00:00","2014-06-01T00:00:00","2014-07-01T00:00:00","2014-08-01T00:00:00","2014-09-01T00:00:00","2014-10-01T00:00:00","2014-11-01T00:00:00","2014-12-01T00:00:00","2015-01-01T00:00:00","2015-02-01T00:00:00","2015-03-01T00:00:00","2015-04-01T00:00:00","2015-05-01T00:00:00","2015-06-01T00:00:00","2015-07-01T00:00:00","2015-08-01T00:00:00","2015-09-01T00:00:00","2015-10-01T00:00:00","2015-11-01T00:00:00","2015-12-01T00:00:00","2016-01-01T00:00:00","2016-02-01T00:00:00","2016-03-01T00:00:00","2016-04-01T00:00:00","2016-05-01T00:00:00","2016-06-01T00:00:00","2016-07-01T00:00:00","2016-08-01T00:00:00","2016-09-01T00:00:00","2016-10-01T00:00:00","2016-11-01T00:00:00","2016-12-01T00:00:00","2017-01-01T00:00:00","2017-02-01T00:00:00","2017-03-01T00:00:00","2017-04-01T00:00:00"],"xaxis":"x","y":[-1.656962834686502,-1.646195553781873,-1.6332748166963185,-1.626814448153541,-1.6225075357916896,-1.6052798863442832,-1.5923591492587288,-1.5686711312685453,-1.5492900256402131,-1.5299089200118812,-1.523448551469104,-1.5126812705644752,-1.5019139896598463,-1.4997605334789201,-1.4997605334789201,-1.493300164936143,-1.4825328840315142,-1.473919059307811,-1.4696121469459598,-1.4609983222222565,-1.4523844974985531,-1.448077585136702,-1.4351568480511467,-1.426543023327444,-1.4243895671465179,-1.417929198603741,-1.4071619176991121,-1.4007015491563346,-1.3942411806135575,-1.3856273558898542,-1.377013531166151,-1.3705531626233736,-1.3640927940805965,-1.351172056995042,-1.3425582322713387,-1.3382513199094868,-1.327484039004858,-1.321023670462081,-1.316716758100229,-1.3059494771956002,-1.2973356524718975,-1.2951821962909713,-1.29087528392912,-1.2844149153863424,-1.2801080030244911,-1.2671872659389367,-1.2585734412152334,-1.2521130726724559,-1.2521130726724559,-1.2434992479487532,-1.23488542322505,-1.2327319670441244,-1.2262715985013468,-1.2176577737776435,-1.2068904928730146,-1.19396975578746,-1.1875093872446825,-1.185355931063757,-1.1767421063400536,-1.1702817377972767,-1.1616679130735734,-1.1530540883498703,-1.1465937198070932,-1.1336729827215382,-1.127212614178761,-1.1207522456359835,-1.1164453332741322,-1.1099849647313547,-1.1056780523695033,-1.0970642276458002,-1.092757315283949,-1.088450402922097,-1.0712227534746912,-1.0647623849319134,-1.0539951040272846,-1.0410743669417302,-1.0346139983989526,-1.0281536298561755,-1.021693261313398,-1.0173863489515467,-1.0066190680469178,-0.995851787142289,-0.9850845062376601,-0.9764706815139568,-0.9700103129711792,-0.9635499444284022,-0.961396488247476,-0.9592430320665504,-0.9592430320665504,-0.9527826635237734,-0.9484757511619215,-0.9398619264382182,-0.9312481017145157,-0.924787733171738,-0.9204808208098868,-0.9183273646289605,-0.9140204522671092,-0.9140204522671092,-0.9140204522671092,-0.9097135399052578,-0.9010997151815546,-0.8967928028197028,-0.8881789780960001,-0.8838720657341482,-0.8817186095532226,-0.8731047848295194,-0.868797872467668,-0.8623375039248904,-0.8558771353821135,-0.8558771353821135,-0.8537236792011872,-0.8300356612110038,-0.8278822050300781,-0.8278822050300781,-0.812808011763598,-0.8041941870398948,-0.7891199937734139,-0.7826596252306369,-0.7761992566878594,-0.7675854319641562,-0.7568181510595273,-0.741743957793047,-0.7202093959837893,-0.722362852164715,-0.715902483621938,-0.6943679218126803,-0.6836006409080514,-0.6836006409080514,-0.6642195352797192,-0.6577591667369417,-0.6512987981941647,-0.6426849734704615,-0.6211504116612038,-0.6125365869375005,-0.6103831307565748,-0.6039227622137973,-0.5845416565854652,-0.5759278318617626,-0.5823882004045395,-0.5823882004045395,-0.5673140071380594,-0.5780812880426882,-0.5802347442236139,-0.5823882004045395,-0.5759278318617626,-0.569467463318985,-0.5587001824143562,-0.5414725329669496,-0.5371656206050983,-0.5350121644241727,-0.5263983397004695,-0.5156310587958406,-0.509170690253063,-0.5005568655293604,-0.4940964969865828,-0.4876361284438052,-0.47040847899639937,-0.44887391718714165,-0.44241354864436405,-0.45748774191084485,-0.46394811045362183,-0.4596411980917705,-0.446720461006216,-0.42949281155880953,-0.416572074473255,-0.4208789868351063,-0.41872553065418067,-0.40795824974955175,-0.3907306003021453,-0.3821167755784427,-0.37350295085473945,-0.3670425823119619,-0.34981493286455606,-0.33474073959807527,-0.33043382723622394,-0.3282803710552983,-0.31535963396974315,-0.29382507216048537,-0.27444396653215386,-0.27444396653215386,-0.2765974227130795,-0.25936977326567306,-0.24429557999919288,-0.23137484291363836,-0.23352829909456402,-0.23137484291363836,-0.20553336874252867,-0.1796918945714196,-0.12154857768642327,-0.11508820914364631,-0.13662277095290407,-0.13662277095290407,-0.1107812967817944,-0.10862784060086873,-0.10216747205809178,-0.08063291024883401,-0.06771217316327886,-0.05694489225864999,-0.03325687426846657,-0.01387576864013446,-0.03541033044939222,-0.05479143607772433,-0.05263797989679868,-0.028949961906615262,-0.02169281457689502,-0.004702045309390918,0.01816765933204108,0.03143294940654355,0.049758861506221885,0.060073916612856645,0.06802016992047276,0.0693983818762651,0.08834879626841183,0.10219551951176459,0.13759833912618447,0.15075595639164074,0.16645465195058995,0.1775018821587393,0.19388968369558435,0.20452775722935768,0.2317905124798778,0.28035094935975396,0.3137941238495312,0.30677385669971335,0.3108008197580448,0.27027277443302156,0.18753698796185297,0.14974383198660568,0.1612648225545585,0.17788950427130595,0.17336724629136163,0.17797564251854278,0.1847159603648402,0.22278906564360793,0.2214108536878156,0.2368942036286718,0.24585258134132296,0.2598069773937219,0.2754195347054343,0.2778529401898804,0.2808893134049855,0.2764316591104693,0.2779821475607359,0.27905887565119847,0.2766254701667523,0.27466582504211035,0.28340885713666847,0.2902568477920127,0.29783701354887154,0.3142032805239072,0.3261549623280454,0.3451484458438109,0.3605456575374303,0.3758567309838122,0.40057840794084004,0.42312509415513283,0.4384792367251341,0.4384792367251341,0.4511630936307869,0.4664741670771688,0.47704763692551466,0.4803424248823309,0.4893654062804102,0.49052827261811016,0.5038581663780407,0.5143454979791491,0.5246390185239739,0.5328221520114924,0.5226147697139037,0.5185447375319543,0.5199660186113653,0.5485639166940597,0.572187330998815,0.585603363005983,0.5772264184621815,0.5766234507315224,0.5864862800401625,0.613576758796209,0.5994716208111451,0.5890273583336548,0.5910946762673437,0.6029817543860537,0.6127799800092663,0.6247531963752133,0.6266482378144285,0.6293400580405857,0.6386214541803754,0.651951347940306,0.664204513609774,0.6697819651183714,0.6801400893486242,0.6896152965446977,0.699305849358864,0.7060461672051614,0.7117958952082332,0.7109775818594818,0.7113436694102391,0.710331545005204,0.7007055958764657,0.6849638311938984,0.6525543156709656,0.665367379947474,0.6790202921345431,0.6843177943396207,0.7010932179890323,0.7152198905359056,0.7233384203379953,0.723316885776186,0.7117958952082332,0.716856517233409,0.722972332787238,0.7174594849640681,0.7151122177268587,0.7083072961951339,0.7243290101812216,0.7439685305512642,0.7561355579734949,0.7704560415766517,0.7678503595977313,0.7774117050410415,0.7910000135426831,0.8031670409649143,0.8093043910805527,0.822462008346009,0.8435874134808907,0.8519428234628829,0.8494878834166274,0.8559697865212144],"yaxis":"y","type":"scatter"},{"fillpattern":{"shape":""},"hovertemplate":"Set=Testing\u003cbr\u003eDate=%{x}\u003cbr\u003eNormalized CPI=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Testing","line":{"color":"#EF553B"},"marker":{"symbol":"circle"},"mode":"lines","name":"Testing","orientation":"v","showlegend":true,"stackgroup":"1","x":["2017-05-01T00:00:00","2017-06-01T00:00:00","2017-07-01T00:00:00","2017-08-01T00:00:00","2017-09-01T00:00:00","2017-10-01T00:00:00","2017-11-01T00:00:00","2017-12-01T00:00:00","2018-01-01T00:00:00","2018-02-01T00:00:00","2018-03-01T00:00:00","2018-04-01T00:00:00","2018-05-01T00:00:00","2018-06-01T00:00:00","2018-07-01T00:00:00","2018-08-01T00:00:00","2018-09-01T00:00:00","2018-10-01T00:00:00","2018-11-01T00:00:00","2018-12-01T00:00:00","2019-01-01T00:00:00","2019-02-01T00:00:00","2019-03-01T00:00:00","2019-04-01T00:00:00","2019-05-01T00:00:00","2019-06-01T00:00:00","2019-07-01T00:00:00","2019-08-01T00:00:00","2019-09-01T00:00:00","2019-10-01T00:00:00","2019-11-01T00:00:00","2019-12-01T00:00:00","2020-01-01T00:00:00","2020-02-01T00:00:00","2020-03-01T00:00:00","2020-04-01T00:00:00","2020-05-01T00:00:00","2020-06-01T00:00:00","2020-07-01T00:00:00","2020-08-01T00:00:00","2020-09-01T00:00:00","2020-10-01T00:00:00","2020-11-01T00:00:00","2020-12-01T00:00:00","2021-01-01T00:00:00","2021-02-01T00:00:00","2021-03-01T00:00:00","2021-04-01T00:00:00","2021-05-01T00:00:00","2021-06-01T00:00:00","2021-07-01T00:00:00","2021-08-01T00:00:00","2021-09-01T00:00:00","2021-10-01T00:00:00","2021-11-01T00:00:00","2021-12-01T00:00:00","2022-01-01T00:00:00","2022-02-01T00:00:00","2022-03-01T00:00:00","2022-04-01T00:00:00","2022-05-01T00:00:00","2022-06-01T00:00:00","2022-07-01T00:00:00","2022-08-01T00:00:00","2022-09-01T00:00:00","2022-10-01T00:00:00","2022-11-01T00:00:00","2022-12-01T00:00:00","2023-01-01T00:00:00","2023-02-01T00:00:00","2023-03-01T00:00:00","2023-04-01T00:00:00","2023-05-01T00:00:00","2023-06-01T00:00:00","2023-07-01T00:00:00","2023-08-01T00:00:00","2023-09-01T00:00:00","2023-10-01T00:00:00","2023-11-01T00:00:00","2023-12-01T00:00:00","2024-01-01T00:00:00","2024-02-01T00:00:00"],"xaxis":"x","y":[0.8518997543392641,0.8553237496669366,0.8570465146116769,0.8772890027123791,0.9042502740975701,0.9083633754031384,0.9225331170736296,0.9337526237762532,0.956450051923211,0.9708782083354135,0.9719118673022579,0.9859093324782755,0.9980763599005061,1.0029431708693983,1.0071639449840128,1.0168329632363697,1.0280094008153742,1.0407147922828364,1.0368816402807883,1.04060711947379,1.0361709997410833,1.0524941975925002,1.073124307805769,1.09371134889542,1.0950680262894028,1.0932806576592344,1.1059645145648873,1.1110036020282539,1.1194882193811015,1.1351007766928127,1.1506917994427162,1.1668642553614683,1.1728077944208237,1.1801295454359708,1.1565276656930241,1.1129417125910865,1.1069551044081136,1.1318490578596156,1.1620835826398135,1.182713692853082,1.1953114115114984,1.2017287109306571,1.2156400378594368,1.2395434014677134,1.250590631675862,1.2735249400027226,1.3021013035236078,1.3417679663762603,1.3783767214519982,1.426011172174076,1.4546521393803897,1.471772116018749,1.495417064885314,1.5502655938134942,1.6011948324923877,1.644457767167187,1.6785254439494326,1.7247170790302913,1.7897083865706307,1.815786740921642,1.8716689288166652,1.9499901301169358,1.9495809734425598,1.9545769917823081,1.978954115750388,2.0117297188240784,2.028634349844346,2.032166017981064,2.0654153814145575,2.0902447311806323,2.0953053532058084,2.123041868816131,2.1302128778986145,2.1439519283329207,2.1574110294637068,2.19098341132434,2.214692963876333,2.2199258623959826,2.2305424013679462,2.246004216746994,2.2663113085331235,2.295792123649997],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Normalized CPI"}},"legend":{"title":{"text":"Set"},"tracegroupgap":0},"title":{"text":"CPI Training and Testing Sets","x":0.5}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mini-batching" class="level1">
<h1>4. Mini Batching</h1>
<p>Mini-batching is a technique used in deep learning to efficiently train models on large datasets. Instead of processing the entire dataset at once, mini-batching involves creating small, sequential subsets of the data called “mini-batches.” This approach offers several benefits, including memory efficiency, faster convergence, and the ability to use stochastic gradient descent (SGD) optimization. By processing a portion of the data at a time, mini-batching reduces the memory requirements compared to processing the entire dataset simultaneously, making it feasible to train models on large datasets.</p>
<p>To implement mini-batching, the dataset is typically shuffled and divided into smaller batches of a fixed size. The model is then trained iteratively, processing one mini-batch at a time. The gradients are computed for each mini-batch, and the model’s parameters are updated accordingly. This process is repeated until the model has seen the entire dataset, which constitutes one epoch of training. The choice of mini-batch size is an important hyperparameter that determines the number of samples processed in each iteration, and it can impact the convergence speed and stability of the training process.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Crude Oil</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Natural Gas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Electricity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">GDP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">CPI</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> form_arrays(x, lookback<span class="op">=</span><span class="dv">3</span>, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    x_out <span class="op">=</span> []</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    y_out <span class="op">=</span> []</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    i_start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust the stopping condition for the loop to account for delay</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i_start <span class="op">+</span> lookback <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> <span class="bu">len</span>(x):</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        i_stop <span class="op">=</span> i_start <span class="op">+</span> lookback</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        i_pred <span class="op">=</span> i_stop <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span>  <span class="co"># Subtract 1 to stay within bounds</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        indices_to_keep <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(i_start, i_stop, step))</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        xtmp <span class="op">=</span> x[indices_to_keep]</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        ytmp <span class="op">=</span> x[i_pred]</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        x_out.append(xtmp)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        y_out.append(ytmp)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose <span class="kw">and</span> count <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>            plt.plot(np.arange(<span class="bu">len</span>(x)), x, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Value'</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>            plt.scatter(indices_to_keep, xtmp, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'Features'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>            plt.scatter(i_pred, ytmp, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Target'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>            plt.xlabel(<span class="st">'Index'</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>            plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>            plt.legend()</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>            plt.show()</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update start point</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>        i_start <span class="op">+=</span> step</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(x_out), np.array(y_out)</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>lookback <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numpy arrays</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>oil_train <span class="op">=</span> np.array(oil_train)</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>oil_test <span class="op">=</span> np.array(oil_test)</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mini-batches</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>oil_train_batches_x, oil_train_batches_y <span class="op">=</span> form_arrays(oil_train, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>oil_test_batches_x, oil_test_batches_y <span class="op">=</span> form_arrays(oil_test, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Print shapes</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Train shape: </span><span class="sc">{</span>oil_train_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>oil_train_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train shape: (321, 5), (321,)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test shape: </span><span class="sc">{</span>oil_test_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>oil_test_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test shape: (77, 5), (77,)</code></pre>
</div>
</div>
<section id="hyper-parameter-tuning-to-get-the-best-parmeters" class="level3">
<h3 class="anchored" data-anchor-id="hyper-parameter-tuning-to-get-the-best-parmeters">Hyper parameter tuning to get the best parmeters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scikeras.wrappers <span class="im">import</span> KerasRegressor</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> SimpleRNN, Dense</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of features</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">#features = 1</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Model definition function</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">#def get_model(optimizer="adam", units=50, L2=0.01):</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">#    model = Sequential()</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co">#    model.add(SimpleRNN(units, input_shape=(lookback, features), activation='relu', </span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                        recurrent_regularizer=regularizers.l2(L2)))</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    model.add(Dense(1, activation='linear'))</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    model.compile(loss="mse", optimizer=optimizer)</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    return model</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the SciKeras wrapper and specify training-related parameters</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co">#model = KerasRegressor(model=get_model, model__optimizer="adam", model__units=50, model__L2=0.01)</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hyperparameter space to search</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co">#param_dist = {</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co">#    'model__optimizer': ['adam', 'rmsprop'],</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co">#    'model__units': [30, 50, 100],</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="co">#    'model__L2': [0.01, 0.001, 0.0001],</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co">#    'batch_size': [32, 64, 128],</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co">#    'epochs': [50, 100, 200]</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co">#X_train = oil_train_batches_x</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co">#y_train = oil_train_batches_y</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize and fit the RandomizedSearchCV</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="co">#random_search = RandomizedSearchCV(estimator=model, param_distributions=param_dist, n_iter=10, cv=3)</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co">#random_search.fit(X_train, y_train)</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best score and parameters</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Best score: %f using %s" % (random_search.best_score_, random_search.best_params_))</span></span></code></pre></div>
</details>
</div>
</section>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> form_arrays(x, lookback<span class="op">=</span><span class="dv">3</span>, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    x_out <span class="op">=</span> []</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    y_out <span class="op">=</span> []</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    i_start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust the stopping condition for the loop to account for delay</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i_start <span class="op">+</span> lookback <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> <span class="bu">len</span>(x):</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        i_stop <span class="op">=</span> i_start <span class="op">+</span> lookback</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        i_pred <span class="op">=</span> i_stop <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span>  </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        indices_to_keep <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(i_start, i_stop, step))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        xtmp <span class="op">=</span> x[indices_to_keep]</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>        ytmp <span class="op">=</span> x[i_pred]</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>        x_out.append(xtmp)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>        y_out.append(ytmp)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose <span class="kw">and</span> count <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>            plt.plot(np.arange(<span class="bu">len</span>(x)), x, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Value'</span>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>            plt.scatter(indices_to_keep, xtmp, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'Features'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>            plt.scatter(i_pred, ytmp, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Target'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>            plt.xlabel(<span class="st">'Index'</span>)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>            plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>            plt.legend()</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>            plt.show()</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update start point</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>        i_start <span class="op">+=</span> step</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(x_out), np.array(y_out)</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>lookback <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numpy arrays</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>gas_train <span class="op">=</span> np.array(gas_train)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>gas_test <span class="op">=</span> np.array(gas_test)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mini-batches</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>gas_train_batches_x, gas_train_batches_y <span class="op">=</span> form_arrays(gas_train, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>gas_test_batches_x, gas_test_batches_y <span class="op">=</span> form_arrays(gas_test, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Print shapes</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Train shape: </span><span class="sc">{</span>gas_train_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>gas_train_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train shape: (320, 5), (320,)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test shape: </span><span class="sc">{</span>gas_test_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>gas_test_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test shape: (77, 5), (77,)</code></pre>
</div>
</div>
<section id="hyper-parameter-tuning-to-get-the-best-parmeters-1" class="level3">
<h3 class="anchored" data-anchor-id="hyper-parameter-tuning-to-get-the-best-parmeters-1">Hyper parameter tuning to get the best parmeters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from scikeras.wrappers import KerasRegressor</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># from tensorflow.keras.models import Sequential</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from tensorflow.keras.layers import SimpleRNN, Dense</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.model_selection import RandomizedSearchCV</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># import numpy as np</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define the number of features</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># features = 1</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Model definition function</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># def get_model(optimizer="adam", units=50, L2=0.01):</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     model = Sequential()</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     model.add(SimpleRNN(units, input_shape=(lookback, features), activation='relu',</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                         recurrent_regularizer=regularizers.l2(L2)))</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     model.add(Dense(1, activation='linear'))</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     model.compile(loss="mse", optimizer=optimizer)</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     return model</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create the SciKeras wrapper and specify training-related parameters</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="co"># model = KerasRegressor(model=get_model, model__optimizer="adam", model__units=50, model__L2=0.01)</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define the hyperparameter space to search</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="co"># param_dist = {</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     'model__optimizer': ['adam', 'rmsprop'],</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     'model__units': [30, 50, 100],</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     'model__L2': [0.01, 0.001, 0.0001],</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     'batch_size': [32, 64, 128],</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     'epochs': [50, 100, 200]</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train = gas_train_batches_x</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="co"># y_train = gas_train_batches_y</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # Initialize and fit the RandomizedSearchCV</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="co"># random_search = RandomizedSearchCV(estimator=model, param_distributions=param_dist, n_iter=10, cv=3)</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="co"># random_search.fit(X_train, y_train)</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the best score and parameters</span></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Best score: %f using %s" % (random_search.best_score_, random_search.best_params_))</span></span></code></pre></div>
</details>
</div>
</section>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> form_arrays(x, lookback<span class="op">=</span><span class="dv">3</span>, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    x_out <span class="op">=</span> []</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    y_out <span class="op">=</span> []</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    i_start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust the stopping condition for the loop to account for delay</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i_start <span class="op">+</span> lookback <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> <span class="bu">len</span>(x):</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        i_stop <span class="op">=</span> i_start <span class="op">+</span> lookback</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        i_pred <span class="op">=</span> i_stop <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span>  </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>        indices_to_keep <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(i_start, i_stop, step))</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        xtmp <span class="op">=</span> x[indices_to_keep]</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>        ytmp <span class="op">=</span> x[i_pred]</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        x_out.append(xtmp)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        y_out.append(ytmp)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose <span class="kw">and</span> count <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>            plt.plot(np.arange(<span class="bu">len</span>(x)), x, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Value'</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>            plt.scatter(indices_to_keep, xtmp, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'Features'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>            plt.scatter(i_pred, ytmp, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Target'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>            plt.xlabel(<span class="st">'Index'</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>            plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>            plt.legend()</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>            plt.show()</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update start point</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>        i_start <span class="op">+=</span> step</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(x_out), np.array(y_out)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>lookback <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numpy arrays</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>electricity_train <span class="op">=</span> np.array(electricity_train)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>electricity_test <span class="op">=</span> np.array(electricity_test)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mini-batches</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>electricity_train_batches_x, electricity_train_batches_y <span class="op">=</span> form_arrays(electricity_train, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>electricity_test_batches_x, electricity_test_batches_y <span class="op">=</span> form_arrays(electricity_test, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Print shapes</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Train shape: </span><span class="sc">{</span>electricity_train_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>electricity_train_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train shape: (320, 5), (320,)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test shape: </span><span class="sc">{</span>electricity_test_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>electricity_test_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test shape: (77, 5), (77,)</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> form_arrays(x, lookback<span class="op">=</span><span class="dv">3</span>, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    x_out <span class="op">=</span> []</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    y_out <span class="op">=</span> []</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    i_start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust the stopping condition for the loop to account for delay</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i_start <span class="op">+</span> lookback <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> <span class="bu">len</span>(x):</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        i_stop <span class="op">=</span> i_start <span class="op">+</span> lookback</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        i_pred <span class="op">=</span> i_stop <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span>  </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        indices_to_keep <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(i_start, i_stop, step))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>        xtmp <span class="op">=</span> x[indices_to_keep]</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        ytmp <span class="op">=</span> x[i_pred]</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>        x_out.append(xtmp)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>        y_out.append(ytmp)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose <span class="kw">and</span> count <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>            plt.plot(np.arange(<span class="bu">len</span>(x)), x, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Value'</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>            plt.scatter(indices_to_keep, xtmp, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'Features'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>            plt.scatter(i_pred, ytmp, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Target'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>            plt.xlabel(<span class="st">'Index'</span>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>            plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>            plt.legend()</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>            plt.show()</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update start point</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>        i_start <span class="op">+=</span> step</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(x_out), np.array(y_out)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>lookback <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numpy arrays</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>gdp_train <span class="op">=</span> np.array(gdp_train)</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>gdp_test <span class="op">=</span> np.array(gdp_test)</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mini-batches</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>gdp_train_batches_x, gdp_train_batches_y <span class="op">=</span> form_arrays(gdp_train, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>gdp_test_batches_x, gdp_test_batches_y <span class="op">=</span> form_arrays(gdp_test, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Print shapes</span></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Train shape: </span><span class="sc">{</span>gdp_train_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>gdp_train_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train shape: (103, 5), (103,)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test shape: </span><span class="sc">{</span>gdp_test_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>gdp_test_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test shape: (23, 5), (23,)</code></pre>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> form_arrays(x, lookback<span class="op">=</span><span class="dv">3</span>, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    x_out <span class="op">=</span> []</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    y_out <span class="op">=</span> []</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    i_start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust the stopping condition for the loop to account for delay</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i_start <span class="op">+</span> lookback <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> <span class="bu">len</span>(x):</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        i_stop <span class="op">=</span> i_start <span class="op">+</span> lookback</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>        i_pred <span class="op">=</span> i_stop <span class="op">+</span> delay <span class="op">-</span> <span class="dv">1</span>  </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        indices_to_keep <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(i_start, i_stop, step))</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        xtmp <span class="op">=</span> x[indices_to_keep]</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        ytmp <span class="op">=</span> x[i_pred]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        x_out.append(xtmp)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        y_out.append(ytmp)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose <span class="kw">and</span> count <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>            plt.plot(np.arange(<span class="bu">len</span>(x)), x, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Value'</span>)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>            plt.scatter(indices_to_keep, xtmp, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'Features'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>            plt.scatter(i_pred, ytmp, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Target'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>            plt.xlabel(<span class="st">'Index'</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>            plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>            plt.legend()</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>            plt.show()</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update start point</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>        i_start <span class="op">+=</span> step</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(x_out), np.array(y_out)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>lookback <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numpy arrays</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>cpi_train <span class="op">=</span> np.array(cpi_train)</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>cpi_test <span class="op">=</span> np.array(cpi_test)</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mini-batches</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>cpi_train_batches_x, cpi_train_batches_y <span class="op">=</span> form_arrays(cpi_train, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>cpi_test_batches_x, cpi_test_batches_y <span class="op">=</span> form_arrays(cpi_test, lookback<span class="op">=</span>lookback, delay<span class="op">=</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Print shapes</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Train shape: </span><span class="sc">{</span>cpi_train_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>cpi_train_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train shape: (323, 5), (323,)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test shape: </span><span class="sc">{</span>cpi_test_batches_x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>cpi_test_batches_y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test shape: (77, 5), (77,)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="recurrent-neural-networks-rnns" class="level1">
<h1>5. Recurrent Neural Networks (RNNs)</h1>
<p>Recurrent Neural Networks (RNNs) are designed to process sequential data, making them ideal for time series forecasting. Unlike traditional neural networks, RNNs have a memory component that allows them to consider previous time steps, making them particularly adept at handling temporal dependencies. In this section, we will implement an RNN to forecast future trends in our data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Crude Oil</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Natural Gas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Electricity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">GDP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">CPI</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL SUMMARY</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model without regularization:"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model without regularization:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_no_reg.summary())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ simple_rnn (SimpleRNN)          │ (None, 100)            │        10,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 1)              │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 10,301 (40.24 KB)
 Trainable params: 10,301 (40.24 KB)
 Non-trainable params: 0 (0.00 B)
None</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model with regularization:"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model with regularization:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_reg.summary())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ simple_rnn_1 (SimpleRNN)        │ (None, 100)            │        10,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_1 (Dense)                 │ (None, 1)              │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 10,301 (40.24 KB)
 Trainable params: 10,301 (40.24 KB)
 Non-trainable params: 0 (0.00 B)
None</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PREDICTIONS</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>Ytp_oil_no_reg <span class="op">=</span> model_no_reg.predict(oil_train_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m 1/11[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 46ms/step
[1m11/11[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4ms/step </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Yvp_oil_no_reg <span class="op">=</span> model_no_reg.predict(oil_test_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m1/3[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step
[1m3/3[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 395us/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Ytp_oil_reg <span class="op">=</span> model_reg.predict(oil_train_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m 1/11[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 43ms/step
[1m11/11[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4ms/step </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>Yvp_oil_reg <span class="op">=</span> model_reg.predict(oil_test_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m1/3[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step
[1m3/3[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 414us/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regression_report(yt, ytp, yv, yvp, model_name):</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"--------- Regression Report (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">) ---------"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"TRAINING:"</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    train_mse <span class="op">=</span> np.mean((yt <span class="op">-</span> ytp) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    train_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(yt <span class="op">-</span> ytp))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MSE"</span>, train_mse)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MAE"</span>, train_mae)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PARITY PLOT</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    ax.plot(yt, ytp, <span class="st">'ro'</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    ax.plot(yt, yt, <span class="st">'b-'</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Actual Crude Oil Prices'</span>, ylabel<span class="op">=</span><span class="st">'Predicted Crude Oil Prices'</span>,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Training Data Parity Plot (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PLOT PART OF THE PREDICTED TIME-SERIES</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    frac_plot <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> <span class="bu">int</span>(frac_plot <span class="op">*</span> yt.shape[<span class="dv">0</span>])</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    ax.plot(yt[<span class="dv">0</span>:upper], <span class="st">'b-'</span>)</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    ax.plot(ytp[<span class="dv">0</span>:upper], <span class="st">'r-'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>    ax.plot(ytp[<span class="dv">0</span>:upper], <span class="st">'ro'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Time'</span>, ylabel<span class="op">=</span><span class="st">'Crude Oil Prices (Blue=Actual &amp; Red=Prediction)'</span>,</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Training: Time-Series Prediction (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"VALIDATION:"</span>)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>    val_mse <span class="op">=</span> np.mean((yv <span class="op">-</span> yvp) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>    val_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(yv <span class="op">-</span> yvp))</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MSE"</span>, val_mse)</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MAE"</span>, val_mae)</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PARITY PLOT</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>    ax.plot(yv, yvp, <span class="st">'ro'</span>)</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>    ax.plot(yv, yv, <span class="st">'b-'</span>)</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Actual Crude Oil Prices'</span>, ylabel<span class="op">=</span><span class="st">'Predicted Crude Oil Prices'</span>,</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Validation Data Parity Plot (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PLOT PART OF THE PREDICTED TIME-SERIES</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> <span class="bu">int</span>(frac_plot <span class="op">*</span> yv.shape[<span class="dv">0</span>])</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>    ax.plot(yv[<span class="dv">0</span>:upper], <span class="st">'b-'</span>)</span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a>    ax.plot(yvp[<span class="dv">0</span>:upper], <span class="st">'r-'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a>    ax.plot(yvp[<span class="dv">0</span>:upper], <span class="st">'ro'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Time'</span>, ylabel<span class="op">=</span><span class="st">'Crude Oil Prices (Blue=Actual &amp; Red=Prediction)'</span>,</span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Validation: Time-Series Prediction (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train_mse, train_mae, val_mse, val_mae</span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression report for the non-regularized model</span></span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a>train_mse_no_reg, train_mae_no_reg, val_mse_no_reg, val_mae_no_reg <span class="op">=</span> regression_report(oil_train_batches_y, Ytp_oil_no_reg, oil_test_batches_y, Yvp_oil_no_reg, <span class="st">"Non-Regularized Model"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--------- Regression Report (Non-Regularized Model) ---------
TRAINING:
MSE 2.057447525365486
MAE 1.1040657098853608
VALIDATION:
MSE 0.7125121791569037
MAE 0.6608614428849604</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression report for the regularized model</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>train_mse_reg, train_mae_reg, val_mse_reg, val_mae_reg <span class="op">=</span> regression_report(oil_train_batches_y, Ytp_oil_reg, oil_test_batches_y, Yvp_oil_reg, <span class="st">"Regularized Model"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--------- Regression Report (Regularized Model) ---------
TRAINING:
MSE 1.5871615317542207
MAE 0.9847006660361983
VALIDATION:
MSE 0.5746023743688642
MAE 0.5908742771045011</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-25-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL SUMMARY</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model without regularization:"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model without regularization:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_no_reg_gas.summary())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_4"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ simple_rnn_2 (SimpleRNN)        │ (None, 100)            │        10,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_2 (Dense)                 │ (None, 1)              │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 10,301 (40.24 KB)
 Trainable params: 10,301 (40.24 KB)
 Non-trainable params: 0 (0.00 B)
None</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model with regularization:"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model with regularization:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_reg_gas.summary())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_5"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ simple_rnn_3 (SimpleRNN)        │ (None, 100)            │        10,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_3 (Dense)                 │ (None, 1)              │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 10,301 (40.24 KB)
 Trainable params: 10,301 (40.24 KB)
 Non-trainable params: 0 (0.00 B)
None</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILING THE MODELS</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>model_no_reg_gas.<span class="bu">compile</span>(optimizer<span class="op">=</span>RMSprop(learning_rate<span class="op">=</span>learning_rate), loss<span class="op">=</span>loss_function)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>model_reg_gas.<span class="bu">compile</span>(optimizer<span class="op">=</span>RMSprop(learning_rate<span class="op">=</span>learning_rate), loss<span class="op">=</span>loss_function)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>, patience<span class="op">=</span><span class="dv">10</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co"># TRAINING THE MODELS</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>history_gas_no_reg <span class="op">=</span> model_no_reg_gas.fit(gas_train_batches_x,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>                                      gas_train_batches_y,</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>                                      epochs<span class="op">=</span>number_of_epochs,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>                                      batch_size<span class="op">=</span>batch_size,</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>                                      verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>                                      validation_data<span class="op">=</span>(gas_test_batches_x, gas_test_batches_y),</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>                                      callbacks<span class="op">=</span>[early_stopping])</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>history_gas_reg <span class="op">=</span> model_reg_gas.fit(gas_train_batches_x,</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>                                gas_train_batches_y,</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>                                epochs<span class="op">=</span>number_of_epochs,</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>                                batch_size<span class="op">=</span>batch_size,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>                                verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>                                validation_data<span class="op">=</span>(gas_test_batches_x, gas_test_batches_y),</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>                                callbacks<span class="op">=</span>[early_stopping])</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> history_plot_separate(history_no_reg, history_reg):</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the history dictionaries</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>    history_dict_no_reg <span class="op">=</span> history_no_reg.history</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    history_dict_reg <span class="op">=</span> history_reg.history</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the loss values and epochs for both models</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>    loss_values_no_reg <span class="op">=</span> history_dict_no_reg[<span class="st">'loss'</span>]</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>    val_loss_values_no_reg <span class="op">=</span> history_dict_no_reg[<span class="st">'val_loss'</span>]</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>    loss_values_reg <span class="op">=</span> history_dict_reg[<span class="st">'loss'</span>]</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>    val_loss_values_reg <span class="op">=</span> history_dict_reg[<span class="st">'val_loss'</span>]</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine the number of epochs the training actually ran for</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>    epochs_no_reg <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(loss_values_no_reg) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>    epochs_reg <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(loss_values_reg) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot for non-regularized model</span></span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>    plt.plot(epochs_no_reg, loss_values_no_reg, <span class="st">'bo-'</span>, label<span class="op">=</span><span class="st">'Training Loss (No Reg)'</span>)</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>    plt.plot(epochs_no_reg, val_loss_values_no_reg, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Validation Loss (No Reg)'</span>)</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Training and Validation Loss for Non-Regularized Model'</span>)</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epochs'</span>)</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot for regularized model</span></span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>    plt.plot(epochs_reg, loss_values_reg, <span class="st">'ro-'</span>, label<span class="op">=</span><span class="st">'Training Loss (Reg)'</span>)</span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>    plt.plot(epochs_reg, val_loss_values_reg, <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'Validation Loss (Reg)'</span>)</span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Training and Validation Loss for Regularized Model'</span>)</span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epochs'</span>)</span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function to plot the history separately</span></span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a>history_plot_separate(history_gas_no_reg, history_gas_reg)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-28-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-28-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PREDICTIONS</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>Ytp_gas_no_reg <span class="op">=</span> model_no_reg_gas.predict(gas_train_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m 1/10[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 45ms/step
[1m10/10[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 413us/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>Yvp_gas_no_reg <span class="op">=</span> model_no_reg_gas.predict(gas_test_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m1/3[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step
[1m3/3[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 20ms/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>Ytp_gas_reg <span class="op">=</span> model_reg_gas.predict(gas_train_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m 1/10[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 43ms/step
[1m10/10[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 368us/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>Yvp_gas_reg <span class="op">=</span> model_reg_gas.predict(gas_test_batches_x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
[1m1/3[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step
[1m3/3[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 20ms/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regression_report(yt, ytp, yv, yvp, model_name):</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"--------- Regression Report (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">) ---------"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"TRAINING:"</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    train_mse <span class="op">=</span> np.mean((yt <span class="op">-</span> ytp) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    train_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(yt <span class="op">-</span> ytp))</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MSE"</span>, train_mse)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MAE"</span>, train_mae)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PARITY PLOT</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>    ax.plot(yt, ytp, <span class="st">'ro'</span>)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>    ax.plot(yt, yt, <span class="st">'b-'</span>)</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Actual Natural Gas Prices'</span>, ylabel<span class="op">=</span><span class="st">'Predicted Natural Gas Prices'</span>,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Training Data Parity Plot (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PLOT PART OF THE PREDICTED TIME-SERIES</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    frac_plot <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> <span class="bu">int</span>(frac_plot <span class="op">*</span> yt.shape[<span class="dv">0</span>])</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>    ax.plot(yt[<span class="dv">0</span>:upper], <span class="st">'b-'</span>)</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>    ax.plot(ytp[<span class="dv">0</span>:upper], <span class="st">'r-'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>    ax.plot(ytp[<span class="dv">0</span>:upper], <span class="st">'ro'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Time'</span>, ylabel<span class="op">=</span><span class="st">'Natural Gas Prices (Blue=Actual &amp; Red=Prediction)'</span>,</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Training: Time-Series Prediction (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"VALIDATION:"</span>)</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>    val_mse <span class="op">=</span> np.mean((yv <span class="op">-</span> yvp) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>    val_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(yv <span class="op">-</span> yvp))</span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MSE"</span>, val_mse)</span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"MAE"</span>, val_mae)</span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PARITY PLOT</span></span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>    ax.plot(yv, yvp, <span class="st">'ro'</span>)</span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a>    ax.plot(yv, yv, <span class="st">'b-'</span>)</span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Actual Natural Gas Prices'</span>, ylabel<span class="op">=</span><span class="st">'Predicted Natural Gas Prices'</span>,</span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Validation Data Parity Plot (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PLOT PART OF THE PREDICTED TIME-SERIES</span></span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> <span class="bu">int</span>(frac_plot <span class="op">*</span> yv.shape[<span class="dv">0</span>])</span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a>    ax.plot(yv[<span class="dv">0</span>:upper], <span class="st">'b-'</span>)</span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a>    ax.plot(yvp[<span class="dv">0</span>:upper], <span class="st">'r-'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true" tabindex="-1"></a>    ax.plot(yvp[<span class="dv">0</span>:upper], <span class="st">'ro'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Time'</span>, ylabel<span class="op">=</span><span class="st">'Natural Gas Prices (Blue=Actual &amp; Red=Prediction)'</span>,</span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="ss">f'Validation: Time-Series Prediction (</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-52"><a href="#cb100-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train_mse, train_mae, val_mse, val_mae</span>
<span id="cb100-53"><a href="#cb100-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-54"><a href="#cb100-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression report for the non-regularized model</span></span>
<span id="cb100-55"><a href="#cb100-55" aria-hidden="true" tabindex="-1"></a>train_mse_no_reg_gas, train_mae_no_reg_gas, val_mse_no_reg_gas, val_mae_no_reg_gas <span class="op">=</span> regression_report(gas_train_batches_y, Ytp_gas_no_reg, gas_test_batches_y, Yvp_gas_no_reg, <span class="st">"Non-Regularized Model"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--------- Regression Report (Non-Regularized Model) ---------
TRAINING:
MSE 1.9408074551606214
MAE 1.0688312200857946
VALIDATION:
MSE 1.2954949882886249
MAE 0.8018169148716671</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression report for the regularized model</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>train_mse_reg_gas, train_mae_reg_gas, val_mse_reg_gas, val_mae_reg_gas <span class="op">=</span> regression_report(gas_train_batches_y, Ytp_gas_reg, gas_test_batches_y, Yvp_gas_reg, <span class="st">"Regularized Model"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--------- Regression Report (Regularized Model) ---------
TRAINING:
MSE 1.784041519675799
MAE 1.0279044474907386
VALIDATION:
MSE 1.1728299873739059
MAE 0.7628686635232265</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="deep-learning-ts_files/figure-html/unnamed-chunk-29-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">

</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">

</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">

</div>
</div>
</div>
</section>
<section id="lstm" class="level1">
<h1>6. LSTM</h1>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Crude Oil</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Natural Gas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Electricity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">GDP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">CPI</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<section id="hyperparameter" class="level3">
<h3 class="anchored" data-anchor-id="hyperparameter">Hyperparameter</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scikeras.wrappers <span class="im">import</span> KerasRegressor</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> LSTM, Dense</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define the number of features</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># #features = 1</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Model definition function</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># def get_model(optimizer="adam", units=50, L2=0.01):</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     model = Sequential()</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     model.add(LSTM(units, input_shape=(lookback, features), activation='relu', </span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                    recurrent_regularizer=regularizers.l2(L2)))</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     model.add(Dense(1, activation='linear'))</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     model.compile(loss="mse", optimizer=optimizer)</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     return model</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create the SciKeras wrapper and specify training-related parameters</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="co"># model = KerasRegressor(model=get_model, model__optimizer="adam", model__units=50, model__L2=0.01)</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define the hyperparameter space to search</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="co"># param_dist = {</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     'model__optimizer': ['adam', 'rmsprop'],</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     'model__units': [30, 50, 100],</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     'model__L2': [0.01, 0.001, 0.0001],</span></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     'batch_size': [32, 64, 128],</span></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     'epochs': [50, 100, 200]</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train = oil_train_batches_x</span></span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a><span class="co"># y_train = oil_train_batches_y</span></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # Initialize and fit the RandomizedSearchCV</span></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a><span class="co"># random_search = RandomizedSearchCV(estimator=model, param_distributions=param_dist, n_iter=10, cv=3)</span></span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a><span class="co"># random_search.fit(X_train, y_train)</span></span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the best score and parameters</span></span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Best score: %f using %s" % (random_search.best_score_, random_search.best_params_))</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> <span class="st">"rmsprop"</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>loss_function <span class="op">=</span> <span class="st">"MeanSquaredError"</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>numbers_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>L2_reg <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>L2_no_reg <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>input_shape <span class="op">=</span> (oil_train_batches_x.shape[<span class="dv">1</span>], <span class="dv">1</span>) </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Choose the batch size ------</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co"># batch_size = 1 # stochastic training</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co"># batch_size = int(len(trainX) / 2.) # mini-batch training</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">64</span> <span class="co"># Update based on the best hyperparameters</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD MODEL</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units <span class="op">=</span> <span class="dv">100</span> <span class="co"># Update based on the best hyperparameters</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co"># CREATE MODEL WITHOUT REGULARIZATION</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>model_no_reg_l <span class="op">=</span> keras.Sequential()</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>model_no_reg_l.add(Input(shape<span class="op">=</span>input_shape))</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>model_no_reg_l.add(LSTM(</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>    units<span class="op">=</span>recurrent_hidden_units,</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>    return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>    recurrent_regularizer<span class="op">=</span>regularizers.L2(L2_no_reg),</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>    activation<span class="op">=</span><span class="st">'relu'</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>model_no_reg_l.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="co"># CREATE MODEL WITH REGULARIZATION</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>model_reg_l <span class="op">=</span> keras.Sequential()</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>model_reg_l.add(Input(shape<span class="op">=</span>input_shape))</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>model_reg_l.add(LSTM(</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>    units<span class="op">=</span>recurrent_hidden_units,</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>    return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>    recurrent_regularizer<span class="op">=</span>regularizers.L2(L2_reg),</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>    activation<span class="op">=</span><span class="st">'relu'</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>model_reg_l.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL SUMMARY</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"LSTM Model without regularization:"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>LSTM Model without regularization:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_no_reg_l.summary())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_6"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 100)            │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_4 (Dense)                 │ (None, 1)              │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 40,901 (159.77 KB)
 Trainable params: 40,901 (159.77 KB)
 Non-trainable params: 0 (0.00 B)
None</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"LSTM Model with regularization:"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>LSTM Model with regularization:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_reg_l.summary())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_7"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm_1 (LSTM)                   │ (None, 100)            │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_5 (Dense)                 │ (None, 1)              │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 40,901 (159.77 KB)
 Trainable params: 40,901 (159.77 KB)
 Non-trainable params: 0 (0.00 B)
None</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">

</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">

</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">

</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">

</div>
</div>
</div>
</section>
<section id="gru" class="level1">
<h1>7. GRU</h1>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Crude Oil</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Natural Gas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Electricity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">GDP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">CPI</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">

</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">

</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">

</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">

</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">

</div>
</div>
</div>
</section>
<section id="discussion" class="level1">
<h1>8. Discussion</h1>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>
<section id="how-do-the-results-from-the-3-different-ann-models-compare-with-each-other-in-terms-of-accuracy-and-predictive-power" class="level2">
<h2 class="anchored" data-anchor-id="how-do-the-results-from-the-3-different-ann-models-compare-with-each-other-in-terms-of-accuracy-and-predictive-power">8.1 How do the results from the 3 different ANN models compare with each other in terms of accuracy and predictive power?</h2>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>
</section>
<section id="what-effect-does-including-regularization-have-on-your-results" class="level2">
<h2 class="anchored" data-anchor-id="what-effect-does-including-regularization-have-on-your-results">8.2 What effect does including regularization have on your results?</h2>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>
</section>
<section id="how-far-into-the-future-can-the-deep-learning-model-accurately-predict-the-future" class="level2">
<h2 class="anchored" data-anchor-id="how-far-into-the-future-can-the-deep-learning-model-accurately-predict-the-future">8.3 How far into the future can the deep learning model accurately predict the future?</h2>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>
</section>
<section id="how-does-your-deep-learning-modeling-compare-to-the-traditional-single-variable-time-series-armaarima-models-from-hw-3" class="level2">
<h2 class="anchored" data-anchor-id="how-does-your-deep-learning-modeling-compare-to-the-traditional-single-variable-time-series-armaarima-models-from-hw-3">8.4. How does your deep learning modeling compare to the traditional single-variable time-series ARMA/ARIMA models from HW-3?</h2>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>
</section>
</section>
<section id="write-a-discussion-paragraph-comparing-your-models-use-rmse-and-forecasts-from-these-sections-with-your-deep-learning-models." class="level1">
<h1>9. Write a discussion paragraph Comparing your models (use RMSE) and forecasts from these sections with your Deep Learning Models.</h1>
<p>Now, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>