[
  {
    "objectID": "data-visualization.html",
    "href": "data-visualization.html",
    "title": "Time Series Data Visualization",
    "section": "",
    "text": "Visualization\n## Define custom colors for the two types\ncolors &lt;- c(\"Electricity\" = \"#499995\", \"Natural Gas\" = \"#b07ba1\")\n\np &lt;- plot_ly(data = combined_data, x = ~Date, y = ~Price, color = ~Type, colors = colors, type = 'scatter', mode = 'lines') %&gt;%\n  layout(title = \"Energy Price Trends Over Time\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Price\"))\n\n# To display the plot in your R environment\np\n\n\n\n\n\n\nThe chart presented illustrates the fluctuations in electricity and natural gas prices from the early 1980s. The graph reveals that natural gas prices have experienced significant volatility, characterized by sharp peaks and troughs, suggesting a market responsive to supply, demand, and regulatory changes over the years. Electricity prices, on the other hand, show a more gradual and steady increase over time, with less pronounced volatility but a consistent upward trend.\nUnderstanding these trends is essential for both consumers and policymakers. For consumers, it reflects the changing costs of utilities and can influence decisions around energy usage and conservation. For policymakers and industry stakeholders, the data can inform energy policy, investment in infrastructure, and the development of strategies for price stabilization."
  },
  {
    "objectID": "data-visualization.html#price-patterns-of-electricity-and-natural-gas",
    "href": "data-visualization.html#price-patterns-of-electricity-and-natural-gas",
    "title": "Time Series Data Visualization",
    "section": "",
    "text": "Visualization\n## Define custom colors for the two types\ncolors &lt;- c(\"Electricity\" = \"#499995\", \"Natural Gas\" = \"#b07ba1\")\n\np &lt;- plot_ly(data = combined_data, x = ~Date, y = ~Price, color = ~Type, colors = colors, type = 'scatter', mode = 'lines') %&gt;%\n  layout(title = \"Energy Price Trends Over Time\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Price\"))\n\n# To display the plot in your R environment\np\n\n\n\n\n\n\nThe chart presented illustrates the fluctuations in electricity and natural gas prices from the early 1980s. The graph reveals that natural gas prices have experienced significant volatility, characterized by sharp peaks and troughs, suggesting a market responsive to supply, demand, and regulatory changes over the years. Electricity prices, on the other hand, show a more gradual and steady increase over time, with less pronounced volatility but a consistent upward trend.\nUnderstanding these trends is essential for both consumers and policymakers. For consumers, it reflects the changing costs of utilities and can influence decisions around energy usage and conservation. For policymakers and industry stakeholders, the data can inform energy policy, investment in infrastructure, and the development of strategies for price stabilization."
  },
  {
    "objectID": "data-visualization.html#interactive-crude-oil-prices-and-the-consumer-price-index-cpi-over-time",
    "href": "data-visualization.html#interactive-crude-oil-prices-and-the-consumer-price-index-cpi-over-time",
    "title": "Time Series Data Visualization",
    "section": "Interactive Crude Oil Prices and the Consumer Price Index (CPI) over time",
    "text": "Interactive Crude Oil Prices and the Consumer Price Index (CPI) over time\nThe interactive visualization below look at the correlation between Crude Oil Prices and the Consumer Price Index (CPI) in the United States. The dashboard traces the trajectory of crude oil prices alongside CPI fluctuations from 1986 to 2023. The dynamic chart enables users to hover over any point in time to reveal detailed data on both crude oil prices and CPI values, providing an understanding of how energy prices impact the overall cost of living."
  },
  {
    "objectID": "data-visualization.html#interactive-state-wise-gdp",
    "href": "data-visualization.html#interactive-state-wise-gdp",
    "title": "Time Series Data Visualization",
    "section": "Interactive state-wise GDP",
    "text": "Interactive state-wise GDP\nThe Tableau dashboard below provides an interactive exploration of GDP data for each state in the United States. It features a map that allows you to view the GDP of each state. Additionally, there is a line graph that shows the GDP trends over various years for each state. This dashboard enables users to easily compare and analyze economic trends across different states over time.\n\n\n← Previous Page: Data Sources\nNext Page: EDA →"
  },
  {
    "objectID": "financial-ts-models.html",
    "href": "financial-ts-models.html",
    "title": "Financial Time Series Models (ARCH/GARCH)",
    "section": "",
    "text": "In this section of our project, we will analyze financial time series data related to key players in the energy market, specifically Exxon Mobil Corporation (XOM) and Chevron Corporation (CVX). These companies, pivotal in the global energy landscape, not only reflect the economic pulses of the oil industry but also provide insights into how shifts in energy policies and market dynamics influence significant economic indicators.\n\n\nExxon Mobil, a titan in the oil industry, has been at the forefront of energy production and innovation. The company’s activities span across the extraction, refining, and distribution of energy products, positioning it as a critical barometer for assessing the economic health and trends within the energy sector. By examining the financial time series of Exxon Mobil’s stock prices, we aim to capture the volatility and market sentiment that underpin the broader economic implications of shifts in oil prices and energy policies.\n\n\n\nSimilarly, Chevron, as a major competitor and another influential player in the oil market, offers a complementary perspective to the economic analysis of the energy sector. Chevron’s extensive operations in energy production and its strategic responses to global energy demands make its financial performance a valuable indicator of the sector’s economic stability and growth. The analysis of Chevron’s stock price volatility will help us understand how energy market fluctuations and transitions toward renewable resources impact major energy corporations.\n\n\n\nTo conduct the time series analysis of financial data from Exxon Mobil and Chevron, we will utilize ARCH (Autoregressive Conditional Heteroskedasticity) and GARCH (Generalized Autoregressive Conditional Heteroskedasticity) models. These models are particularly effective for financial market data as they adeptly handle the inherent volatility typical of stock return data. By examining the volatility patterns in the stock prices of XOM and CVX, we aim to glean insights into how market dynamics, driven by both traditional and renewable energy sources, are shaping the economic narratives of these leading corporations.\nIn this detailed exploration, our objective is to uncover how historical and present economic conditions, policy shifts, and global energy crises influence the financial trajectories of key energy players. These insights will not only deepen our understanding of the energy sector’s impact on global economics but also aid in formulating strategies for a sustainable energy future."
  },
  {
    "objectID": "financial-ts-models.html#returns",
    "href": "financial-ts-models.html#returns",
    "title": "Financial Time Series Models (ARCH/GARCH)",
    "section": "4.1 Returns",
    "text": "4.1 Returns\n\nExxon MobilChevron Corporation\n\n\n\n\nCode\n#ACF Plot for Exxon Mobil Stock\nExxon_acf &lt;- ggAcf(returns_exxon,40) + \n  ggtitle(\"ACF Plot for Exxon Mobil Returns \") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#PACF Plot for Exxon Mobil Stock\nExxon_pacf &lt;- ggPacf(returns_exxon,40) + \n  ggtitle(\"PACF Plot for Exxon Mobil Returns\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(Exxon_acf, Exxon_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nUpon examining the ACF and PACF plots we can see values quickly drop off and mostly lie within the significance bounds, the returns appear to be stationary. Possible q and p values would be q = 0, 1, 2 and p = 0, 1, 2\n\n\n\n\nCode\n#ACF Plot for Chevron Stock\nChevron_acf &lt;- ggAcf(returns_chevron,40) + \n  ggtitle(\"ACF Plot for Chevron Stock Returns\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#PACF Plot for Chevron Stock\nChevron_pacf &lt;- ggPacf(returns_chevron,40) + \n  ggtitle(\"PACF Plot for Chevron Stock Returns\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(Chevron_acf, Chevron_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nUpon examining the ACF and PACF plots we can see values quickly drop off and mostly lie within the significance bounds, the returns appear to be stationary. Possible q and p values would be q = 0, 1 and p = 0, 1"
  },
  {
    "objectID": "financial-ts-models.html#absolute-returns",
    "href": "financial-ts-models.html#absolute-returns",
    "title": "Financial Time Series Models (ARCH/GARCH)",
    "section": "4.2 Absolute Returns",
    "text": "4.2 Absolute Returns\nThe ACF and PACF plots for the absolute returns give us insights into the nature of volatility in the stock’s returns. When we analyze absolute returns, we’re focusing on the magnitude of changes, regardless of direction, which can often reveal volatility patterns.\n\nExxon MobilChevron Corporation\n\n\n\n\nCode\n#ACF Plot for Exxon Mobil Stock\nExxon_acf_abs &lt;- ggAcf(abs(returns_exxon),lag.max=40) + \n  ggtitle(\"ACF Plot for Exxon Mobil Absolute Returns\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#PACF Plot for Exxon Mobil Stock\nExxon_pacf_abs &lt;- ggPacf(abs(returns_exxon),lag.max=40) + \n  ggtitle(\"PACF Plot for Exxon Mobil Absolute Returns\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(Exxon_acf_abs, Exxon_pacf_abs, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for the absolute returns shows significant autocorrelation across several lags, this indicates persistent volatility in the stock price returns. This is also indicative of the volatility clustering seen in financial time series.\nThe PACF plot shows significant correlations at the early lags (from 1 to 11, then at 17 and 18). After these initial lags, the correlations in the PACF plot decrease and generally stay within the confidence interval\n\n\n\n\nCode\n#ACF Plot for Chevron Stock\nChevron_acf_abs &lt;- ggAcf(abs(returns_chevron),40) + \n  ggtitle(\"ACF Plot for Chevron Stock Absolute Returns\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#PACF Plot for Chevron Stock\nChevron_pacf_abs &lt;- ggPacf(abs(returns_chevron),40) + \n  ggtitle(\"PACF Plot for Chevron Stock Absolute Returns\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(Chevron_acf_abs, Chevron_pacf_abs, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for the absolute returns shows significant autocorrelation across all the lags, this indicates persistent volatility in the stock price returns. This is also indicative of the volatility clustering seen in financial time series.\nThe PACF plot shows significant correlations at the early lags (from 1 to 11). After these initial lags, the correlations in the PACF plot decrease and generally stay within the confidence interval"
  },
  {
    "objectID": "financial-ts-models.html#squared-returns",
    "href": "financial-ts-models.html#squared-returns",
    "title": "Financial Time Series Models (ARCH/GARCH)",
    "section": "4.3 Squared Returns",
    "text": "4.3 Squared Returns\nExamining squared returns is a technique in time series analysis to assess volatility patterns. When returns are squared, patterns in volatility might become more evident, as periods of high volatility will result in higher squared returns. These patterns are crucial for ARCH/GARCH models.\n\nExxon MobilChevron Corporation\n\n\n\n\nCode\n# ACF Plot for Exxon Mobil Squared Returns\nExxon_acf_se &lt;- ggAcf(returns_exxon^2, lag.max=40) + \n  ggtitle(\"ACF Plot for Exxon Mobil Squared Returns\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n# PACF Plot for Exxon Mobil Squared Returns\nExxon_pacf_se &lt;- ggPacf(returns_exxon^2, lag.max=40) + \n  ggtitle(\"PACF Plot for Exxon Mobil Squared Returns\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n# Arrange the plots on a grid\ngrid.arrange(Exxon_acf_se, Exxon_pacf_se, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for squared returns shows a much slower decay, indicating that volatility shocks have a long-lasting effect. The ACF plot here suggests that volatility shocks to Exxon Mobil’s stock prices are persistent, with a high level of autocorrelation extending across many lags.\nThe PACF plot for squared returns, while also showing some significant lags, doesn’t carry the same pattern of persistence as the ACF.\nThis persistence of volatility as indicated by the squared returns ACF and PACF plots reinforces the need for a GARCH model in capturing the time-varying volatility in the stock returns\n\n\n\n\nCode\n#ACF Plot for Chevron Stock\nChevron_acf_se &lt;- ggAcf(returns_chevron^2,40) + \n  ggtitle(\"ACF Plot for Chevron Stock Squared Returns\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#PACF Plot for Chevron Stock\nChevron_pacf_se &lt;- ggPacf(returns_chevron^2,40) + \n  ggtitle(\"PACF Plot for Chevron Stock Squared Returns\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(Chevron_acf_se, Chevron_pacf_se, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot here suggests that volatility shocks are persistent, with a high level of autocorrelation.\nThe PACF plot for squared returns, while also showing some significant lags, doesn’t carry the same pattern of persistence as the ACF.\nThis persistence of volatility as indicated by the squared returns ACF and PACF plots reinforces the need for a GARCH model in capturing the time-varying volatility in the stock returns"
  },
  {
    "objectID": "deep-learning-ts.html",
    "href": "deep-learning-ts.html",
    "title": "Deep Learning for TS",
    "section": "",
    "text": "{r, warning=FALSE, message=FALSE, echo=FALSE} #| code-fold: true #| code-summary: 'Importing Libraries' #| warning: false #| output: false library(ggplot2) library(readr) library(tidyverse) library(lubridate) library(forecast) library(tseries) library(plotly) library(gridExtra) library(zoo) library(astsa) library(ggplot2) library(zoo) library(plotly) library(vars) library(dplyr) library(quantmod) library(FinTS) library(gogarch) library(scales) library(reticulate)\n```{r, warning=FALSE, message=FALSE, echo=FALSE} #| code-fold: true #| code-summary: ‘Importing Libraries’ #| warning: false #| output: false\nlibrary(reticulate) use_python(“/Users/madhvimalhotra/myenv/bin/python”, required = TRUE)\n:::\n```{r, warning=FALSE, message=FALSE, echo=FALSE} #| code-fold: true #| code-summary: ‘Read data’ #| warning: false #| output: false\ncomposite_crude_oil_prices &lt;- read.csv(“data/composite_crude_oil_prices.csv”) citygate_gas_prices &lt;- read.csv(“data/citygate_gas_prices.csv”) total_electricity_prices &lt;- read.csv(“data/total_electricity_prices.csv”) gdp_data &lt;- read.csv(“data/gdp_data.csv”) cpi_data &lt;- read.csv(“data/cpi_data.csv”)"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil",
    "href": "deep-learning-ts.html#crude-oil",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil\n```{r, warning=FALSE, message=FALSE, echo=FALSE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: false\noil_plot &lt;- ggplot(composite_crude_oil_prices, aes(x = Date, y = Value)) + geom_line(color = “#99494d”) + theme_minimal() + labs(title = “Crude Oil Prices Over Time”, x = “Date”, y = “Crude Oil Prices”)+ theme(plot.title = element_text(hjust = 0.5))\nggplotly(oil_plot)\n\n\n\n\n## Natural Gas\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Plot Natural Gas Prices'\n#| warning: false\n#| output: true\n\n#Plotting\nng_plot &lt;- ggplot(citygate_gas_prices, aes(x = Date, y = Value)) +\n  geom_line(color = \"#99494d\") + \n  theme_minimal() + \n  labs(title = \"Natural Gas Price Over Time\", \n       x = \"Date\",\n       y = \"Price (USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\nggplotly(ng_plot)"
  },
  {
    "objectID": "deep-learning-ts.html#electricity",
    "href": "deep-learning-ts.html#electricity",
    "title": "Deep Learning for TS",
    "section": "Electricity",
    "text": "Electricity\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Plot Electricity Prices’ #| warning: false #| output: true\n#Plotting with ggplot2 electricity_plot &lt;- ggplot(total_electricity_prices, aes(x = Date, y = Value)) + geom_line(color = “#99494d”) + theme_minimal() + labs(title = “Average Price of Electricity to Ultimate Customers”,\nx = “Date”, y = “Price (Cents per Kilowatthour)”) + theme(plot.title = element_text(hjust = 0.5))\nggplotly(electricity_plot)\n\n\n\n\n\n## GDP\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Plot GDP'\n#| warning: false\n#| output: true\n\n#Plotting with ggplot2\ngdp_plot &lt;- ggplot(gdp_data, aes(x = DATE, y = GDP)) +\n  geom_line(color = \"#99494d\") + \n  theme_minimal() +\n  labs(title = \"Gross Domestic Product Over Time\",  \n       x = \"Date\",\n       y = \"GDP (Billion USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\nggplotly(gdp_plot)"
  },
  {
    "objectID": "deep-learning-ts.html#cpi",
    "href": "deep-learning-ts.html#cpi",
    "title": "Deep Learning for TS",
    "section": "CPI",
    "text": "CPI\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Plot CPI’ #| warning: false #| output: true\n#Plotting with ggplot2 cpi_plot &lt;- ggplot(cpi_data, aes(x = DATE, y = CPIAUCSL)) + geom_line(color = “#99494d”) +\ntheme_minimal() + labs(title = “Consumer Price Index Over Time”,\nx = “Date”, y = “CPI”) + theme(plot.title = element_text(hjust = 0.5))\nggplotly(cpi_plot)\n\n\n\n\n\n\n:::\n\n\n\n\n\n# 3. Normalize & Split the Data \n\nTo improve the accuracy of our models, we will normalize the time series data and split it into training and testing sets. Normalizing helps align the data distributions and prepares the data for training. We'll use a common split ratio of 80% training and 20% testing.\n\n\n::: panel-tabset\n\n## Crude Oil\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true\n\n\n#Normalize the crude oil data\noil_normalized &lt;- scale(composite_crude_oil_prices$Value)\n\n#Split data into training and testing\nsplit_index &lt;- floor(0.8 * length(oil_normalized))\noil_train &lt;- oil_normalized[1:split_index]\noil_test &lt;- oil_normalized[(split_index + 1):length(oil_normalized)]\n\n# Print the shapes\ncat(\"Shape of the Crude Oil Data:\", length(oil_normalized), \"\\n\")\ncat(\"Shape of the Crude Oil Train Data:\", length(oil_train), \"\\n\")\ncat(\"Shape of the Crude Oil Test Data:\", length(oil_test), \"\\n\")\n\n\n#Plot the training and testing sets\ntrain_dates &lt;- composite_crude_oil_prices$Date[1:split_index]\ntest_dates &lt;- composite_crude_oil_prices$Date[(split_index + 1):length(oil_normalized)]\n\noil_data &lt;- data.frame(\n  Date = c(train_dates, test_dates),\n  Value = c(oil_train, oil_test),\n  Set = c(rep(\"Training\", length(oil_train)), rep(\"Testing\", length(oil_test)))\n)\n\noil_plot1 &lt;- ggplot(oil_data, aes(x = Date, y = Value, fill = Set)) +\n  geom_area(position = \"stack\") +\n  theme_minimal() +\n  labs(title = \"Crude Oil Training and Testing Sets\",\n       x = \"Date\",\n       y = \"Normalized Crude Oil Prices\") +\n  theme(plot.title = element_text(hjust = 0.5))\n\nggplotly(oil_plot1)"
  },
  {
    "objectID": "deep-learning-ts.html#natural-gas",
    "href": "deep-learning-ts.html#natural-gas",
    "title": "Deep Learning for TS",
    "section": "Natural Gas",
    "text": "Natural Gas\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#gdp",
    "href": "deep-learning-ts.html#gdp",
    "title": "Deep Learning for TS",
    "section": "GDP",
    "text": "GDP\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil-1",
    "href": "deep-learning-ts.html#crude-oil-1",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#natural-gas-1",
    "href": "deep-learning-ts.html#natural-gas-1",
    "title": "Deep Learning for TS",
    "section": "Natural Gas",
    "text": "Natural Gas\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\ngas_train &lt;- as.matrix(gas_train) gas_test &lt;- as.matrix(gas_test) gas_train_batches &lt;- form_arrays(gas_train, lookback = lookback, delay = 1, step = 1, feature_columns = 1, target_columns = 1) gas_test_batches &lt;- form_arrays(gas_test, lookback = lookback, delay = 1, step = 1, feature_columns = 1, target_columns = 1)"
  },
  {
    "objectID": "deep-learning-ts.html#gdp-1",
    "href": "deep-learning-ts.html#gdp-1",
    "title": "Deep Learning for TS",
    "section": "GDP",
    "text": "GDP\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\ngdp_train &lt;- as.matrix(gdp_train) gdp_test &lt;- as.matrix(gdp_test) gdp_train_batches &lt;- form_arrays(gdp_train, lookback = lookback, delay = 1, step = 1, feature_columns = 1, target_columns = 1) gdp_test_batches &lt;- form_arrays(gdp_test, lookback = lookback, delay = 1, step = 1, feature_columns = 1, target_columns = 1)"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil-2",
    "href": "deep-learning-ts.html#crude-oil-2",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil\n\n\nCode\n# Load the mini-batches from .npy files\ntrainX = np.load(\"oil_train_batches_x.npy\")\ntrainY = np.load(\"oil_train_batches_y.npy\")\ntestX = np.load(\"oil_test_batches_x.npy\")\ntestY = np.load(\"oil_test_batches_y.npy\")\n\nXt1_oil = trainX.reshape(trainX.shape[0], trainX.shape[1] * trainX.shape[2])\noptimizer = \"rmsprop\"\nloss_function = \"MeanSquaredError\"\nlearning_rate = 0.001\nnumber_of_epochs = 200\nL2 = 0.01  # Regularization strength\ninput_shape = (trainX.shape[1], trainX.shape[2])\n\n\n# ------ Choose the batch size ------\n#batch_size=1                       # stocastic training\n#batch_size=int(len(Xt1_oil)/2.)    # mini-batch training\nbatch_size=len(Xt1_oil)              # batch training\n\n# BUILD MODEL\nrecurrent_hidden_units = 30\n\n# CREATE MODEL\nmodel_no_reg = keras.Sequential()\n\n# ADD RECURRENT LAYER\n\n# #COMMENT/UNCOMMENT TO USE RNN, LSTM,GRU\n#model.add(LSTM(\n#model.add(GRU(\nmodel_no_reg.add(SimpleRNN(\nunits=recurrent_hidden_units,\nreturn_sequences=False,\ninput_shape=input_shape, \n# recurrent_dropout=0.8,\n#recurrent_regularizer=regularizers.L2(L2),\nactivation='relu')\n          ) \n\n#CREATE MODEL WITH REGULARIZATION\nmodel_reg = keras.Sequential()\nmodel_reg.add(SimpleRNN(\nunits=recurrent_hidden_units,\nreturn_sequences=False,\ninput_shape=input_shape,\nrecurrent_regularizer=regularizers.L2(L2),\nactivation='relu'\n))\n     \n# NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR \nmodel_no_reg.add(Dense(units=1, activation='linear'))\nmodel_reg.add(Dense(units=1, activation='linear'))\n\n\n\n\nCode\n# MODEL SUMMARY\nprint(\"Model without regularization:\")\nprint(model_no_reg.summary())\n\nprint(\"Model with regularization:\")\nprint(model_reg.summary())\n\n\nModel without regularization:\nModel: \"sequential\"\n_________________________________________________________________\n Layer (type)                Output Shape              Param #   \n=================================================================\n simple_rnn (SimpleRNN)      (None, 30)                960       \n                                                                 \n dense (Dense)               (None, 1)                 31        \n                                                                 \n=================================================================\nTotal params: 991 (3.87 KB)\nTrainable params: 991 (3.87 KB)\nNon-trainable params: 0 (0.00 Byte)\n_________________________________________________________________\nNone\nModel with regularization:\nModel: \"sequential_1\"\n_________________________________________________________________\n Layer (type)                Output Shape              Param #   \n=================================================================\n simple_rnn_1 (SimpleRNN)    (None, 30)                960       \n                                                                 \n dense_1 (Dense)             (None, 1)                 31        \n                                                                 \n=================================================================\nTotal params: 991 (3.87 KB)\nTrainable params: 991 (3.87 KB)\nNon-trainable params: 0 (0.00 Byte)\n_________________________________________________________________\nNone\n\n\n\n\nCode\n# # print(\"initial parameters:\", model.get_weights())\n\n# COMPILING THE MODELS\nmodel_no_reg.compile(optimizer=RMSprop(learning_rate=learning_rate), loss=loss_function)\nmodel_reg.compile(optimizer=RMSprop(learning_rate=learning_rate), loss=loss_function)\n\nearly_stopping = EarlyStopping(monitor='val_loss', patience=10, restore_best_weights=True)\n\n# TRAINING THE MODELS\nhistory_oil_no_reg = model_no_reg.fit(trainX,\n                                      trainY,\n                                      epochs=number_of_epochs,\n                                      batch_size=batch_size,\n                                      verbose=False,\n                                      validation_data=(testX, testY),\n                                      callbacks=[early_stopping])\n\nhistory_oil_reg = model_reg.fit(trainX,\n                                trainY,\n                                epochs=number_of_epochs,\n                                batch_size=batch_size,\n                                verbose=False,\n                                validation_data=(testX, testY),\n                                callbacks=[early_stopping])\n\ndef history_plot(history_no_reg, history_reg):\n    FS = 18  # fontsize\n    \n    # Get the history dictionaries\n    history_dict_no_reg = history_no_reg.history\n    history_dict_reg = history_reg.history\n    \n    # Get the loss values and epochs for both models\n    loss_values_no_reg = history_dict_no_reg['loss']\n    val_loss_values_no_reg = history_dict_no_reg['val_loss']\n    loss_values_reg = history_dict_reg['loss']\n    val_loss_values_reg = history_dict_reg['val_loss']\n    epochs = range(1, len(loss_values_no_reg) + 1)\n    \n    # Create a new figure\n    plt.figure(figsize=(12, 6))\n    \n    # Plot the training and validation loss for the non-regularized model\n    plt.plot(epochs, loss_values_no_reg, 'bo', label='Training Loss (No Reg)')\n    plt.plot(epochs, val_loss_values_no_reg, 'b', label='Validation Loss (No Reg)')\n    \n    # Plot the training and validation loss for the regularized model\n    plt.plot(epochs, loss_values_reg, 'ro', label='Training Loss (Reg)')\n    plt.plot(epochs, val_loss_values_reg, 'r', label='Validation Loss (Reg)')\n    \n    # Add labels and legend\n    plt.title('Training and Validation Loss')\n    plt.xlabel('Epochs')\n    plt.ylabel('Loss')\n    plt.legend()\n    \n    # Show the plot\n    plt.show()\n\n# History plot\nhistory_plot(history_oil_no_reg, history_oil_reg)\n\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.RMSprop` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.RMSprop`.\nWARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.RMSprop`.\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.RMSprop` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.RMSprop`.\nWARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.RMSprop`.\n\n\n\n\n\n\n\n\n\n\n\nCode\n# PREDICTIONS\nYtp_oil_no_reg = model_no_reg.predict(trainX)\nYvp_oil_no_reg = model_no_reg.predict(testX)\n\nYtp_oil_reg = model_reg.predict(trainX)\nYvp_oil_reg = model_reg.predict(testX)\n\n\n 1/10 [==&gt;...........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b10/10 [==============================] - 0s 515us/step\n1/3 [=========&gt;....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b3/3 [==============================] - 0s 736us/step\n 1/10 [==&gt;...........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b10/10 [==============================] - 0s 426us/step\n1/3 [=========&gt;....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b3/3 [==============================] - 0s 564us/step\n\n\n\n\nCode\ndef regression_report(yt, ytp, yv, yvp, model_name):\n    print(f\"--------- Regression Report ({model_name}) ---------\")\n    print(\"TRAINING:\")\n    train_mse = np.mean((yt - ytp) ** 2)\n    train_mae = np.mean(np.abs(yt - ytp))\n    print(\"MSE\", train_mse)\n    print(\"MAE\", train_mae)\n    \n    # PARITY PLOT\n    fig, ax = plt.subplots()\n    ax.plot(yt, ytp, 'ro')\n    ax.plot(yt, yt, 'b-')\n    ax.set(xlabel='Actual Crude Oil Prices', ylabel='Predicted Crude Oil Prices',\n           title=f'Training Data Parity Plot ({model_name})')\n    plt.show()\n    \n    # PLOT PART OF THE PREDICTED TIME-SERIES\n    frac_plot = 1.0\n    upper = int(frac_plot * yt.shape[0])\n    fig, ax = plt.subplots()\n    ax.plot(yt[0:upper], 'b-')\n    ax.plot(ytp[0:upper], 'r-', alpha=0.5)\n    ax.plot(ytp[0:upper], 'ro', alpha=0.25)\n    ax.set(xlabel='Time', ylabel='Crude Oil Prices (Blue=Actual & Red=Prediction)',\n           title=f'Training: Time-Series Prediction ({model_name})')\n    plt.show()\n    \n    print(\"VALIDATION:\")\n    val_mse = np.mean((yv - yvp) ** 2)\n    val_mae = np.mean(np.abs(yv - yvp))\n    print(\"MSE\", val_mse)\n    print(\"MAE\", val_mae)\n    \n    # PARITY PLOT\n    fig, ax = plt.subplots()\n    ax.plot(yv, yvp, 'ro')\n    ax.plot(yv, yv, 'b-')\n    ax.set(xlabel='Actual Crude Oil Prices', ylabel='Predicted Crude Oil Prices',\n           title=f'Validation Data Parity Plot ({model_name})')\n    plt.show()\n    \n    # PLOT PART OF THE PREDICTED TIME-SERIES\n    upper = int(frac_plot * yv.shape[0])\n    fig, ax = plt.subplots()\n    ax.plot(yv[0:upper], 'b-')\n    ax.plot(yvp[0:upper], 'r-', alpha=0.5)\n    ax.plot(yvp[0:upper], 'ro', alpha=0.25)\n    ax.set(xlabel='Time', ylabel='Crude Oil Prices (Blue=Actual & Red=Prediction)',\n           title=f'Validation: Time-Series Prediction ({model_name})')\n    plt.show()\n    \n    return train_mse, train_mae, val_mse, val_mae\n\n# Regression report for the non-regularized model\ntrain_mse_no_reg, train_mae_no_reg, val_mse_no_reg, val_mae_no_reg = regression_report(trainY, Ytp_oil_no_reg, testY, Yvp_oil_no_reg, \"Non-Regularized Model\")\n\n# Regression report for the regularized model\ntrain_mse_reg, train_mae_reg, val_mse_reg, val_mae_reg = regression_report(trainY, Ytp_oil_reg, testY, Yvp_oil_reg, \"Regularized Model\")\n\n\n--------- Regression Report (Non-Regularized Model) ---------\nTRAINING:\nMSE 1.3641526161138178\nMAE 1.0740010830862619\nVALIDATION:\nMSE 0.3926946168942365\nMAE 0.47367857545491193\n--------- Regression Report (Regularized Model) ---------\nTRAINING:\nMSE 1.2809680164599633\nMAE 0.9898398005377544\nVALIDATION:\nMSE 0.5934448110565091\nMAE 0.601928361317063"
  },
  {
    "objectID": "deep-learning-ts.html#natural-gas-2",
    "href": "deep-learning-ts.html#natural-gas-2",
    "title": "Deep Learning for TS",
    "section": "Natural Gas",
    "text": "Natural Gas\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Electricity\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#gdp-2",
    "href": "deep-learning-ts.html#gdp-2",
    "title": "Deep Learning for TS",
    "section": "GDP",
    "text": "GDP\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## CPI\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil-3",
    "href": "deep-learning-ts.html#crude-oil-3",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil"
  },
  {
    "objectID": "deep-learning-ts.html#natural-gas-3",
    "href": "deep-learning-ts.html#natural-gas-3",
    "title": "Deep Learning for TS",
    "section": "Natural Gas",
    "text": "Natural Gas\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Electricity\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#gdp-3",
    "href": "deep-learning-ts.html#gdp-3",
    "title": "Deep Learning for TS",
    "section": "GDP",
    "text": "GDP\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## CPI\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil-4",
    "href": "deep-learning-ts.html#crude-oil-4",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Natural Gas\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#electricity-1",
    "href": "deep-learning-ts.html#electricity-1",
    "title": "Deep Learning for TS",
    "section": "Electricity",
    "text": "Electricity\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## GDP\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#cpi-1",
    "href": "deep-learning-ts.html#cpi-1",
    "title": "Deep Learning for TS",
    "section": "CPI",
    "text": "CPI\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n\n\n\n# 8. Discussion\n\nNow, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.\n\n\n::: panel-tabset\n\n## Crude Oil\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#natural-gas-4",
    "href": "deep-learning-ts.html#natural-gas-4",
    "title": "Deep Learning for TS",
    "section": "Natural Gas",
    "text": "Natural Gas\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Electricity\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#gdp-4",
    "href": "deep-learning-ts.html#gdp-4",
    "title": "Deep Learning for TS",
    "section": "GDP",
    "text": "GDP\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## CPI\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#how-do-the-results-from-the-3-different-ann-models-compare-with-each-other-in-terms-of-accuracy-and-predictive-power",
    "href": "deep-learning-ts.html#how-do-the-results-from-the-3-different-ann-models-compare-with-each-other-in-terms-of-accuracy-and-predictive-power",
    "title": "Deep Learning for TS",
    "section": "8.1 How do the results from the 3 different ANN models compare with each other in terms of accuracy and predictive power?",
    "text": "8.1 How do the results from the 3 different ANN models compare with each other in terms of accuracy and predictive power?\nNow, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.\n::: panel-tabset"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil-5",
    "href": "deep-learning-ts.html#crude-oil-5",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Natural Gas\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#electricity-2",
    "href": "deep-learning-ts.html#electricity-2",
    "title": "Deep Learning for TS",
    "section": "Electricity",
    "text": "Electricity\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## GDP\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#cpi-2",
    "href": "deep-learning-ts.html#cpi-2",
    "title": "Deep Learning for TS",
    "section": "CPI",
    "text": "CPI\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n\n\n## 8.2 What effect does including regularization have on your results?\n\nNow, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.\n\n\n::: panel-tabset\n\n## Crude Oil\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#natural-gas-5",
    "href": "deep-learning-ts.html#natural-gas-5",
    "title": "Deep Learning for TS",
    "section": "Natural Gas",
    "text": "Natural Gas\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Electricity\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#gdp-5",
    "href": "deep-learning-ts.html#gdp-5",
    "title": "Deep Learning for TS",
    "section": "GDP",
    "text": "GDP\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## CPI\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#how-far-into-the-future-can-the-deep-learning-model-accurately-predict-the-future",
    "href": "deep-learning-ts.html#how-far-into-the-future-can-the-deep-learning-model-accurately-predict-the-future",
    "title": "Deep Learning for TS",
    "section": "8.3 How far into the future can the deep learning model accurately predict the future?",
    "text": "8.3 How far into the future can the deep learning model accurately predict the future?\nNow, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.\n::: panel-tabset"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil-6",
    "href": "deep-learning-ts.html#crude-oil-6",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Natural Gas\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#electricity-3",
    "href": "deep-learning-ts.html#electricity-3",
    "title": "Deep Learning for TS",
    "section": "Electricity",
    "text": "Electricity\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## GDP\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#cpi-3",
    "href": "deep-learning-ts.html#cpi-3",
    "title": "Deep Learning for TS",
    "section": "CPI",
    "text": "CPI\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n\n\n\n\n## 8.4. How does your deep learning modeling compare to the traditional single-variable time-series ARMA/ARIMA models from HW-3?\n\nNow, we will move forward to fit an ARCH/GARCH model to the stock price data. The first step in this process is to prepare the time series by calculating the stock price returns, which are typically used in financial time series modeling because they are more likely to exhibit stationary properties—a key requirement for ARCH/GARCH models.\n\n\n::: panel-tabset\n\n## Crude Oil\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#natural-gas-6",
    "href": "deep-learning-ts.html#natural-gas-6",
    "title": "Deep Learning for TS",
    "section": "Natural Gas",
    "text": "Natural Gas\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Electricity\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#gdp-6",
    "href": "deep-learning-ts.html#gdp-6",
    "title": "Deep Learning for TS",
    "section": "GDP",
    "text": "GDP\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## CPI\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#crude-oil-7",
    "href": "deep-learning-ts.html#crude-oil-7",
    "title": "Deep Learning for TS",
    "section": "Crude Oil",
    "text": "Crude Oil\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n\n## Natural Gas\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#electricity-4",
    "href": "deep-learning-ts.html#electricity-4",
    "title": "Deep Learning for TS",
    "section": "Electricity",
    "text": "Electricity\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n\n\n\n\n\n## GDP\n\n\n\n\n```{r, warning=FALSE, message=FALSE, echo=TRUE}\n#| code-fold: true\n#| code-summary: 'Code'\n#| warning: false\n#| output: true"
  },
  {
    "objectID": "deep-learning-ts.html#cpi-4",
    "href": "deep-learning-ts.html#cpi-4",
    "title": "Deep Learning for TS",
    "section": "CPI",
    "text": "CPI\n```{r, warning=FALSE, message=FALSE, echo=TRUE} #| code-fold: true #| code-summary: ‘Code’ #| warning: false #| output: true\n```"
  },
  {
    "objectID": "univariate-ts-models.html",
    "href": "univariate-ts-models.html",
    "title": "Univariate TS Models (ARIMA/SARIMA)",
    "section": "",
    "text": "Autocorrelation Function (ACF) and Partial Autocorrelation Function (PACF) plots are crucial tools in time series analysis, helping to identify the type of model that best describes a series. The ACF plot shows the correlation of the series with its own lags, providing insights into the overall correlation structure and potential seasonality. On the other hand, the PACF plot reveals the direct effect of past values on the current value, helping to pinpoint the order of autoregressive models.\nBy examining the ACF and PACF plots, we can discern patterns that suggest the presence of autoregressive (AR) or moving average (MA) components in our time series models. Significant spikes in the ACF plot indicate potential AR terms, while significant spikes in the PACF plot suggest MA terms. These plots also assist in determining the stationarity of the series, a crucial aspect in time series modeling, where non-stationary data often require differencing to achieve stationarity.\nThis section delves into the ACF and PACF plots for our datasets, examining their autocorrelation structures to get insights that will guide our model selection and inform our forecasting methodology.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nACF-PACF Plot\n#ACF Plot for Crude Oil\ncrude_oil_acf &lt;- ggAcf(oil_log_ts) + \n  ggtitle(\"ACF Plot for Crude Oil (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#PACF Plot for Crude Oil\ncrude_oil_pacf &lt;- ggPacf(oil_log_ts) + \n  ggtitle(\"PACF Plot for Crude Oil (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Arrange the plots\ngrid.arrange(crude_oil_acf, crude_oil_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for crude oil prices demonstrates prolonged significant autocorrelation, suggesting a non-stationary series. The gradual decline in correlation as lags increase indicates a potential long-term dependency or trend in the data.\nThe PACF plot shows significant spike at lag 1 and 2, followed by non-significant values\nThe ACF and PACF plots suggest considering an ARIMA model with ‘p’ to be 1 and 2. The slow decay in the ACF implies that differencing (d &gt; 0) may be necessary to achieve stationarity.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for Natural Gas\nnatural_gas_acf &lt;- ggAcf(gas_log_ts) + \n  ggtitle(\"ACF Plot for Natural Gas Price (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\nnatural_gas_pacf &lt;- ggPacf(gas_log_ts) + \n  ggtitle(\"PACF Plot for Natural Gas Price (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(natural_gas_acf, natural_gas_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for natural gas prices shows a very slow decay, suggesting non-stationarity and a need for differencing.\nThe PACF plot shows a significant spike at lag 1, followed by a drop-off.\nThe ACF and PACF plots suggest considering an ARIMA model with ‘p’ to be 1, 2 and 3. The slow decay in the ACF implies that differencing (d &gt; 0) may be necessary to achieve stationarity.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for Electricity\nelectricity_acf &lt;- ggAcf(electricity_log_ts) + \n  ggtitle(\"ACF Plot for Average Price of Electricity to Ultimate Customers (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\nelectricity_pacf &lt;- ggPacf(electricity_log_ts) + \n  ggtitle(\"PACF Plot for Average Price of Electricity to Ultimate Customers (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(electricity_acf, electricity_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for electricity shows a strong positive autocorrelation across all the lags indicating a potential MA term and a need for differencing due to non-stationarity.\nThe PACF plot shows a significant correlations at lag 1. The choice of ‘p’ could be 1 or 2 based on the first significant spikes.\nThe consistent autocorrelation in the ACF plot suggests a potential need for a higher-order MA term or differencing, leading to an ARIMA(p,d,q) model consideration.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for GDP (Log)\ngdp_acf &lt;- ggAcf(gdp_log_ts) + \n  ggtitle(\"ACF Plot for GDP\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngdp_pacf &lt;- ggPacf(gdp_log_ts) + \n  ggtitle(\"PACF Plot for GDP\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\")) \n\ngrid.arrange(gdp_acf, gdp_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for GDP shows a persistent strong autocorrelation across all lags indicates non-stationarity, suggesting that differencing may be necessary.\nThe PACF plot have a sharp cutoff after lag 1 indicating an AR(1) process, suggesting that previous values have a significant impact on current GDP.\nGiven the strong autocorrelation and the PACF cutoff, an ARIMA(1,1,0) model may be a good starting point for modeling GDP, but differencing (d &gt; 0) may be necessary.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for CPI (Log)\ncpi_acf &lt;- ggAcf(cpi_log_ts) + \n  ggtitle(\"ACF Plot for CPI\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ncpi_pacf &lt;- ggPacf(cpi_log_ts) + \n  ggtitle(\"PACF Plot for CPI\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\")) \n\ngrid.arrange(cpi_acf, cpi_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for CPI shows a sustained high autocorrelation across lags suggests a non-stationary time series, indicative of CPI’s long memory.\nThe PACF plot have a sharp spike and a cutoff after lag 1 indicating an AR(1) process, suggesting that previous values have a significant impact on current GDP.\nThe sustained autocorrelation in the ACF plot implies that differencing might be needed. An initial ARIMA(1,1,0) model could be considered."
  },
  {
    "objectID": "univariate-ts-models.html#fitting-best-model",
    "href": "univariate-ts-models.html#fitting-best-model",
    "title": "Univariate TS Models (ARIMA/SARIMA)",
    "section": "Fitting Best Model",
    "text": "Fitting Best Model\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\nBest Model by AIC (and AICc) and BIC is : ARIMA(2,1,1)\nSecond Best would be (2,1,2)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_crudeoil &lt;- Arima(diff(oil_log_ts), order=c(2, 1, 1),include.drift = TRUE) \nsummary(fit_crudeoil)\n\n\nSeries: diff(oil_log_ts) \nARIMA(2,1,1) with drift \n\nCoefficients:\n         ar1      ar2      ma1  drift\n      0.5693  -0.2302  -1.0000  0e+00\ns.e.  0.0482   0.0483   0.0068  1e-04\n\nsigma^2 = 0.006104:  log likelihood = 458.21\nAIC=-906.41   AICc=-906.26   BIC=-886.38\n\nTraining set error measures:\n                     ME       RMSE        MAE MPE MAPE      MASE        ACF1\nTraining set 0.00107102 0.07764852 0.05776995 Inf  Inf 0.6584447 -0.01489388\n\n\nCoefficients: The model includes two autoregressive terms (ar1, ar2) and one moving average terms, with all coefficients having significant values (based on their small standard errors (s.e.)) Drift: The drift coefficient is effectively zero, suggesting no consistent linear trend in the differenced series.\nFor the Best Model (ARIMA(2,1,1)): Given the coefficients:\n\nAR1: 0.5693\nAR2: -0.2302\nMA1: -1\n\nThe equation for the ARIMA(2,1,1) model, ignoring the drift since it’s 0, would be:\n\\[\ny_t = 0.5693y_{t-1} - 0.2302y_{t-2} + w_t - 1.0w_{t-1}\n\\]\n\n\n\nBest Model by AIC (and AICc): ARIMA(3,1,1)\nSecond Best Model by BIC: ARIMA(1,1,1)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_NaturalGas &lt;- Arima(diff(gas_log_ts), order=c(3, 1, 1),include.drift = TRUE) \nsummary(fit_NaturalGas)\n\n\nSeries: diff(gas_log_ts) \nARIMA(3,1,1) with drift \n\nCoefficients:\n          ar1      ar2      ar3      ma1  drift\n      -0.2356  -0.1575  -0.0109  -1.0000  0e+00\ns.e.   0.0497   0.0506   0.0498   0.0067  1e-04\n\nsigma^2 = 0.01409:  log likelihood = 287.59\nAIC=-563.17   AICc=-562.96   BIC=-539.15\n\nTraining set error measures:\n                      ME      RMSE        MAE MPE MAPE      MASE         ACF1\nTraining set 0.002116183 0.1178166 0.07252866 NaN  Inf 0.7166933 -0.003575256\n\n\nCoefficients: The model includes three autoregressive terms (ar1, ar2, ar3) and one moving average terms (ma1), with all coefficients having significant values. Drift: The drift coefficient is effectively zero, suggesting no consistent linear trend in the differenced series.\nFor the Best Model (ARIMA(3,1,1)):\nGiven the coefficients:\n\nAR1: -0.2356\nAR2: -0.1575\nAR3: -0.0109\nMA1: -1.0000\n\nThe equation for the ARIMA(3,1,1) model, ignoring the drift since it’s 0, would be:\n\\[\ny_t = -0.2356y_{t-1} - 0.1575y_{t-2} - 0.0109y_{t-3} + w_t - 1.0w_{t-1}\n\\]\n\n\n\nBest Model by AIC, BIC, and AICc (ARIMA(2,1,3))\nSecond best model: ARIMA(3,1,6)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_electricity &lt;- Arima(diff(electricity_log_ts), order=c(2, 1, 3),include.drift = TRUE) \nsummary(fit_electricity)\n\n\nSeries: diff(electricity_log_ts) \nARIMA(2,1,3) with drift \n\nCoefficients:\n         ar1      ar2      ma1     ma2      ma3  drift\n      0.9728  -0.9217  -1.6812  1.6054  -0.9242  0e+00\ns.e.  0.0219   0.0217   0.0243  0.0394   0.0237  1e-04\n\nsigma^2 = 0.0003533:  log likelihood = 1033.41\nAIC=-2052.82   AICc=-2052.54   BIC=-2024.79\n\nTraining set error measures:\n                        ME       RMSE        MAE MPE MAPE     MASE     ACF1\nTraining set -0.0003363715 0.01863433 0.01469179 NaN  Inf 1.557641 0.223077\n\n\nCoefficients: The model includes four autoregressive terms (ar1, ar2) and three moving average terms with all coefficients having significant values. Drift: The drift coefficient is extremely small, suggesting a negligible linear trend in the differenced series.\nFor the Best Model (ARIMA(2,1,3)):\nGiven the coefficients:\n\nAR1: 0.9728\nAR2: -0.9217\nMA1: -1.6812\nMA2: 1.6054\nMA3: -0.9242\n\nThe equation for the ARIMA(2,1,3) model:\n\\[\n\\begin{aligned}\ny_t = &\\ 0.9728 y_{t-1} - 0.9217 y_{t-2} \\\\\n      &\\ + w_t - 1.6812 w_{t-1} + 1.6054 w_{t-2} - 0.9242 w_{t-3}\n\\end{aligned}\n\\]\n\n\n\nBest Model by AIC, BIC and AICc: ARIMA(1,1,1)\nSecond Best Model: ARIMA(3,1,2)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_gdp_a &lt;- Arima(diff(gdp_log_ts), order=c(1, 1, 1),include.drift = TRUE) \nsummary(fit_gdp_a)\n\n\nSeries: diff(gdp_log_ts) \nARIMA(1,1,1) with drift \n\nCoefficients:\n          ar1     ma1  drift\n      -0.0656  -1.000  0e+00\ns.e.   0.0861   0.043  1e-04\n\nsigma^2 = 0.0001611:  log likelihood = 394\nAIC=-780   AICc=-779.69   BIC=-768.41\n\nTraining set error measures:\n                        ME       RMSE         MAE      MPE     MAPE      MASE\nTraining set -9.347927e-05 0.01250364 0.006148489 99.02771 198.7889 0.6965582\n                    ACF1\nTraining set -0.00113362\n\n\nCoefficients: The model includes one autoregressive terms (ar1) and one moving average terms (ma1), with all coefficients having significant values. Drift: The drift coefficient is extremely small, suggesting a negligible linear trend in the differenced series.\nFor the Best Model (ARIMA(1,1,1)):\nGiven the coefficients:\n\nAR1: -0.0656\nMA1: -1.000\n\nThe equation for the ARIMA(1,1,1) model:\n\\[\ny_t = -0.0656y_{t-1} + w_t - 1.00w_{t-1}\n\\]\n\n\n\nBest Model by AIC and AICc: ARIMA(3,1,2)\nSecond Best Model: ARIMA(3,1,3)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_cpi_a &lt;- Arima(diff(cpi_log_ts), order=c(3, 1, 2),include.drift = TRUE) \nsummary(fit_cpi_a)\n\n\nSeries: diff(cpi_log_ts) \nARIMA(3,1,2) with drift \n\nCoefficients:\n         ar1      ar2     ar3      ma1     ma2  drift\n      0.8004  -0.3574  0.1405  -1.2473  0.2672  0e+00\ns.e.  0.4783   0.2412  0.0887   0.4825  0.4641  1e-04\n\nsigma^2 = 5.709e-06:  log likelihood = 1885.99\nAIC=-3757.99   AICc=-3757.71   BIC=-3729.91\n\nTraining set error measures:\n                        ME       RMSE        MAE MPE MAPE      MASE\nTraining set -3.256118e-05 0.00236889 0.00164296 NaN  Inf 0.5958379\n                     ACF1\nTraining set -0.001736317\n\n\nCoefficients: The model includes three autoregressive terms (ar1, ar2, ar3) and two moving average terms (ma1, ma2), with all coefficients having significant values. Drift: The drift coefficient is extremely small, suggesting a negligible linear trend in the differenced series.\nFor the Best Model (ARIMA(3,1,2)):\nGiven the coefficients:\n\nAR1: 0.8004\nAR2: -0.3574\nAR3: 0.1405\nMA1: -1.2473\nMA2: 0.2672\n\nThe equation for the ARIMA(3,1,2) model:\n\\[\ny_t = 0.8004y_{t-1} - 0.3574y_{t-2} + 0.1405y_{t-3} + w_t - 1.2473w_{t-1} + 0.2672w_{t-2}\n\\]"
  },
  {
    "objectID": "univariate-ts-models.html#fitting-second-best-model",
    "href": "univariate-ts-models.html#fitting-second-best-model",
    "title": "Univariate TS Models (ARIMA/SARIMA)",
    "section": "Fitting Second Best Model",
    "text": "Fitting Second Best Model\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\nBest Model by AIC (and AICc) and BIC is : ARIMA(2,1,1)\nSecond Best would be (2,1,2)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_crudeoil2 &lt;- Arima(diff(oil_log_ts), order=c(2, 1, 2),include.drift = TRUE) \nsummary(fit_crudeoil2)\n\n\nSeries: diff(oil_log_ts) \nARIMA(2,1,2) with drift \n\nCoefficients:\n         ar1      ar2      ma1     ma2  drift\n      0.9519  -0.4028  -1.4107  0.4107  0e+00\ns.e.  0.1950   0.0843   0.2130  0.2129  1e-04\n\nsigma^2 = 0.006073:  log likelihood = 459.6\nAIC=-907.19   AICc=-906.98   BIC=-883.15\n\nTraining set error measures:\n                      ME       RMSE        MAE MPE MAPE      MASE        ACF1\nTraining set 0.001044984 0.07735308 0.05741248 Inf  Inf 0.6543703 0.006458057\n\n\nCoefficients: This model is simpler, with two AR and two MA parameters Drift: Similar to the best model, the drift is zero.\nFor the Best Model (ARIMA(2,1,2)): Given the coefficients:\n\nAR1: 0.9519\nAR2: -0.4028\nMA1: -1.4107\nMA2: 0.4107\n\nThe equation for the ARIMA(2,1,2) model, ignoring the drift since it’s 0, would be:\n\\[\ny_t = 0.9519y_{t-1} - 0.4028y_{t-2} + w_t - 1.4107w_{t-1} + 0.4107w_{t-2}\n\\]\n\nBetter Model:\n\nARIMA(2,1,2) has a lower AIC (-907.19) compared to ARIMA(2,1,1) (-906.41)\nARIMA(2,1,2) also shows a lower AICc (-906.98) than ARIMA(2,1,1) (-906.26)\nARIMA(2,1,1) actually has a lower BIC compared to ARIMA(2,1,2)\nARIMA(2,1,2) exhibits a higher log likelihood (459.6) compared to ARIMA(2,1,1) (458.21), indicating a slightly better fit\nARIMA(2,1,2), both RMSE and MAE are slighlty lower than for ARIMA(2,1,1), indicating better predictive performance\nARIMA(2,1,2) model includes an additional moving average term which seems to capture more complexity in the data dynamics\n\nGiven these considerations, the ARIMA(2,1,2) model is better for the series\n\n\n\n\nBest Model by AIC (and AICc): ARIMA(3,1,1)\nSecond Best Model by BIC: ARIMA(1,1,1)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_NaturalGas2 &lt;- Arima(diff(gas_log_ts), order=c(1, 1, 1),include.drift = TRUE) \nsummary(fit_NaturalGas2)\n\n\nSeries: diff(gas_log_ts) \nARIMA(1,1,1) with drift \n\nCoefficients:\n          ar1      ma1  drift\n      -0.2018  -1.0000  0e+00\ns.e.   0.0486   0.0066  1e-04\n\nsigma^2 = 0.01438:  log likelihood = 282.67\nAIC=-557.33   AICc=-557.23   BIC=-541.32\n\nTraining set error measures:\n                      ME    RMSE        MAE MPE MAPE     MASE        ACF1\nTraining set 0.001948717 0.11931 0.07321374 NaN  Inf 0.723463 -0.03408864\n\n\nCoefficients: The model includes one autoregressive terms (ar1) and one moving average terms (ma1), with all coefficients having significant values. Drift: The drift coefficient is extremely small, suggesting a negligible linear trend in the differenced series.\nFor the Best Model (ARIMA(1,1,1)):\nGiven the coefficients:\n\nAR1: -0.2018\nMA1: -1.0\n\nThe equation for the ARIMA(1,1,1) model:\n\\[\nx_t = - 0.2018x_{t-1} + w_t - 1.0w_{t-1}\n\\]\n\nBetter Model:\n\nARIMA(3,1,1) has a lower AIC (-563.17) compared to ARIMA(1,1,1) (-557.33)\nARIMA(3,1,1) also shows a lower AICc (-562.96) than ARIMA(1,1,1) (-557.23)\nARIMA(1,1,1) actually has a lower BIC compared to ARIMA(3,1,1)\nARIMA(3,1,1) exhibits a higher log likelihood (287.59) compared to ARIMA(1,1,1) (282.67), indicating a slightly better fit\nFor ARIMA(3,1,1), both RMSE and MAE are slightly lower than for ARIMA(1,1,1), indicating better predictive performance\nARIMA(3,1,1) model includes additional autoregressive terms which seem to capture more complexity in the data dynamics\n\nGiven these considerations, the ARIMA(3,1,1) model is deemed better for the series.\n\n\n\n\nBest Model by AIC, BIC, and AICc (ARIMA(2,1,3))\nSecond best model: ARIMA(3,1,6)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_electricity2 &lt;- Arima(diff(electricity_log_ts), order=c(3, 1, 6),include.drift = TRUE) \nsummary(fit_electricity2)\n\n\nSeries: diff(electricity_log_ts) \nARIMA(3,1,6) with drift \n\nCoefficients:\n         ar1     ar2      ar3      ma1      ma2     ma3      ma4      ma5\n      0.0090  0.3478  -0.5904  -0.5779  -0.7449  0.5961  -0.6126  -0.0975\ns.e.  0.0586  0.0690   0.0753   0.0702   0.0943  0.1106   0.1304   0.0782\n         ma6  drift\n      0.4660  0e+00\ns.e.  0.0727  1e-04\n\nsigma^2 = 0.0003435:  log likelihood = 1042.41\nAIC=-2062.81   AICc=-2062.14   BIC=-2018.77\n\nTraining set error measures:\n                       ME       RMSE        MAE  MPE MAPE    MASE       ACF1\nTraining set -0.000237626 0.01828051 0.01416802 -Inf  Inf 1.50211 0.05261022\n\n\nCoefficients: The model includes three autoregressive terms and six moving average terms (ma1, ma2…, ma6), with all coefficients having significant values. Drift: The drift coefficient is extremely small, suggesting a negligible linear trend in the differenced series.\nFor the Best Model (ARIMA(3,1,6)):\nGiven the coefficients:\n\nAR1: 0.0090\nAR2: 0.3478\nAR3: -0.5904\nMA1: -0.5779\nMA2: -0.7449\nMA3: 0.5961\nMA4: -0.6126\nMA5: -0.0975\nMA6: 0.4660\n\nThe equation for the ARIMA(3,1,6) model:\n\\[\n\\begin{aligned}\nx_t = &\\ 0.0090 x_{t-1} + 0.3478 x_{t-2} - 0.5904 x_{t-3} + w_t \\\\\n      &\\ - 0.5779 w_{t-1} - 0.7449 w_{t-2} + 0.5961 w_{t-3} \\\\\n      &\\ - 0.6126 w_{t-4} - 0.0975 w_{t-5} + 0.4660 w_{t-6}\n\\end{aligned}\n\\]\n\nBetter Model:\n\nARIMA(3,1,6) has a lower AIC (-2062.81) compared to ARIMA(2,1,3) (-2052.82 )\nARIMA(3,1,6) also shows a lower AICc (-2062.14) than ARIMA(2,1,3) (-2052.54)\nARIMA(2,1,3) has a lower BIC (-2024.79) compared to ARIMA(3,1,6) (-2018.77)\nARIMA(3,1,6) exhibits a higher log likelihood (1042.41) compared to ARIMA(2,1,3) (1033.41), indicating a slightly better fit\nFor ARIMA(3,1,6), both RMSE and MAE are slightly lower than for ARIMA(2,1,3), indicating better predictive performance\nARIMA(3,1,6) includes additional autoregressive terms which seem to capture more complexity in the data dynamics\n\nConsidering everything, even though the ARIMA(3,1,6) model seems to have a slight edge as shown by its lower AIC and slightly more accurate predictions, I would opt for ARIMA(2,1,3) model. ARIMA(2,1,3) model is less complex, which can make it more reliable when we use it to predict future prices.\n\n\n\n\nBest Model by AIC, BIC and AICc: ARIMA(1,1,1)\nSecond Best Model: ARIMA(3,1,2)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_gdp_a2 &lt;- Arima(diff(gdp_log_ts), order=c(3, 1, 2),include.drift = TRUE) \nsummary(fit_gdp_a2)\n\n\nSeries: diff(gdp_log_ts) \nARIMA(3,1,2) with drift \n\nCoefficients:\n         ar1     ar2     ar3      ma1     ma2  drift\n      0.3440  0.1100  0.0416  -1.4101  0.4101  0e+00\ns.e.  0.6821  0.0982  0.1168   0.6785  0.6781  1e-04\n\nsigma^2 = 0.0001632:  log likelihood = 394.87\nAIC=-775.75   AICc=-774.86   BIC=-755.46\n\nTraining set error measures:\n                        ME       RMSE        MAE      MPE     MAPE      MASE\nTraining set -7.117017e-05 0.01244064 0.00596961 91.52836 187.4527 0.6762931\n                     ACF1\nTraining set -0.005991789\n\n\nCoefficients: The model includes three autoregressive terms (ar1, ar2, ar3) and two moving average terms (ma1, ma2), with all coefficients having significant values. Drift: The drift coefficient is extremely small, suggesting a negligible linear trend in the differenced series.\nFor the Best Model (ARIMA(3,1,2)):\nGiven the coefficients:\n\nAR1: 0.3440\nAR2: 0.1100\nAR3: 0.0416\nMA1: -1.4101\nMA2: 0.4101\n\nThe equation for the ARIMA(3,1,2) model:\n\\[\nx_t = 0.3440x_{t-1} + 0.1100x_{t-2} + 0.0416x_{t-3} + w_t - 1.4101w_{t-1} + 0.4101w_{t-2}\n\\]\n\nBetter Model:\n\nARIMA(1,1,1) has a lower AIC (-780) compared to ARIMA(3,1,2) (-775.75)\nARIMA(1,1,1) also shows a lower AICc (-779.69) than ARIMA(3,1,2) (-774.86)\nARIMA(1,1,1) has a lower BIC (-768.41) compared to ARIMA(3,1,2) (-755.46)\nARIMA(3,1,2) exhibits a higher log likelihood (394.87) compared to ARIMA(1,1,1) (394), indicating a slightly better fit\nBoth RMSE and MAE are slightly lower for ARIMA(3,1,2), but the differences are minimal, suggesting comparable predictive performance\nARIMA(3,1,2) includes additional autoregressive terms which seem to capture more complexity in the data dynamics\n\nDespite the ARIMA(3,1,2) having a slightly higher log likelihood and potentially capturing more complexity, the ARIMA(1,1,1) model is better for the series based on lower AIC, AICc, and BIC\n\n\n\n\nBest Model by AIC and AICc: ARIMA(3,1,2)\nSecond Best Model: ARIMA(3,1,3)\n\n\n\nFitting ARIMA\n#Fitting ARIMA\nfit_cpi_a2 &lt;- Arima(diff(cpi_log_ts), order=c(3, 1, 3),include.drift = TRUE) \nsummary(fit_cpi_a2)\n\n\nSeries: diff(cpi_log_ts) \nARIMA(3,1,3) with drift \n\nCoefficients:\n         ar1      ar2     ar3      ma1     ma2      ma3  drift\n      0.0195  -0.6767  0.3641  -0.4767  0.2965  -0.7575  0e+00\ns.e.  0.1166   0.1032  0.0887   0.1177  0.1729   0.1013  1e-04\n\nsigma^2 = 5.614e-06:  log likelihood = 1889.85\nAIC=-3763.69   AICc=-3763.33   BIC=-3731.6\n\nTraining set error measures:\n                        ME        RMSE         MAE MPE MAPE      MASE\nTraining set -3.229855e-05 0.002346106 0.001625435 NaN  Inf 0.5894823\n                   ACF1\nTraining set 0.01748658\n\n\nCoefficients: The model includes three autoregressive terms (ar1, ar2, ar3) and three moving average terms (ma1, ma2, ma3), with all coefficients having significant values. Drift: The drift coefficient is extremely small, suggesting a negligible linear trend in the differenced series.\nFor the Best Model (ARIMA(3,1,3)):\nGiven the coefficients:\n\nAR1: 0.0195\nAR2: -0.6767\nAR3: 0.3641\nMA1: -0.4767\nMA2: 0.2965\nMA3: -0.7575\n\nThe equation for the ARIMA(3,1,3) model:\n\\[\n\\begin{aligned}\nx_t = &\\ 0.0195 x_{t-1} - 0.6767 x_{t-2} + 0.3641 x_{t-3} \\\\\n      &\\ + w_t - 0.4767 w_{t-1} + 0.2965 w_{t-2} - 0.7575 w_{t-3}\n\\end{aligned}\n\\]\n\nBetter Model:\n\nARIMA(3,1,3) has a lower AIC (-3763.69) compared to ARIMA(3,1,2) (-3757.99)\nARIMA(3,1,3) also shows a lower AICc (-3763.33) than ARIMA(3,1,2) (-3757.71)\nARIMA(3,1,3) has a lower BIC (-3731.6) compared to ARIMA(3,1,2) (-3729.91)\nARIMA(3,1,3) exhibits a higher log likelihood (1889.85) compared to ARIMA(3,1,2) (1885.99), indicating a slightly better fit\nFor ARIMA(3,1,3), both RMSE and MAE are slightly lower than for ARIMA(3,1,2), indicating better predictive performance\nARIMA(3,1,3) includes an additional moving average term which seems to capture more complexity in the data dynamics, providing a slight advantage in modeling more complex patterns\n\nGiven these considerations, the ARIMA(3,1,3) model is better for the series"
  },
  {
    "objectID": "data-sources.html",
    "href": "data-sources.html",
    "title": "Data Sources",
    "section": "",
    "text": "To investigate the economic impact of the energy sector, this project utilizes a series of datasets focusing on crude oil and natural gas prices, electricity costs, and key economic indicators. These datasets serve as the foundation for our analysis, enabling us to explore the intricate dynamics between energy market fluctuations and economic performance."
  },
  {
    "objectID": "data-sources.html#stock-price-analysis-for-major-oil-companies",
    "href": "data-sources.html#stock-price-analysis-for-major-oil-companies",
    "title": "Data Sources",
    "section": "Stock Price Analysis for Major Oil Companies",
    "text": "Stock Price Analysis for Major Oil Companies"
  },
  {
    "objectID": "multivariate-ts-models.html",
    "href": "multivariate-ts-models.html",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "",
    "text": "In our quest to uncover the relationships within the energy sector and its economic consequences, we will use a series of statistical models that serve as the foundation for our analysis. This will help us understand both direct impacts and more complex, interdependent relationships within the datasets.\n\n\n\n(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n(SARIMAX) GDP ~ Crude Oil Prices + Natural Gas Prices\n(SARIMAX) CPI ~ Crude Oil Prices + Natural Gas Prices\n\n\n\n\n\n(VAR) Crude Oil Prices ~ CPI\n(VAR) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices"
  },
  {
    "objectID": "multivariate-ts-models.html#sarimax-models",
    "href": "multivariate-ts-models.html#sarimax-models",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "",
    "text": "(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n(SARIMAX) GDP ~ Crude Oil Prices + Natural Gas Prices\n(SARIMAX) CPI ~ Crude Oil Prices + Natural Gas Prices"
  },
  {
    "objectID": "multivariate-ts-models.html#var-models",
    "href": "multivariate-ts-models.html#var-models",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "",
    "text": "(VAR) Crude Oil Prices ~ CPI\n(VAR) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices"
  },
  {
    "objectID": "multivariate-ts-models.html#variable-selection",
    "href": "multivariate-ts-models.html#variable-selection",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "1. Variable Selection",
    "text": "1. Variable Selection\n\n(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices(SARIMAX) GDP ~ Crude Oil Prices + Natural Gas Prices(SARIMAX) CPI ~ Crude Oil Prices + Natural Gas Prices\n\n\n\n\nVariable Selection\n#Combining\nelec_oil_ng &lt;- cbind(electricity_prices_window, crude_oil_window, natural_gas_window)\ncolnames(elec_oil_ng) &lt;- c(\"Electricity\", \"CrudeOil\", \"NaturalGas\")\n\n#Plotting the data\nautoplot(elec_oil_ng) + \n  theme_bw() +\n  labs(title = \"Electricity, Crude Oil, and Natural Gas Prices Over Time\",\n       x = \"Year\",\n       y = \"Logged Prices\",\n       color = \"Series\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\nVariable Selection\n#Combining\ngdp_oil_ng &lt;- cbind(electricity_prices_window, crude_oil_window, natural_gas_window)\ncolnames(gdp_oil_ng) &lt;- c(\"GDP\", \"CrudeOil\", \"NaturalGas\")\n\n#Plotting the data\nautoplot(gdp_oil_ng) + \n  theme_bw() +\n  labs(title = \"GDP, Crude Oil, and Natural Gas Prices Over Time\",\n       x = \"Year\",\n       y = \"Logged Prices\",\n       color = \"Series\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\nVariable Selection\n#Combining\ncpi_oil_ng &lt;- cbind(cpi_window, crude_oil_window, natural_gas_window)\ncolnames(cpi_oil_ng) &lt;- c(\"CPI\", \"CrudeOil\", \"NaturalGas\")\n\n#Plotting the data\nautoplot(cpi_oil_ng) + \n  theme_bw() +\n  labs(title = \"CPI, Crude Oil, and Natural Gas Prices Over Time\",\n       x = \"Year\",\n       y = \"Logged Prices\",\n       color = \"Series\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))"
  },
  {
    "objectID": "multivariate-ts-models.html#fit-auto.arima",
    "href": "multivariate-ts-models.html#fit-auto.arima",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "2. Fit Auto.Arima",
    "text": "2. Fit Auto.Arima\nIn this section, I will first use the auto.arima() method\n\n(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n\n\n\n\nFit Auto Arima\n#Exogenous regressors\nxreg &lt;- cbind(CrudeOil = elec_oil_ng[,\"CrudeOil\"], NaturalGas = elec_oil_ng[,\"NaturalGas\"])\n\n#Fit the ARIMAX model\nfit_arimax_ecn &lt;- auto.arima(elec_oil_ng[,\"Electricity\"], xreg=xreg)\n\n#Summary\nsummary(fit_arimax_ecn)\n\n\nSeries: elec_oil_ng[, \"Electricity\"] \nRegression with ARIMA(2,1,1)(0,0,2)[12] errors \n\nCoefficients:\n         ar1      ar2      ma1    sma1    sma2   drift  CrudeOil  NaturalGas\n      1.1911  -0.4047  -0.9137  0.6205  0.4961  0.0017   -0.0030      0.0284\ns.e.  0.0527   0.0507   0.0352  0.0490  0.0460  0.0006    0.0065      0.0042\n\nsigma^2 = 0.0001811:  log likelihood = 1163.8\nAIC=-2309.6   AICc=-2309.14   BIC=-2273.61\n\nTraining set error measures:\n                       ME       RMSE        MAE          MPE      MAPE\nTraining set 6.123389e-05 0.01330739 0.01039629 -0.003068522 0.4873498\n                  MASE       ACF1\nTraining set 0.3743496 -0.0183484\n\n\nThis gives me a Regression with SARIMA(2,1,1)(0,0,2)[12] errors. The model diagnostics are below.\n\n\nCheck Residuals\n#Check residuals\ncheckresiduals(fit_arimax_ecn)\n\n\n\n\n\n\n\n\n\n\n    Ljung-Box test\n\ndata:  Residuals from Regression with ARIMA(2,1,1)(0,0,2)[12] errors\nQ* = 129.69, df = 19, p-value &lt; 2.2e-16\n\nModel df: 5.   Total lags used: 24\n\n\nResiduals Check:\n\nThe residuals plot shows fluctuations around zero, which is good because it suggests no obvious patterns are left unexplained by the model.\nIn the ACF plot of residuals we see some spikes suggesting that there is still some autocorrelation present in the residuals.\nThe histogram and Q-Q plot suggest that the residuals are approximately normally distributed.\nLjung-Box Test: The very low p-value suggests there is still autocorrelation in the residuals\n\n\n\nResiduals Fit - SARIMA\nmodel_output_r1 &lt;- capture.output(sarima(residuals(fit_arimax_ecn), 0,1,2,0,1,1,12))\n\n\n\n\n\n\n\n\n\nResiduals Fit - SARIMA\n#model_output_r1\ncat(model_output_r1[26:38], model_output_r1[length(model_output_r1)], sep = \"\\n\") \n\n\nconverged\n&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;\n \nCoefficients: \n     Estimate     SE  t.value p.value\nma1   -1.2841 0.0459 -27.9651       0\nma2    0.4989 0.0493  10.1125       0\nsma1  -0.9483 0.0334 -28.3850       0\n\nsigma^2 estimated as 0.0001174382 on 388 degrees of freedom \n \nAIC = -6.116799  AICc = -6.11664  BIC = -6.076198 \n \n \n\n\nResiduals Fit:: The model used for the residuals is SARIMA(0,1,2)x(0,1,1)[12], which suggests that the residuals have seasonal patterns\n\nThe coefficients for the moving average terms ma1 and ma2 are significantly different from zero (p-value = 0.0).\nThe seasonal moving average term sma1 has a coefficient of -0.9483, indicating strong seasonal effects within the residuals.\nThe standardized residuals do not show any apparent trends or seasonality.\nThe ACF plot of the residuals shows a very little correlations at lags. This is an indicator of a good model fit.\nThe Normal Q-Q Plot of Std Residuals displays points that mostly align suggesting that the residuals are normally distributed.\nThe p-values for the Ljung-Box statistic are all below the significance threshold of 0.05, implying that there’s still significant autocorrelation and a lack of fit.\n\nI think there might still be some patterns or trends hiding in the residuals."
  },
  {
    "objectID": "multivariate-ts-models.html#manual-fit",
    "href": "multivariate-ts-models.html#manual-fit",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "3. Manual Fit",
    "text": "3. Manual Fit\nIn this section, we will manually fit\n\n(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n\n\n\n\nManual Fit\nfit_m_ecn &lt;- lm(Electricity ~ CrudeOil + NaturalGas, data=elec_oil_ng)\nsummary(fit_m_ecn)\n\n\n\nCall:\nlm(formula = Electricity ~ CrudeOil + NaturalGas, data = elec_oil_ng)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.24898 -0.06976 -0.01451  0.05749  0.36012 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  1.20434    0.02967   40.59  &lt; 2e-16 ***\nCrudeOil     0.30032    0.01092   27.50  &lt; 2e-16 ***\nNaturalGas  -0.10557    0.01996   -5.29 2.01e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1072 on 401 degrees of freedom\nMultiple R-squared:  0.735, Adjusted R-squared:  0.7337 \nF-statistic: 556.2 on 2 and 401 DF,  p-value: &lt; 2.2e-16\n\n\nThe coefficients for both Crude Oil and Natural Gas are statistically significant (esp coefficient for CrudeOil which is 0.30032).\n\nACF/PACF plot of the residuals.\n\n\nACF-PACF\nresiduals_m_ecn &lt;- ts(residuals(fit_m_ecn), start=start(elec_oil_ng)[1], frequency=12)\n\n#ACF plot\nacf_plot &lt;- ggAcf(residuals_m_ecn) +\n  ggtitle(\"ACF Plot for Residulas\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n  \n\n#PACF plot\npacf_plot &lt;- ggPacf(residuals_m_ecn) +\n  ggtitle(\"PACF Plot for Residulas\") +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Arrange\ngrid.arrange(acf_plot, pacf_plot, nrow=2)\n\n\n\n\n\n\n\n\n\nThe ACF plot shows significant autocorrelation, suggesting seasonality in the residuals.\n\n\nDifferencing - ACF/PACF plot\n\n\nACF-PACF\n#ACF plot\nacf_plot2 &lt;- ggAcf(diff(residuals_m_ecn)) +\n  ggtitle(\"Diff ACF Plot for Residulas\") + \n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n  \n\n#PACF plot\npacf_plot2 &lt;- ggPacf(diff(residuals_m_ecn)) +\n  ggtitle(\"Diff PACF Plot for Residulas\") +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Arrange\ngrid.arrange(acf_plot2, pacf_plot2, nrow=2)\n\n\n\n\n\n\n\n\n\nDifferencing has addressed some of the seasonality. Now we have the following values:\np = 1 to 5\nq= 1 to 4\n\n\nManual Parameter\n\n\nManual Function\nSARIMA.c=function(p1,p2,q1,q2,P1,P2,Q1,Q2,d1,d2,data){\n  \n  temp=c()\n  d=1\n  D=1\n  s=12\n  \n  i=1\n  temp= data.frame()\n  ls=matrix(rep(NA,9*95),nrow=95)\n  \n  \n  for (p in p1:p2)\n  {\n    for(q in q1:q2)\n    {\n      for(P in P1:P2)\n      {\n        for(Q in Q1:Q2)\n        {\n          for(d in d1:d2)\n       \n        {\n          if(p+d+q+P+D+Q&lt;=10)\n          {\n            \n            model&lt;- Arima(data,order=c(p-1,d,q-1),seasonal=c(P-1,D,Q-1))\n            ls[i,]= c(p-1,d,q-1,P-1,D,Q-1,model$aic,model$bic,model$aicc)\n            i=i+1\n\n          }\n          \n        }\n      }\n    }\n    \n  }\n  \n  }\n  temp= as.data.frame(ls)\n  names(temp)= c(\"p\",\"d\",\"q\",\"P\",\"D\",\"Q\",\"AIC\",\"BIC\",\"AICc\")\n  \n  temp\n  \n}\n\n\noutput=SARIMA.c(p1=1,p2=5,q1=1,q2=4,P1=1,P2=2,Q1=1,Q2=2,d1=0,d2=1,data=residuals_m_ecn)\n\nknitr::kable(output)\n\n\n\n\n\np\nd\nq\nP\nD\nQ\nAIC\nBIC\nAICc\n\n\n\n\n0\n0\n0\n0\n1\n0\n-688.8457\n-684.8744\n-688.8354\n\n\n0\n1\n0\n0\n1\n0\n-1313.6087\n-1309.6400\n-1313.5985\n\n\n0\n0\n0\n0\n1\n1\n-762.7417\n-754.7992\n-762.7108\n\n\n0\n1\n0\n0\n1\n1\n-1549.7110\n-1541.7735\n-1549.6800\n\n\n0\n0\n0\n1\n1\n0\n-729.0349\n-721.0924\n-729.0041\n\n\n0\n1\n0\n1\n1\n0\n-1420.5506\n-1412.6132\n-1420.5197\n\n\n0\n0\n0\n1\n1\n1\n-768.4876\n-756.5738\n-768.4258\n\n\n0\n1\n0\n1\n1\n1\n-1548.8098\n-1536.9037\n-1548.7478\n\n\n0\n0\n1\n0\n1\n0\n-1058.2037\n-1050.2612\n-1058.1729\n\n\n0\n1\n1\n0\n1\n0\n-1334.8055\n-1326.8681\n-1334.7746\n\n\n0\n0\n1\n0\n1\n1\n-1143.0624\n-1131.1486\n-1143.0005\n\n\n0\n1\n1\n0\n1\n1\n-1563.5658\n-1551.6597\n-1563.5038\n\n\n0\n0\n1\n1\n1\n0\n-1104.7002\n-1092.7864\n-1104.6383\n\n\n0\n1\n1\n1\n1\n0\n-1439.1333\n-1427.2271\n-1439.0712\n\n\n0\n0\n1\n1\n1\n1\n-1148.1366\n-1132.2516\n-1148.0333\n\n\n0\n1\n1\n1\n1\n1\n-1562.0815\n-1546.2067\n-1561.9779\n\n\n0\n0\n2\n0\n1\n0\n-1213.1655\n-1201.2517\n-1213.1036\n\n\n0\n1\n2\n0\n1\n0\n-1332.8062\n-1320.9001\n-1332.7442\n\n\n0\n0\n2\n0\n1\n1\n-1339.0696\n-1323.1845\n-1338.9662\n\n\n0\n1\n2\n0\n1\n1\n-1561.7408\n-1545.8660\n-1561.6372\n\n\n0\n0\n2\n1\n1\n0\n-1283.5991\n-1267.7140\n-1283.4957\n\n\n0\n1\n2\n1\n1\n0\n-1437.4387\n-1421.5639\n-1437.3351\n\n\n0\n0\n2\n1\n1\n1\n-1338.1774\n-1318.3211\n-1338.0220\n\n\n0\n1\n2\n1\n1\n1\n-1560.3185\n-1540.4750\n-1560.1627\n\n\n0\n0\n3\n0\n1\n0\n-1289.2532\n-1273.3681\n-1289.1498\n\n\n0\n1\n3\n0\n1\n0\n-1332.7526\n-1316.8778\n-1332.6490\n\n\n0\n0\n3\n0\n1\n1\n-1433.8795\n-1414.0232\n-1433.7241\n\n\n0\n1\n3\n0\n1\n1\n-1564.0728\n-1544.2293\n-1563.9170\n\n\n0\n0\n3\n1\n1\n0\n-1366.9449\n-1347.0886\n-1366.7895\n\n\n0\n1\n3\n1\n1\n0\n-1438.9249\n-1419.0814\n-1438.7691\n\n\n0\n0\n3\n1\n1\n1\n-1432.5842\n-1408.7566\n-1432.3660\n\n\n1\n0\n0\n0\n1\n0\n-1334.4348\n-1326.4923\n-1334.4039\n\n\n1\n1\n0\n0\n1\n0\n-1332.6231\n-1324.6857\n-1332.5922\n\n\n1\n0\n0\n0\n1\n1\n-1559.8146\n-1547.9009\n-1559.7528\n\n\n1\n1\n0\n0\n1\n1\n-1562.8725\n-1550.9663\n-1562.8104\n\n\n1\n0\n0\n1\n1\n0\n-1437.9923\n-1426.0786\n-1437.9305\n\n\n1\n1\n0\n1\n1\n0\n-1438.2372\n-1426.3311\n-1438.1752\n\n\n1\n0\n0\n1\n1\n1\n-1558.7090\n-1542.8239\n-1558.6056\n\n\n1\n1\n0\n1\n1\n1\n-1561.5019\n-1545.6271\n-1561.3983\n\n\n1\n0\n1\n0\n1\n0\n-1365.0767\n-1353.1629\n-1365.0148\n\n\n1\n1\n1\n0\n1\n0\n-1332.8060\n-1320.8998\n-1332.7439\n\n\n1\n0\n1\n0\n1\n1\n-1577.7971\n-1561.9120\n-1577.6937\n\n\n1\n1\n1\n0\n1\n1\n-1561.6387\n-1545.7639\n-1561.5351\n\n\n1\n0\n1\n1\n1\n0\n-1463.7270\n-1447.8419\n-1463.6236\n\n\n1\n1\n1\n1\n1\n0\n-1437.2799\n-1421.4051\n-1437.1763\n\n\n1\n0\n1\n1\n1\n1\n-1576.0497\n-1556.1934\n-1575.8943\n\n\n1\n1\n1\n1\n1\n1\n-1560.1754\n-1540.3319\n-1560.0195\n\n\n1\n0\n2\n0\n1\n0\n-1365.5150\n-1349.6300\n-1365.4116\n\n\n1\n1\n2\n0\n1\n0\n-1357.1175\n-1341.2427\n-1357.0139\n\n\n1\n0\n2\n0\n1\n1\n-1577.6441\n-1557.7878\n-1577.4887\n\n\n1\n1\n2\n0\n1\n1\n-1560.1910\n-1540.3475\n-1560.0352\n\n\n1\n0\n2\n1\n1\n0\n-1465.3680\n-1445.5117\n-1465.2126\n\n\n1\n1\n2\n1\n1\n0\n-1435.8727\n-1416.0292\n-1435.7169\n\n\n1\n0\n2\n1\n1\n1\n-1576.0046\n-1552.1770\n-1575.7864\n\n\n1\n0\n3\n0\n1\n0\n-1363.6291\n-1343.7728\n-1363.4737\n\n\n1\n1\n3\n0\n1\n0\n-1357.4611\n-1337.6175\n-1357.3052\n\n\n1\n0\n3\n0\n1\n1\n-1576.9037\n-1553.0761\n-1576.6855\n\n\n1\n0\n3\n1\n1\n0\n-1463.3991\n-1439.5716\n-1463.1810\n\n\n2\n0\n0\n0\n1\n0\n-1367.6301\n-1355.7163\n-1367.5682\n\n\n2\n1\n0\n0\n1\n0\n-1334.0817\n-1322.1756\n-1334.0197\n\n\n2\n0\n0\n0\n1\n1\n-1578.5934\n-1562.7083\n-1578.4900\n\n\n2\n1\n0\n0\n1\n1\n-1562.5460\n-1546.6712\n-1562.4424\n\n\n2\n0\n0\n1\n1\n0\n-1466.4716\n-1450.5866\n-1466.3683\n\n\n2\n1\n0\n1\n1\n0\n-1438.2819\n-1422.4071\n-1438.1783\n\n\n2\n0\n0\n1\n1\n1\n-1576.8822\n-1557.0259\n-1576.7267\n\n\n2\n1\n0\n1\n1\n1\n-1561.0283\n-1541.1847\n-1560.8724\n\n\n2\n0\n1\n0\n1\n0\n-1365.6799\n-1349.7948\n-1365.5765\n\n\n2\n1\n1\n0\n1\n0\n-1359.5219\n-1343.6471\n-1359.4183\n\n\n2\n0\n1\n0\n1\n1\n-1576.7703\n-1556.9140\n-1576.6148\n\n\n2\n1\n1\n0\n1\n1\n-1573.2530\n-1553.4095\n-1573.0972\n\n\n2\n0\n1\n1\n1\n0\n-1464.4822\n-1444.6259\n-1464.3268\n\n\n2\n1\n1\n1\n1\n0\n-1458.0210\n-1438.1774\n-1457.8651\n\n\n2\n0\n1\n1\n1\n1\n-1575.0399\n-1551.2124\n-1574.8218\n\n\n2\n0\n2\n0\n1\n0\n-1363.6670\n-1343.8107\n-1363.5116\n\n\n2\n1\n2\n0\n1\n0\n-1357.5873\n-1337.7438\n-1357.4315\n\n\n2\n0\n2\n0\n1\n1\n-1575.9804\n-1552.1529\n-1575.7623\n\n\n2\n0\n2\n1\n1\n0\n-1463.3828\n-1439.5552\n-1463.1646\n\n\n2\n0\n3\n0\n1\n0\n-1375.6460\n-1351.8184\n-1375.4278\n\n\n3\n0\n0\n0\n1\n0\n-1365.6779\n-1349.7928\n-1365.5745\n\n\n3\n1\n0\n0\n1\n0\n-1333.9295\n-1318.0547\n-1333.8259\n\n\n3\n0\n0\n0\n1\n1\n-1576.9183\n-1557.0620\n-1576.7628\n\n\n3\n1\n0\n0\n1\n1\n-1566.7924\n-1546.9488\n-1566.6365\n\n\n3\n0\n0\n1\n1\n0\n-1464.4865\n-1444.6301\n-1464.3310\n\n\n3\n1\n0\n1\n1\n0\n-1441.3974\n-1421.5539\n-1441.2416\n\n\n3\n0\n0\n1\n1\n1\n-1575.1795\n-1551.3519\n-1574.9613\n\n\n3\n0\n1\n0\n1\n0\n-1376.4812\n-1356.6249\n-1376.3257\n\n\n3\n1\n1\n0\n1\n0\n-1357.5855\n-1337.7420\n-1357.4296\n\n\n3\n0\n1\n0\n1\n1\n-1577.3751\n-1553.5475\n-1577.1569\n\n\n3\n0\n1\n1\n1\n0\n-1462.5081\n-1438.6805\n-1462.2899\n\n\n3\n0\n2\n0\n1\n0\n-1374.7370\n-1350.9095\n-1374.5189\n\n\n4\n0\n0\n0\n1\n0\n-1363.7000\n-1343.8437\n-1363.5445\n\n\n4\n1\n0\n0\n1\n0\n-1332.4322\n-1312.5886\n-1332.2763\n\n\n4\n0\n0\n0\n1\n1\n-1578.6903\n-1554.8627\n-1578.4721\n\n\n4\n0\n0\n1\n1\n0\n-1463.6640\n-1439.8365\n-1463.4458\n\n\n4\n0\n1\n0\n1\n0\n-1371.6541\n-1347.8265\n-1371.4359\n\n\n\n\n\nManual Function\n#Displaying the models with min values\noutput[which.min(output$AIC),]\n\n\n   p d q P D Q      AIC       BIC      AICc\n93 4 0 0 0 1 1 -1578.69 -1554.863 -1578.472\n\n\nManual Function\noutput[which.min(output$BIC),]\n\n\n   p d q P D Q       AIC       BIC     AICc\n61 2 0 0 0 1 1 -1578.593 -1562.708 -1578.49\n\n\nManual Function\noutput[which.min(output$AICc),]\n\n\n   p d q P D Q       AIC       BIC     AICc\n61 2 0 0 0 1 1 -1578.593 -1562.708 -1578.49\n\n\nThe best model is ARIMA(4,0,0)(0,1,1)[12]\n\n\nManual Model Fitting\n\n\nManual Model Fit\nset.seed(222)\nmodel_output_m_ecn &lt;- capture.output(sarima(residuals_m_ecn, 4,0,0,0,1,1,12))\n\n\n\n\n\n\n\n\n\nManual Model Fit\n#model_output_m_ecn\ncat(model_output_m_ecn[37:52], model_output_m_ecn[length(model_output_m_ecn)], sep = \"\\n\") \n\n\nconverged\n&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;\n \nCoefficients: \n         Estimate     SE  t.value p.value\nar1        1.1597 0.0504  23.0243  0.0000\nar2       -0.2347 0.0772  -3.0420  0.0025\nar3       -0.0828 0.0771  -1.0736  0.2837\nar4        0.0883 0.0503   1.7549  0.0801\nsma1      -0.9275 0.0326 -28.4704  0.0000\nconstant   0.0005 0.0002   2.3120  0.0213\n\nsigma^2 estimated as 0.0009395301 on 386 degrees of freedom \n \nAIC = -4.032879  AICc = -4.032323  BIC = -3.961964 \n \n \n\n\n\nThe Standardized Residuals plot doesn’t show any apparent trends or seasonality, indicating that the model residuals are randomly distributed around zero\nThe ACF of Residuals plot exhibits all bars within the confidence bounds, suggesting that there’s no autocorrelation\nThe Normal Q-Q Plot of Std Residuals displays points that mostly align suggesting that the residuals are approximately normally distributed.\nThe p-values for the Ljung-Box statistic are mostly above the significance threshold of 0.05, implying that there’s no significant autocorrelation.\nThe significant positive value of ar1 and ar2 are both significant while ar3 and ar4 are not significant (p-values are greater than 0.05), which suggests they might not be useful in the model. The seasonal MA term is significant with a coefficient of -0.9275, indicating a strong seasonal effect.\n\nWhen comparing the models\n\nManual model - ARIMA(4,0,0)(0,1,1)[12]\nAuto Arima - ARIMA(2,1,1)(0,0,2)[12]\n\nAlmost similar Manual model is better in terms of p-value in the Ljung-Box"
  },
  {
    "objectID": "multivariate-ts-models.html#cross-validation",
    "href": "multivariate-ts-models.html#cross-validation",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "4. Cross-Validation",
    "text": "4. Cross-Validation\n\n(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n\n\nManual model - ARIMA(4,0,0)(0,1,1)[12] Auto Arima - ARIMA(2,1,1)(0,0,2)[12]\n\n\nC-V\nsuppressWarnings({\n  n=length(residuals_m_ecn) # 404\n  k=72\n  #n-k=332; 332/12=27;\n \n  rmse1 &lt;- matrix(NA, 27,12) \n  rmse2 &lt;- matrix(NA,27,12)\n  rmse3 &lt;- matrix(NA,27,12)\n  err1 = c()\n  err2 = c()\n\n  st &lt;- tsp(residuals_m_ecn)[1]+(k-1)/12 \n\n  for(i in 1:27)\n  {\n    #xtrain &lt;- window(a10, start=st+(i-k+1)/12, end=st+i/12)\n    xtrain &lt;- window(residuals_m_ecn, end=st + i-1)\n    xtest &lt;- window(residuals_m_ecn, start=st + (i-1) + 1/12, end=st + i)\n  \n  \n    # auto arima\n    fit &lt;- Arima(xtrain, order=c(2,1,1), seasonal=list(order=c(0,0,2), period=12),\n                  include.drift=TRUE, method=\"CSS\") \n    fcast &lt;- forecast(fit, h=12)\n    # manual model\n    fit2 &lt;- Arima(xtrain, order=c(4,0,0), seasonal=list(order=c(0,1,1), period=12),\n                  include.drift=TRUE, method=\"CSS\") \n    fcast2 &lt;- forecast(fit2, h=12)\n  \n  \n\n    rmse1[i,1:length(xtest)]  &lt;- sqrt((fcast$mean-xtest)^2)\n    rmse2[i,1:length(xtest)] &lt;- sqrt((fcast2$mean-xtest)^2)\n  \n    ## This is mean absolute error\n    err1 = c(err1, abs(fcast$mean-xtest)) \n    err2 = c(err2, abs(fcast2$mean-xtest))\n  \n    # This is mean squared error\n    err3 = c(err1, (fcast$mean-xtest)^2)\n    err4 = c(err2, (fcast2$mean-xtest)^2)\n\n  \n  }\n})\n\n  plot(1:12, colMeans(rmse1,na.rm=TRUE), type=\"l\", col=2, xlab=\"horizon\", ylab=\"RMSE\")\n  lines(1:12, colMeans(rmse2,na.rm=TRUE), type=\"l\",col=3)\n\n  legend(\"topleft\",legend=c(\"Auto Arima model\",\"Manual Model\"),col=2:3,lty=1)\n\n\n\n\n\n\n\n\n\nC-V\n  RMSE1 &lt;- sqrt(mean(err3, na.rm = TRUE))\n  RMSE2 &lt;- sqrt(mean(err4, na.rm = TRUE))\n\n  cat('The RMSE of Auto Arima is', RMSE1, '\\n')\n\n\nThe RMSE of Auto Arima is 0.2591981 \n\n\nC-V\n  cat('The RMSE of Manually Selection is', RMSE2, '\\n')\n\n\nThe RMSE of Manually Selection is 0.2340468 \n\n\nThe Manual model, ARIMA(4,0,0)(0,1,1)[12] has a lower RMSE (0.2340468) compared to the Auto Arima model (0.2591981) for all horizons. Therefore, manual is better."
  },
  {
    "objectID": "multivariate-ts-models.html#model-fitting",
    "href": "multivariate-ts-models.html#model-fitting",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "5. Model Fitting",
    "text": "5. Model Fitting\nNow we will fit the Manual model - ARIMA(4,0,0)(0,1,1)[12]\n\n(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n\n\n\n\nModel Fit\nfit_ecng &lt;- Arima(elec_oil_ng[,\"Electricity\"],order=c(4,0,0),seasonal = c(0,1,1), xreg=xreg)\nsummary(fit_ecng)\n\n\nSeries: elec_oil_ng[, \"Electricity\"] \nRegression with ARIMA(4,0,0)(0,1,1)[12] errors \n\nCoefficients:\n         ar1     ar2     ar3      ar4     sma1  CrudeOil  NaturalGas\n      0.8859  0.0909  0.1035  -0.0862  -0.6998   -0.0057      0.0313\ns.e.  0.0507  0.0680  0.0722   0.0515   0.0435    0.0047      0.0041\n\nsigma^2 = 9.383e-05:  log likelihood = 1260.04\nAIC=-2504.09   AICc=-2503.71   BIC=-2472.32\n\nTraining set error measures:\n                       ME        RMSE        MAE        MPE      MAPE      MASE\nTraining set 0.0006091259 0.009456162 0.00738006 0.02727096 0.3428008 0.2657412\n                     ACF1\nTraining set -0.002015252\n\n\n\\[\n0.0313 * {NaturalGas} - 0.0057 * {CrudeOil} - 0.6998 x_t + n_t + 0.8859 n_{t-1} + 0.0909 n_{t-2} + 0.1035 n_{t-3} - 0.0862 n_{t-4} + \\epsilon_t\n\\]"
  },
  {
    "objectID": "multivariate-ts-models.html#forecast",
    "href": "multivariate-ts-models.html#forecast",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "6. Forecast",
    "text": "6. Forecast\n\n(SARIMAX) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n\n\n\n\nForecasting\nforecast(fit_ecng, h = 3, xreg=xreg) %&gt;%\n  autoplot() + xlab(\"Year\")+ theme_bw()"
  },
  {
    "objectID": "multivariate-ts-models.html#variable-selection-1",
    "href": "multivariate-ts-models.html#variable-selection-1",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "1. Variable Selection",
    "text": "1. Variable Selection\nThe selection of variables in VAR model is a critical process that informs the quality and reliability of our findings. For our analysis, we have chosen variables that have significant theoretical underpinnings to the energy and economic sectors.\n\n(VAR) Crude Oil Prices ~ CPI(VAR) Electricity Prices ~ Crude Oil Prices + Natural Gas Prices\n\n\n\n\nVariable\n#Plotting the combined data\nggplot(oil_cpi_df, aes(x = Date)) + \n  geom_line(aes(y = Log_Oil_Price, colour = \"Oil Price\")) +\n  geom_line(aes(y = Log_CPI, colour = \"CPI\")) +\n  scale_colour_manual(values = c(\"Oil Price\" = \"blue\", \"CPI\" = \"red\")) +\n  theme_bw() +\n  labs(title = \"Crude Oil Prices and CPI Over Time\",\n       x = \"Date\",\n       y = \"Logged Prices\",\n       color = \"Series\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\nThere is an upward trend in both series, although the crude oil prices show more volatility. The CPI appears to have a steadier upward trend. It’s important to remember that the visual correlation does not imply causation, and that’s why VAR model’s analysis will be used."
  },
  {
    "objectID": "multivariate-ts-models.html#varselect",
    "href": "multivariate-ts-models.html#varselect",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "2. VARselect",
    "text": "2. VARselect\nVARselect function provides several criteria to inform our choice: the Akaike Information Criterion (AIC), the Hannan-Quinn Information Criterion (HQ), Schwarz’s Bayesian Information Criterion (SC), and the Final Prediction Error (FPE). Lets use it for our models\n\n(VAR) Crude Oil Prices ~ CPI\n\n\n\n\nVAR Select\n#options(scipen = 999, digits = 3)\n\nVARselect(oil_cpi_mts, lag.max=10, type=\"both\")\n\n\n$selection\nAIC(n)  HQ(n)  SC(n) FPE(n) \n     7      4      2      7 \n\n$criteria\n                   1             2             3             4             5\nAIC(n) -1.706540e+01 -1.753725e+01 -1.755297e+01 -1.757543e+01 -1.758367e+01\nHQ(n)  -1.703366e+01 -1.748964e+01 -1.748949e+01 -1.749608e+01 -1.748845e+01\nSC(n)  -1.698527e+01 -1.741705e+01 -1.739271e+01 -1.737510e+01 -1.734328e+01\nFPE(n)  3.877860e-08  2.419201e-08  2.381489e-08  2.328615e-08  2.309537e-08\n                   6             7             8             9            10\nAIC(n) -1.759586e+01 -1.761055e+01 -1.760226e+01 -1.759344e+01 -1.758580e+01\nHQ(n)  -1.748477e+01 -1.748359e+01 -1.745943e+01 -1.743475e+01 -1.741123e+01\nSC(n)  -1.731540e+01 -1.729003e+01 -1.724167e+01 -1.719279e+01 -1.714508e+01\nFPE(n)  2.281610e-08  2.248403e-08  2.267202e-08  2.287382e-08  2.305070e-08\n\n\nSo we have p = 2, 4 ,7. Now the model is tested for different lags (p=2, p=4, p=7)\n\n\nVAR Select\nsummary(vars::VAR(oil_cpi_mts, p=2, type='both'))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: Log_Oil_Price, Log_CPI \nDeterministic variables: both \nSample size: 406 \nLog Likelihood: 2409.92 \nRoots of the characteristic polynomial:\n0.9886 0.9348 0.4581 0.4581\nCall:\nvars::VAR(y = oil_cpi_mts, p = 2, type = \"both\")\n\n\nEstimation results for equation Log_Oil_Price: \n============================================== \nLog_Oil_Price = Log_Oil_Price.l1 + Log_CPI.l1 + Log_Oil_Price.l2 + Log_CPI.l2 + const + trend \n\n                   Estimate Std. Error t value Pr(&gt;|t|)    \nLog_Oil_Price.l1  1.513e+00  5.357e-02  28.238   &lt;2e-16 ***\nLog_CPI.l1       -3.854e+00  1.761e+00  -2.188   0.0292 *  \nLog_Oil_Price.l2 -5.478e-01  5.310e-02 -10.318   &lt;2e-16 ***\nLog_CPI.l2        3.946e+00  1.752e+00   2.252   0.0248 *  \nconst            -3.423e-01  9.735e-01  -0.352   0.7253    \ntrend            -2.006e-05  3.631e-04  -0.055   0.9560    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.07873 on 400 degrees of freedom\nMultiple R-Squared: 0.9866, Adjusted R-squared: 0.9864 \nF-statistic:  5884 on 5 and 400 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation Log_CPI: \n======================================== \nLog_CPI = Log_Oil_Price.l1 + Log_CPI.l1 + Log_Oil_Price.l2 + Log_CPI.l2 + const + trend \n\n                   Estimate Std. Error t value Pr(&gt;|t|)    \nLog_Oil_Price.l1  1.007e-02  1.566e-03   6.431 3.61e-10 ***\nLog_CPI.l1        1.273e+00  5.149e-02  24.733  &lt; 2e-16 ***\nLog_Oil_Price.l2 -1.022e-02  1.552e-03  -6.587 1.42e-10 ***\nLog_CPI.l2       -2.804e-01  5.121e-02  -5.475 7.75e-08 ***\nconst             3.595e-02  2.846e-02   1.263    0.207    \ntrend             1.399e-05  1.061e-05   1.318    0.188    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.002301 on 400 degrees of freedom\nMultiple R-Squared: 0.9999, Adjusted R-squared: 0.9999 \nF-statistic: 7.861e+05 on 5 and 400 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n              Log_Oil_Price   Log_CPI\nLog_Oil_Price     0.0061986 9.030e-05\nLog_CPI           0.0000903 5.296e-06\n\nCorrelation matrix of residuals:\n              Log_Oil_Price Log_CPI\nLog_Oil_Price        1.0000  0.4984\nLog_CPI              0.4984  1.0000\n\n\n\n\nVAR Select\nsummary(vars::VAR(oil_cpi_mts, p=4, type='both'))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: Log_Oil_Price, Log_CPI \nDeterministic variables: both \nSample size: 404 \nLog Likelihood: 2414.407 \nRoots of the characteristic polynomial:\n0.9897 0.9609 0.5889 0.5889 0.5659 0.4815 0.4815 0.234\nCall:\nvars::VAR(y = oil_cpi_mts, p = 4, type = \"both\")\n\n\nEstimation results for equation Log_Oil_Price: \n============================================== \nLog_Oil_Price = Log_Oil_Price.l1 + Log_CPI.l1 + Log_Oil_Price.l2 + Log_CPI.l2 + Log_Oil_Price.l3 + Log_CPI.l3 + Log_Oil_Price.l4 + Log_CPI.l4 + const + trend \n\n                   Estimate Std. Error t value Pr(&gt;|t|)    \nLog_Oil_Price.l1  1.5608061  0.0575759  27.109  &lt; 2e-16 ***\nLog_CPI.l1       -1.9853813  1.9609868  -1.012    0.312    \nLog_Oil_Price.l2 -0.7612493  0.0999341  -7.618 1.94e-13 ***\nLog_CPI.l2        2.8337877  3.3101978   0.856    0.392    \nLog_Oil_Price.l3  0.1037514  0.1029446   1.008    0.314    \nLog_CPI.l3        0.1803294  3.2366219   0.056    0.956    \nLog_Oil_Price.l4  0.0712532  0.0600753   1.186    0.236    \nLog_CPI.l4       -1.0391837  1.8644777  -0.557    0.578    \nconst             0.1248810  0.9878076   0.126    0.899    \ntrend             0.0001294  0.0003671   0.353    0.725    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.07773 on 394 degrees of freedom\nMultiple R-Squared: 0.987,  Adjusted R-squared: 0.9867 \nF-statistic:  3333 on 9 and 394 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation Log_CPI: \n======================================== \nLog_CPI = Log_Oil_Price.l1 + Log_CPI.l1 + Log_Oil_Price.l2 + Log_CPI.l2 + Log_Oil_Price.l3 + Log_CPI.l3 + Log_Oil_Price.l4 + Log_CPI.l4 + const + trend \n\n                   Estimate Std. Error t value Pr(&gt;|t|)    \nLog_Oil_Price.l1  1.144e-02  1.675e-03   6.831 3.22e-11 ***\nLog_CPI.l1        1.351e+00  5.703e-02  23.689  &lt; 2e-16 ***\nLog_Oil_Price.l2 -1.582e-02  2.906e-03  -5.444 9.16e-08 ***\nLog_CPI.l2       -4.820e-01  9.627e-02  -5.006 8.38e-07 ***\nLog_Oil_Price.l3  6.090e-03  2.994e-03   2.034   0.0426 *  \nLog_CPI.l3        2.393e-01  9.413e-02   2.542   0.0114 *  \nLog_Oil_Price.l4 -1.850e-03  1.747e-03  -1.059   0.2904    \nLog_CPI.l4       -1.151e-01  5.423e-02  -2.123   0.0343 *  \nconst             3.509e-02  2.873e-02   1.221   0.2227    \ntrend             1.376e-05  1.068e-05   1.289   0.1982    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.002261 on 394 degrees of freedom\nMultiple R-Squared: 0.9999, Adjusted R-squared: 0.9999 \nF-statistic: 4.443e+05 on 9 and 394 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n              Log_Oil_Price   Log_CPI\nLog_Oil_Price     6.041e-03 8.746e-05\nLog_CPI           8.746e-05 5.110e-06\n\nCorrelation matrix of residuals:\n              Log_Oil_Price Log_CPI\nLog_Oil_Price        1.0000  0.4978\nLog_CPI              0.4978  1.0000\n\n\n\n\nVAR Select\nsummary(vars::VAR(oil_cpi_mts, p=7, type='both'))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: Log_Oil_Price, Log_CPI \nDeterministic variables: both \nSample size: 401 \nLog Likelihood: 2416.49 \nRoots of the characteristic polynomial:\n0.9797 0.9797 0.7956 0.776 0.776 0.687 0.687 0.6657 0.6135 0.6135 0.4821 0.4821 0.3546 0.07755\nCall:\nvars::VAR(y = oil_cpi_mts, p = 7, type = \"both\")\n\n\nEstimation results for equation Log_Oil_Price: \n============================================== \nLog_Oil_Price = Log_Oil_Price.l1 + Log_CPI.l1 + Log_Oil_Price.l2 + Log_CPI.l2 + Log_Oil_Price.l3 + Log_CPI.l3 + Log_Oil_Price.l4 + Log_CPI.l4 + Log_Oil_Price.l5 + Log_CPI.l5 + Log_Oil_Price.l6 + Log_CPI.l6 + Log_Oil_Price.l7 + Log_CPI.l7 + const + trend \n\n                   Estimate Std. Error t value Pr(&gt;|t|)    \nLog_Oil_Price.l1  1.5455402  0.0592849  26.070  &lt; 2e-16 ***\nLog_CPI.l1       -0.9973656  2.0458181  -0.488   0.6262    \nLog_Oil_Price.l2 -0.7650977  0.1004226  -7.619 2.01e-13 ***\nLog_CPI.l2        2.1152880  3.4265409   0.617   0.5374    \nLog_Oil_Price.l3  0.1488928  0.1074441   1.386   0.1666    \nLog_CPI.l3        0.0857705  3.5554205   0.024   0.9808    \nLog_Oil_Price.l4 -0.0530300  0.1082794  -0.490   0.6246    \nLog_CPI.l4        0.9602028  3.5437786   0.271   0.7866    \nLog_Oil_Price.l5  0.1767072  0.1093354   1.616   0.1069    \nLog_CPI.l5       -7.1012810  3.4906916  -2.034   0.0426 *  \nLog_Oil_Price.l6 -0.0641818  0.1050536  -0.611   0.5416    \nLog_CPI.l6        4.0894950  3.3029403   1.238   0.2164    \nLog_Oil_Price.l7 -0.0119001  0.0610300  -0.195   0.8455    \nLog_CPI.l7        0.8656182  1.9269410   0.449   0.6535    \nconst            -0.0144170  1.0273539  -0.014   0.9888    \ntrend             0.0000641  0.0003800   0.169   0.8662    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.07748 on 385 degrees of freedom\nMultiple R-Squared: 0.9872, Adjusted R-squared: 0.9867 \nF-statistic:  1985 on 15 and 385 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation Log_CPI: \n======================================== \nLog_CPI = Log_Oil_Price.l1 + Log_CPI.l1 + Log_Oil_Price.l2 + Log_CPI.l2 + Log_Oil_Price.l3 + Log_CPI.l3 + Log_Oil_Price.l4 + Log_CPI.l4 + Log_Oil_Price.l5 + Log_CPI.l5 + Log_Oil_Price.l6 + Log_CPI.l6 + Log_Oil_Price.l7 + Log_CPI.l7 + const + trend \n\n                   Estimate Std. Error t value Pr(&gt;|t|)    \nLog_Oil_Price.l1  1.227e-02  1.704e-03   7.202 3.15e-12 ***\nLog_CPI.l1        1.324e+00  5.879e-02  22.517  &lt; 2e-16 ***\nLog_Oil_Price.l2 -1.663e-02  2.886e-03  -5.762 1.70e-08 ***\nLog_CPI.l2       -4.692e-01  9.846e-02  -4.766 2.67e-06 ***\nLog_Oil_Price.l3  8.472e-03  3.087e-03   2.744  0.00635 ** \nLog_CPI.l3        1.873e-01  1.022e-01   1.833  0.06753 .  \nLog_Oil_Price.l4 -8.130e-03  3.111e-03  -2.613  0.00933 ** \nLog_CPI.l4        1.242e-01  1.018e-01   1.220  0.22332    \nLog_Oil_Price.l5  5.176e-03  3.142e-03   1.648  0.10025    \nLog_CPI.l5       -2.383e-01  1.003e-01  -2.376  0.01800 *  \nLog_Oil_Price.l6 -3.104e-03  3.019e-03  -1.028  0.30451    \nLog_CPI.l6        2.180e-01  9.491e-02   2.297  0.02213 *  \nLog_Oil_Price.l7  1.693e-03  1.754e-03   0.966  0.33488    \nLog_CPI.l7       -1.524e-01  5.537e-02  -2.752  0.00621 ** \nconst             3.427e-02  2.952e-02   1.161  0.24647    \ntrend             1.421e-05  1.092e-05   1.301  0.19396    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.002226 on 385 degrees of freedom\nMultiple R-Squared: 0.9999, Adjusted R-squared: 0.9999 \nF-statistic: 2.673e+05 on 15 and 385 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n              Log_Oil_Price   Log_CPI\nLog_Oil_Price     6.003e-03 8.983e-05\nLog_CPI           8.983e-05 4.957e-06\n\nCorrelation matrix of residuals:\n              Log_Oil_Price Log_CPI\nLog_Oil_Price        1.0000  0.5208\nLog_CPI              0.5208  1.0000\n\n\nIn the analysis of the VAR models with different lags, the objective is to determine which model best captures the dynamics of the relationship between crude oil prices and the Consumer Price Index (CPI) without overfitting the data.\n\nThe AIC and BIC continue to decrease as lags increase.\np = 2: Most coefficients are significant, indicating a good fit with fewer parameters.\np = 4: Starts to show non-significant coefficients, which could indicate overfitting.\np = 7: Many coefficients are not statistically significant\n\nWhile a higher number of lags may provide a more detailed understanding, it can also lead to overfitting and unnecessary complexity. Given that the model with p = 2 offers a balance between capturing sufficient dynamics and maintaining parsimony, it seems to be the most suitable choice for this analysis.\nVAR model with p = 2 lags is selected."
  },
  {
    "objectID": "multivariate-ts-models.html#cross-validation-1",
    "href": "multivariate-ts-models.html#cross-validation-1",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "3. Cross-Validation",
    "text": "3. Cross-Validation\n\n(VAR) Crude Oil Prices ~ CPI"
  },
  {
    "objectID": "multivariate-ts-models.html#forecasting",
    "href": "multivariate-ts-models.html#forecasting",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "4. Forecasting",
    "text": "4. Forecasting\n\n(VAR) Crude Oil Prices ~ CPI\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n← Previous Page: Univariate\nNext Page: FinancialTS →"
  },
  {
    "objectID": "exploratory-data-analysis.html",
    "href": "exploratory-data-analysis.html",
    "title": "Exploratory Data Analysis",
    "section": "",
    "text": "Time Series Plot\nIn this section, we delve into time series data, focusing on the energy sector’s economic impact. Time series analysis is pivotal in understanding the temporal patterns and trends within data points collected sequentially over time. By employing time series plots, we gain invaluable insights into the underlying structures of our datasets, such as trends, seasonality, and cyclical fluctuations.\nThe visualizations will present a detailed examination of several key data sets: Crude Oil Prices, Natural Gas Prices, Electricity Prices, GDP, and CPI. Each plot is designed to elucidate the temporal progression of these variables, providing a foundation for deeper analytical exploration. Through these visualizations, we aim to identify significant patterns, anomalies, and correlations within the data, enabling us to draw meaningful conclusions about the economic interplay between energy prices and broader economic indicators.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nPlot Crude Oil\n#Plotting with ggplot2\np_composite_crude_oil_1 &lt;- ggplot(composite_crude_oil_prices, aes(x = Date, y = Value)) +\n  geom_line(color = \"#99494d\") +\n  theme_minimal() + \n  labs(title = \"Cost of Crude Oil Over Time\", x = \"Date\", y = \"Value (USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))     \n\n\n#Plotting with ggplot2\np_composite_crude_oil_2 &lt;- ggplot(composite_crude_oil_prices, aes(x = Date, y = log(Value))) +\n  geom_line(color = \"#499995\") +\n  theme_minimal() + \n  labs(title = \"Log Cost of Crude Oil\", x = \"Date\", y = \"Value (USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\n\ngrid.arrange(p_composite_crude_oil_1, p_composite_crude_oil_2, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe time series plot for crude oil showcases the historical refiner acquisition costs. Observations include a long-term upward trend, significant volatility, and notable peaks, particularly around 2008 and 2011 and 2015. The recent years exhibit a declining trend post the last peak, highlighting the dynamic nature of crude oil prices.\nTrend: Increasing over the long term with recent decline.\nSeasonality: No clear seasonality observed due to the dominant influence of geopolitical and economic factors on oil prices.\nNature of Series: The series seems to be multiplicative, given the percentage changes and volatility patterns.\n\n\n\n\nPlot Natural Gas Prices\n#Plotting\np_citygate_gas &lt;- ggplot(citygate_gas_prices, aes(x = Date, y = Value)) +\n  geom_line(color = \"#99494d\") + \n  theme_minimal() + \n  labs(title = \"Natural Gas Price Over Time\", \n       x = \"Date\",\n       y = \"Price (USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\n\n#Plotting\np_citygate_gas_l &lt;- ggplot(citygate_gas_prices, aes(x = Date, y = log(Value))) +\n  geom_line(color = \"#499995\") + \n  theme_minimal() + \n  labs(title = \"Log of Natural Gas Price Over Time\", \n       x = \"Date\",\n       y = \"Price (USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\n\ngrid.arrange(p_citygate_gas, p_citygate_gas_l, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe natural gas price graph, reveals substantial fluctuations, a significant peaks in 2001, 2005, 2008 and around 2021, and recent volatile trends. Unlike crude oil, natural gas prices do not exhibit a clear long-term trend but return closer to the baseline after peaks.\nTrend: Fluctuating without a clear long-term direction.\nSeasonality: Less evident due to the market’s response to short-term supply and demand changes.\nNature of Series: Likely multiplicative, reflecting the proportional changes and variability in prices.\n\n\n\n\nPlot Electricity Prices\n#Plotting with ggplot2\np_total_electricity &lt;- ggplot(total_electricity_prices, aes(x = Date, y = Value)) +\n  geom_line(color = \"#99494d\") + \n  theme_minimal() + \n  labs(title = \"Average Price of Electricity to Ultimate Customers\",  \n       x = \"Date\",\n       y = \"Price (Cents per Kilowatthour)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\n#Plotting with ggplot2\np_total_electricity_l &lt;- ggplot(total_electricity_prices, aes(x = Date, y = log(Value))) +\n  geom_line(color = \"#499995\") + \n  theme_minimal() + \n  labs(title = \"Log of Electricity Price to Ultimate Customers\",  \n       x = \"Date\",\n       y = \"Price (Cents per Kilowatthour)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\ngrid.arrange(p_total_electricity, p_total_electricity_l, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe “Average Price of Electricity to Ultimate Customers” graph offers insights into the pricing trends of electricity, an essential commodity for consumers and industries alike.\nTrend: There is a upward trend showcasing long-term growth.\nSeasonality: Periodic oscillations in price could signify seasonal demand changes, driven by heating needs in winter or cooling in summer, impacting production costs and consumption patterns.\nNature of Series: Likely additive, characterized by a regular oscillations indicating seasonality.\n\n\n\n\nPlot GDP\n#Plotting with ggplot2\np_gdp &lt;- ggplot(gdp_data, aes(x = DATE, y = GDP)) +\n  geom_line(color = \"#99494d\") + \n  theme_minimal() +\n  labs(title = \"Gross Domestic Product Over Time\",  \n       x = \"Date\",\n       y = \"GDP (Billion USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\n#Plotting with ggplot2\np_gdp_l &lt;- ggplot(gdp_data, aes(x = DATE, y = log(GDP))) +\n  geom_line(color = \"#499995\") + \n  theme_minimal() +\n  labs(title = \"Log Gross Domestic Product Over Time\",  \n       x = \"Date\",\n       y = \"GDP (Billion USD)\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n\ngrid.arrange(p_gdp, p_gdp_l, nrow = 2)\n\n\n\n\n\n\n\n\n\nGDP growth exhibits an overall upward trend with a notable dip in 2020, possibly due to economic downturns because of the pandemic. The recovery post-dip indicates economic resilience.\nTrend: Increasing with acceleration in recent decades.\nSeasonality: Not applicable for GDP as it reflects economic trends and we cant see in the graph as well.\nNature of Series: Additive, considering the steady growth pattern with occasional dips and recoveries.\nWe can also observe that the log-transformed graph has linearized the exponential growth, making it easier to observe the rate of growth over time. For the GDP time series, we would be considering the log-transformed data for modeling purposes.\n\n\n\n\nPlot CPI\n#Plotting with ggplot2\np_cpi &lt;- ggplot(cpi_data, aes(x = DATE, y = CPIAUCSL)) +\n  geom_line(color = \"#99494d\") +  \n  theme_minimal() +\n  labs(title = \"Consumer Price Index Over Time\",  \n       x = \"Date\",\n       y = \"CPI\") +\n  theme(plot.title = element_text(hjust = 0.5)) \n\n#Plotting with ggplot2\np_cpi_l &lt;- ggplot(cpi_data, aes(x = DATE, y = log(CPIAUCSL))) +\n  geom_line(color = \"#499995\") +  \n  theme_minimal() +\n  labs(title = \"Log Consumer Price Index Over Time\",  \n       x = \"Date\",\n       y = \"CPI\") +\n  theme(plot.title = element_text(hjust = 0.5)) \n\ngrid.arrange(p_cpi, p_cpi_l, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe CPI graph illustrates a continuous upward trend, indicative of inflation. Recent increases suggest a period of higher inflation, potentially influenced by various economic factors.\nTrend: Consistently upward, indicating inflation.\nSeasonality: Not distinctly observable, as CPI reflects broader economic price changes\nNature of Series: Additive, with a steady increase in consumer prices over time.\nUpon examining the log-transformed CPI graph, we observe that it effectively linearizes the data’s exponential growth pattern. For modeling the CPI time series, the log-transformed data is preferable.\n\n\n\n\n\n\n\n\nLag Plots\nLag plots are essential tools in time series analysis, offering insights into the temporal dependency within the data. By comparing data points with their previous values (lags), we can uncover patterns, trends, and potential autocorrelation in the series. Each lag in the plot helps us to visualize how past values relate to current values, which is crucial for understanding the dynamics and forecasting future trends. In this section, we explore lag plots for various key economic indicators and energy prices, providing a deeper understanding of their time-dependent structures.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nLag Plot\n#Create lag plot\ngglagplot(oil_log_ts, do.lines=FALSE) + \n  xlab(\"Lags\") + \n  ylab(\"Value (USD)\") + \n  ggtitle(\"Lag Plot for Cost of Crude Oil (Log)\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + \n  theme_bw()+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\nThe lag plots for the Cost of Crude Oil reveal a positive autocorrelation. The presence of color-coded months suggests seasonal trends, though they are not starkly evident. As lags increase, the correlation weakens, diminishing predictive power over longer time lags.\n\nPositive Autocorrelation evident across the lags, suggesting that past prices influence future prices.\nThe strength of autocorrelation decreases with higher lags.\n\n\n\n\n\nLag Plot\n#Create lag plot\ngglagplot(gas_log_ts, do.lines=FALSE) + \n  xlab(\"Lags\") + \n  ylab(\"Price (USD)\") + \n  ggtitle(\"Lag Plot for Natural Gas Price (Log)\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + \n  theme_bw()+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\nNatural Gas Price lag plots display a positive autocorrelation, especially evident in the initial lags. With increasing lags, the data points become more dispersed, indicating a reduction in autocorrelation strength.\n\nStrong Autocorrelation in the initial lags, indicating past prices are good predictors for the near future.\nAs the lag increases, the correlation diminishes, which is common in time series data.\n\n\n\n\n\nLag Plot\n# Create lag plot\ngglagplot(elect_log_ts, do.lines=FALSE) + \n  xlab(\"Lags\") + \n  ylab(\"Price (Cents per Kilowatthour)\") + \n  ggtitle(\"Lag Plot for Average Price of Electricity (Log)\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + \n  theme_bw()+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\nElectricity price lag plots show a strong and consistent positive autocorrelation across all lags, suggesting stable and predictable price trends. The seasonal effect is visible, with certain months consistently clustering together.\n\nStrong positive auto-correlation is maintained across various lags.\nClear month-to-month price consistency suggests significant seasonality.\nThe strong correlation at higher lags implies underlying factors affecting electricity prices.\n\n\n\n\n\nLag Plot\n# Create lag plot\ngglagplot(gdp_log_ts, do.lines=FALSE) + \n  xlab(\"Lags\") + \n  ylab(\"GDP (Billion USD)\") + \n  ggtitle(\"Lag Plot for GDP\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + \n  theme_bw()+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\nGDP’s lag plots exhibit a very strong linear relationship across all lags, reflecting the steady economic growth.\n\nPersistent growth indicates steady economic progression.\nNo distinct seasonal patterns are visible, suggesting uniform economic growth across quarters.\n\n\n\n\n\nLag Plot\n# Create lag plot\ngglagplot(cpi_log_ts, do.lines=FALSE) + \n  xlab(\"Lags\") + \n  ylab(\"CPI\") + \n  ggtitle(\"Lag Plot for CPI\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + \n  theme_bw()+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\nThe CPI lag plots show a strong positive autocorrelation, indicating consistent inflation trends.\n\nReflects a steady inflation rate over the years.\nThe consistent distribution of quarterly colors across lags indicates an even inflation rate across all months.\n\n\n\n\n\n\n\n\n\nDecomposition Plots\nDecomposition plots are powerful tools in time series analysis, allowing us to dissect a series into its core components: trend, seasonality, and irregular (residual) components. This breakdown provides a clearer understanding of the underlying patterns and behaviors in the data. For instance, the trend component shows the long-term direction of the series, while the seasonal component highlights repeating patterns over fixed periods. The irregular component captures random fluctuations that are not part of the trend or seasonality. Here, we explore the decomposition plots for various key datasets, unveiling the distinct dynamics of each.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nDecomposition Plot\n# Plot the decomposed ts\ndecomposed_crude_oil &lt;- ts_decompose(oil_log_ts, \"multiplicative\",showline = TRUE)\ndecomposed_crude_oil\n\n\n\n\n\n\nThe decomposition plot for the Cost of Crude Oil offers a comprehensive view of the underlying patterns.\nTrend: Shows an upward trend until 2008, with fluctuations until 2014, followed by a downward trend, illustrating the market’s long-term dynamics.\nSeasonal: Demonstrates annual seasonal patterns, highlighting how external factors influence oil prices.\nRemainder: The residuals are relatively stable around zero, suggesting a good model fit with some sporadic spikes in 2020.\n\n\n\n\nDecomposition Plot\n#Plot the decomposed ts\ndecomposed_natural_gas &lt;- ts_decompose(gas_log_ts, \"multiplicative\",showline = TRUE)\ndecomposed_natural_gas\n\n\n\n\n\n\nThe decomposition plot for the Natural Gas Price offers a comprehensive view of the underlying patterns.\nTrend: Indicates a stable trend transitioning to volatility, reflecting the market’s evolving nature.\nSeasonal: Exhibits strong annual cycles, likely tied to demand changes with seasons\nRemainder: Spikes represent unexplained anomalies, possibly due to supply disruptions, especially around 2020.\n\n\n\n\nDecomposition Plot\n#Plot the decomposed ts\ndecomposed_electricity &lt;- ts_decompose(elect_log_ts, \"multiplicative\",showline = TRUE)\ndecomposed_electricity\n\n\n\n\n\n\nElectricity price decomposition highlights the stable growth and seasonality in the market.\nTrend: Shows a consistent rise, pointing to factors like inflation or cost increases in production affecting prices.\nSeasonal: A clear pattern suggests predictable consumption changes, possibly due to heating and cooling needs.\nRemainder: Minimal and stable residuals with occasional unexplained fluctuations.\n\n\n\n\nDecomposition Plot\n#Plot the decomposed ts\ndecomposed_gdp &lt;- ts_decompose(gdp_log_ts, \"multiplicative\",showline = TRUE)\ndecomposed_gdp\n\n\n\n\n\n\nGDP decomposition provides insights into economic growth patterns.\nTrend: Reflects steady economic growth with some acceleration, illustrating the economy’s long-term health.\nSeasonal: Negligible seasonality\nRemainder: Notable deviations, like the spike around 2020, could indicate economic shocks, such as the pandemic.\n\n\n\n\nDecomposition Plot\n#Plot the decomposed ts\ndecomposed_gdp &lt;- ts_decompose(cpi_log_ts, \"multiplicative\",showline = TRUE)\ndecomposed_gdp\n\n\n\n\n\n\nThe CPI decomposition plot sheds light on inflation trends.\nTrend: The upward trend signifies ongoing inflation, a key economic indicator.\nSeasonal: Minimal seasonality.\nRemainder: Small residuals suggest the model captures CPI’s main trends, with occasional anomalies.\nFor all the data series examined, the decomposition plots provide a detailed confirmation of the preliminary insights highlighted in Part 1. These plots dissect the time series into trend, seasonal, and irregular components, offering a more granular perspective that reinforces our initial analyses.\n\n\n\n\n\n\n\n\nACF & PACF Plots\nAutocorrelation Function (ACF) and Partial Autocorrelation Function (PACF) plots are crucial tools in time series analysis, helping to identify the type of model that best describes a series. The ACF plot shows the correlation of the series with its own lags, providing insights into the overall correlation structure and potential seasonality. On the other hand, the PACF plot reveals the direct effect of past values on the current value, helping to pinpoint the order of autoregressive models.\nBy examining the ACF and PACF plots, we can discern patterns that suggest the presence of autoregressive (AR) or moving average (MA) components in our time series models. Significant spikes in the ACF plot indicate potential AR terms, while significant spikes in the PACF plot suggest MA terms. These plots also assist in determining the stationarity of the series, a crucial aspect in time series modeling, where non-stationary data often require differencing to achieve stationarity.\nIn this section, we’ll explore the ACF and PACF plots for our datasets delving into their autocorrelation structures and deriving insights that will inform our model selection and forecasting approach.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nACF-PACF Plot\n#ACF Plot for Crude Oil\ncrude_oil_acf &lt;- ggAcf(oil_log_ts) + \n  ggtitle(\"ACF Plot for Crude Oil (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#PACF Plot for Crude Oil\ncrude_oil_pacf &lt;- ggPacf(oil_log_ts) + \n  ggtitle(\"PACF Plot for Crude Oil (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Arrange the plots\ngrid.arrange(crude_oil_acf, crude_oil_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for crude oil prices demonstrates prolonged significant autocorrelation, suggesting a non-stationary series. The gradual decline in correlation as lags increase indicates a potential long-term dependency or trend in the data.\nThe PACF plot shows significant spike at lag 1 and 2, followed by non-significant values\nThe ACF and PACF plots suggest considering an ARIMA model with ‘p’ to be 1 and 2. The slow decay in the ACF implies that differencing (d &gt; 0) may be necessary to achieve stationarity.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for Natural Gas\nnatural_gas_acf &lt;- ggAcf(gas_log_ts) + \n  ggtitle(\"ACF Plot for Natural Gas Price (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\nnatural_gas_pacf &lt;- ggPacf(gas_log_ts) + \n  ggtitle(\"PACF Plot for Natural Gas Price (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(natural_gas_acf, natural_gas_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for natural gas prices shows a very slow decay, suggesting non-stationarity and a need for differencing.\nThe PACF plot shows a significant spike at lag 1, followed by a drop-off.\nThe ACF and PACF plots suggest considering an ARIMA model with ‘p’ to be 1 and 2. The slow decay in the ACF implies that differencing (d &gt; 0) may be necessary to achieve stationarity.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for Electricity\nelectricity_acf &lt;- ggAcf(elect_log_ts) + \n  ggtitle(\"ACF Plot for Average Price of Electricity (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\nelectricity_pacf &lt;- ggPacf(elect_log_ts) + \n  ggtitle(\"PACF Plot for Average Price of Electricity (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngrid.arrange(electricity_acf, electricity_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for electricity shows a strong positive autocorrelation across all the lags indicating a potential MA term and a need for differencing due to non-stationarity.\nThe PACF plot shows a significant correlations at lag 1. The choice of ‘p’ could be 1 or 2 based on the first significant spikes.\nThe consistent autocorrelation in the ACF plot suggests a potential need for a higher-order MA term or differencing, leading to an ARIMA(p,d,q) model consideration.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for GDP\ngdp_acf &lt;- ggAcf(gdp_log_ts) + \n  ggtitle(\"ACF Plot for GDP (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ngdp_pacf &lt;- ggPacf(gdp_log_ts) + \n  ggtitle(\"PACF Plot for GDP (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\")) \n\ngrid.arrange(gdp_acf, gdp_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for GDP shows a persistent strong autocorrelation across all lags indicates non-stationarity, suggesting that differencing may be necessary.\nThe PACF plot have a sharp cutoff after lag 1 indicating an AR(1) process, suggesting that previous values have a significant impact on current GDP.\n\n\n\n\nACF-PACF Plot\n# ACF and PACF for CPI\ncpi_acf &lt;- ggAcf(cpi_log_ts) + \n  ggtitle(\"ACF Plot for CPI (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\ncpi_pacf &lt;- ggPacf(cpi_log_ts) + \n  ggtitle(\"PACF Plot for CPI (Log)\") + \n  theme_bw() +\n  geom_segment(lineend = \"butt\", color = \"#99494d\") +\n  geom_hline(yintercept = 0, color = \"#99494d\")+\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\")) \n\ngrid.arrange(cpi_acf, cpi_pacf, nrow = 2)\n\n\n\n\n\n\n\n\n\nThe ACF plot for CPI shows a sustained high autocorrelation across lags suggests a non-stationary time series, indicative of CPI’s long memory.\nThe PACF plot have a sharp spike and a cutoff after lag 1 indicating an AR(1) process, suggesting that previous values have a significant impact on current GDP.\nThe sustained autocorrelation in the ACF plot implies that differencing might be needed. An initial ARIMA(1,1,0) model could be considered.\n\n\n\n\n\n\n\n\nDickey-Fuller Test\nThe Dickey-Fuller test is a statistical test used to determine the presence of unit root in a time series and, consequently, whether the series is non-stationary. The null hypothesis of the test is that the time series is non-stationary. If the p-value is less than the chosen alpha level (usually 0.05), we reject the null hypothesis and infer that the series is stationary.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nD-F Test\n# Dickey-Fuller Test for Crude Oil\nadf_test_crude_oil &lt;- tseries::adf.test(oil_log_ts)\n\n# Display the test results\nadf_test_crude_oil\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  oil_log_ts\nDickey-Fuller = -2.509, Lag order = 7, p-value = 0.3623\nalternative hypothesis: stationary\n\n\nSince the p-value is greater than 0.05, we do not reject the null hypothesis and conclude that the crude oil price series is non-stationary, indicating that differencing or transformation may be required to achieve stationarity.\n\n\n\n\nD-F Test\n# Dickey-Fuller Test for Natural Gas\nadf_test_natural_gas &lt;- tseries::adf.test(gas_log_ts)\n\n# Display the test results\nadf_test_natural_gas\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  gas_log_ts\nDickey-Fuller = -2.3755, Lag order = 7, p-value = 0.4187\nalternative hypothesis: stationary\n\n\nThe p-value suggests that the natural gas price series is non-stationary, reinforcing the need for potential differencing or other transformations to stabilize the series.\n\n\n\n\nD-F Test\n# Dickey-Fuller Test for Electricity\nadf_test_electricity &lt;- tseries::adf.test(elect_log_ts)\n\n# Display the test results\nadf_test_electricity\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  elect_log_ts\nDickey-Fuller = -2.1586, Lag order = 7, p-value = 0.5103\nalternative hypothesis: stationary\n\n\nWith the p-value well above 0.05, the electricity price series is considered non-stationary, indicating that adjustments are necessary to model the series accurately.\n\n\n\n\nD-F Test\n# Dickey-Fuller Test for GDP\nsuppressWarnings(adf_test_gdp &lt;- tseries::adf.test(gdp_log_ts))\n\n\n# Display the test results\nadf_test_gdp\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  gdp_log_ts\nDickey-Fuller = -2.2406, Lag order = 5, p-value = 0.4764\nalternative hypothesis: stationary\n\n\nThe extremely high p-value indicates that the GDP series is strongly non-stationary, suggesting that it would benefit from differencing or other methods to achieve stationarity.\n\n\n\n\nD-F Test\n# Dickey-Fuller Test for CPI\nadf_test_cpi &lt;- tseries::adf.test(cpi_log_ts)\n\n# Display the test results\nadf_test_cpi\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  cpi_log_ts\nDickey-Fuller = -1.6417, Lag order = 7, p-value = 0.7288\nalternative hypothesis: stationary\n\n\nThe CPI series is also non-stationary based on the high p-value, indicating that preprocessing steps are needed before further analysis or modeling.\n\n\n\n\n\n\nThese Dickey-Fuller test results across different datasets corroborate our earlier analyses and ACF & PACF plot interpretations, showing a common theme of non-stationarity in the series.\n\n\nDetrend VS Difference\nDetrending and differencing are two methods used to make time series data stationary, it involves removing the underlying trend from the data, while differencing focuses on the changes between consecutive observations.\nDetrending typically subtracts the estimated trend component from the original series, while differencing transforms the series into the sequence of differences between adjacent values. While detrending addresses the trend, differencing can help eliminate both trend and seasonality, making the series stationary.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nPlot\n#Plot the residuals\nplot1_crude_oil &lt;- autoplot(resid_crude_oil_ts_log, series=\"Detrended Crude Oil\", colour = \"#499995\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Residuals\") +\n  ggtitle(\"Detrended Crude Oil (Log)\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Differencing plot\nplot2_crude_oil &lt;- autoplot(diff(oil_log_ts), series = \"First Difference Crude Oil\", colour = \"#99494d\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Differences\") +\n  ggtitle(\"First Difference Crude Oil (Log)\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Arrange plots\ngrid.arrange(plot1_crude_oil, plot2_crude_oil, nrow = 2)\n\n\n\n\n\n\n\n\n\nDetrended:\nThe residuals after detrending indicate that linear detrending might not fully account for all underlying components, as patterns still emerge.\nFirst Difference:\nThe differenced series shows fluctuations around zero, indicative of improved stationarity. While the mean appears stabilized, examining autocorrelation in the differenced data is crucial to confirm stationarity fully.\n\n\n\n\nPlot\n#Plot the residuals\nplot1_natural_gas &lt;- autoplot(resid_natural_gas_ts, series=\"Detrended Natural Gas\", colour = \"#499995\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Residuals\") +\n  ggtitle(\"Detrended Natural Gas (Log)\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Differencing plot\nplot2_natural_gas &lt;- autoplot(diff(gas_log_ts), series = \"First Difference Natural Gas\", colour = \"#99494d\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Differences\") +\n  ggtitle(\"First Difference Natural Gas (Log)\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Arrange plots\ngrid.arrange(plot1_natural_gas, plot2_natural_gas, nrow = 2)\n\n\n\n\n\n\n\n\n\nDetrended:\nThe detrended series shows periods of volatility, indicating that removing the linear trend doesn’t capture all the data’s dynamics, remaining fluctuations may reflect other underlying components like seasonality\nFirst Difference:\nConsistent mean but varying volatility and a spike around 2020, which could be due to the pandemic\n\n\n\n\nPlot\n#Plot the residuals\nplot1_electricity &lt;- autoplot(resid_electricity_ts, series=\"Detrended Electricity\", colour = \"#499995\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Residuals\") +\n  ggtitle(\"Detrended Electricity (Log)\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Differencing plot\nplot2_electricity &lt;- autoplot(diff(elect_log_ts), series = \"First Difference Electricity\", colour = \"#99494d\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Differences\") +\n  ggtitle(\"First Difference Electricity (Log)\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Arrange plots\ngrid.arrange(plot1_electricity, plot2_electricity, nrow = 2)\n\n\n\n\n\n\n\n\n\nDetrended:\nThe detrended plot of electricity prices displays clear periodic fluctuations, suggesting the presence of seasonality.\nFirst Difference:\nThe first differenced series oscillates around a central mean, which is indicative of stationarity in the mean of the series. However, the consistent pattern of spikes followed by a return to the mean—indicates a strong seasonal component.\n\n\n\n\nPlot\n#Plot the residuals\nplot1_log_gdp &lt;- autoplot(resid_log_gdp_ts, series=\"Detrended Log GDP\", colour = \"#499995\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Residuals\") +\n  ggtitle(\"Detrended Log GDP\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Differencing plot\nplot2_log_gdp &lt;- autoplot(diff(gdp_log_ts), series = \"First Difference Log GDP\", colour = \"#99494d\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Differences\") +\n  ggtitle(\"First Difference Log GDP\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n#Arrange plots\ngrid.arrange(plot1_log_gdp, plot2_log_gdp, nrow = 2)\n\n\n\n\n\n\n\n\n\nDetrended:\nThe detrended log-transformed GDP plot showcases that initially, the residuals fluctuate around zero and starting around 1990 a distinct downward trend. GDP growth rate is not constant and a simple linear model may not be sufficient to capture the complexities.\nFirst Difference:\nThe differenced series predominantly hovers around the zero line, which indicates that this transformation effectively removes the trend from the data, leading to a stationary series in terms of the mean. The substantial spike observed towards the end is likely due to the recent economic downturn due to the COVID-19 pandemic, which represents a significant economic shock not accounted for by typical GDP growth patterns.\n\n\n\n\nPlot\n#Plot the residuals\nplot1_log_cpi &lt;- autoplot(resid_log_cpi_ts, series=\"Detrended Log CPI\", colour = \"#499995\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Residuals\") +\n  ggtitle(\"Detrended Log CPI\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n#Differencing plot\nplot2_diff_log_cpi &lt;- autoplot(diff(cpi_log_ts), series = \"First Difference Log CPI\", colour = \"#99494d\") + \n  theme_bw() +\n  xlab(\"Time\") +\n  ylab(\"Differences\") +\n  ggtitle(\"First Difference Log CPI\") +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n#Arrange plots\ngrid.arrange(plot1_log_cpi, plot2_diff_log_cpi, nrow = 2)\n\n\n\n\n\n\n\n\n\nDetrended:\nThe detrended CPI plot reveals residuals that decline over a prolonged period before stabilizing and then increasing. This pattern suggests that a simple linear trend does not fully capture the complexity of the inflationary trend over time.\nFirst Difference:\nThe first difference plot for CPI demonstrates a series that fluctuates around a central mean value.\n\n\n\n\n\n\n\n\nMoving Average Smoothing\nMoving average smoothing is a time series forecasting method that can help identify long-term trends by smoothing out short-term fluctuations. By averaging the data over specific time windows, these methods filter out the ‘noise’ and offer a cleaner view of the direction in which the series is moving.\nIn our analysis, we employ moving averages as a means to discern and illustrate trends within the energy sector’s economic data. By choosing different window lengths for our moving averages, we can examine trends on various time scales:\nShort-Term Trends: A 5-period moving average (5-MA) can reveal insights into the short-term direction of the data, helping us to understand recent movements and immediate market responses.\nMedium-Term Trends: A 15-period moving average (15-MA) extends the horizon, smoothing out month-to-month volatility to focus on the quarterly or seasonal patterns.\nLong-Term Trends: With 20- and 30-period moving averages (20-MA and 30-MA), we delve into the long-term movements that reflect overarching trends and economic cycles.\n\nCrude OilNatural GasElectricityGDPCPI\n\n\n\n\nMA Plot\n#Ggplot\np &lt;- ggplot(crude_oil_df, aes(x = Date)) + \n  geom_line(aes(y = LOG_Value, color = \"Actual Data\")) +\n  geom_line(aes(y = ma5, color = \"5-MA\")) +\n  geom_line(aes(y = ma15, color = \"15-MA\")) +\n  geom_line(aes(y = ma20, color = \"20-MA\")) +\n  geom_line(aes(y = ma30, color = \"30-MA\")) +\n  xlab(\"Time\") + ylab(\"Value (USD)\") +\n  ggtitle('Crude Oil Price with Moving Averages (Log)') +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Convert ggplot object to plotly\nplotly::ggplotly(p)\n\n\n\n\n\n\n\n\n\n\nMA Plot\n#Ggplot\np_ng &lt;- ggplot(natural_gas_df, aes(x = Date)) + \n  geom_line(aes(y = LOG_Value, color = \"Actual Data\")) +\n  geom_line(aes(y = ma5, color = \"5-MA\")) +\n  geom_line(aes(y = ma15, color = \"15-MA\")) +\n  geom_line(aes(y = ma20, color = \"20-MA\")) +\n  geom_line(aes(y = ma30, color = \"30-MA\")) +\n  xlab(\"Time\") + ylab(\"Value (Price)\") +\n  ggtitle('Natural Gas Price with Moving Averages (Log)') +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Convert ggplot object to plotly\nplotly::ggplotly(p_ng)\n\n\n\n\n\n\n\n\n\n\nMA Plot\n#Ggplot\np_electricity &lt;- ggplot(total_electricity_prices, aes(x = Date)) + \n  geom_line(aes(y = LOG_Value, color = \"Actual Data\")) +\n  geom_line(aes(y = ma5, color = \"5-MA\")) +\n  geom_line(aes(y = ma15, color = \"15-MA\")) +\n  geom_line(aes(y = ma20, color = \"20-MA\")) +\n  geom_line(aes(y = ma30, color = \"30-MA\")) +\n  xlab(\"Time\") + ylab(\"Price (Cents per Kilowatthour)\") +\n  ggtitle('Electricity Price with Moving Averages (Log)') +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n#Convert ggplot object to plotly\nplotly::ggplotly(p_electricity)\n\n\n\n\n\n\n\n\n\n\nMA Plot\n#Ggplot\np_gdp &lt;- ggplot(gdp_data, aes(x = DATE)) + \n  geom_line(aes(y = LOG_GDP, color = \"Actual Data\")) +\n  geom_line(aes(y = ma5_log, color = \"5-MA\")) +\n  geom_line(aes(y = ma15_log, color = \"15-MA\")) +\n  geom_line(aes(y = ma20_log, color = \"20-MA\")) +\n  geom_line(aes(y = ma30_log, color = \"30-MA\")) +\n  xlab(\"Time\") + ylab(\"GDP (in billions)\") +\n  ggtitle('GDP with Moving Averages of Log-Transformed Data') +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"),\n        legend.title = element_blank())\n\n\n#Convert ggplot object to plotly\nplotly::ggplotly(p_gdp)\n\n\n\n\n\n\n\n\n\n\nMA Plot\n#Ggplot\np_cpi &lt;- ggplot(cpi_data, aes(x = DATE)) + \n  geom_line(aes(y = LOG_CPI, color = \"Actual Data\")) +\n  geom_line(aes(y = ma5_log, color = \"5-MA\")) +\n  geom_line(aes(y = ma15_log, color = \"15-MA\")) +\n  geom_line(aes(y = ma20_log, color = \"20-MA\")) +\n  geom_line(aes(y = ma30_log, color = \"30-MA\")) +\n  xlab(\"Time\") + ylab(\"CPIAUCSL\") +\n  ggtitle('CPI with Moving Averages of Log-Transformed Data') +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"),\n        legend.title = element_blank())\n\n\n#Convert ggplot object to plotly\nplotly::ggplotly(p_cpi)\n\n\n\n\n\n\n\n\n\n← Previous Page: Data Viz\nNext Page: Univariate →\n\n\n\n\n Back to top"
  },
  {
    "objectID": "introduction.html",
    "href": "introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "“To truly transform our economy, protect our security, and save our planet from the ravages of climate change, we need to ultimately make clean, renewable energy the profitable kind of energy.” – Barack Obama\nIn an era when the imperative of sustainability intersects with the dynamics of global energy markets, understanding the economic impact of the energy sector becomes crucial, and the statement by former President Barack Obama encapsulates the urgent need to transition towards a sustainable energy future, one that harmonizes economic growth, energy security, and environmental preservation. As the world grapples with the pressing challenges of climate change, energy production and consumption dynamics have emerged as a pivotal force shaping our economic landscapes.\nIn this project, I aim to delve deeper into the economic impact of different energy sources, exploring the intricate relationship between energy prices, specifically crude oil, and natural gas, and their production and shedding light on the growing role of renewable energy and its impact on traditional energy markets. Additionally, investigating the relationship between energy prices and major economic indicators such as the Gross Domestic Product (GDP) and the Consumer Price Index (CPI), uncovering their ripple effects, if any, in the economy.\nBy meticulously analyzing data from various sectors, including historical energy prices, electricity costs, economic indicators, and renewable energy production, this project aims to uncover valuable insights that could inform policy decisions, business strategies, and future research endeavors.\n\n\nBefore diving into the intricate details, it is essential to understand the broader landscape. This project aims to link the price dynamics of crude oil and natural gas with their effects on the economy, providing a comprehensive analysis within the global context. Understanding this bigger picture is crucial for grasping the multi-layered relationships between the energy sector and economic development.\n\n\n\nFigure 1: This blueprint represents the project’s scope.\n\n\nThis visual representation will serve as a guide through the thematic explorations of the project, setting the stage for a deep dive into the complex interplay between energy dynamics and economic indicators.\n\n\n\nTo navigate the complexities of how energy prices influence the U.S. economy, this project will dissect the data through multiple lenses, each offering a unique insight into the dynamics at play. The following analytical angles will structure our exploration:\n\n\nWe will examine the historical trends and volatility in crude oil and natural gas markets. Understanding these patterns is critical in comprehending how energy costs affect the broader economy and predicting future trends.\n\n\n\nA critical angle is the relationship between energy prices and primary economic indicators, like GDP and CPI. This perspective will allow us to measure the real impact of energy market fluctuations on financial health and consumer purchasing power.\n\n\n\nAs the energy sector evolves, so too does its economic impact. We’ll assess how the increasing presence of renewable energy in the national energy portfolio influences the traditional energy market and what that means for the future economy.\n\n\n\nDifferent sectors respond to energy price changes in various ways. We’ll delve into sector-specific data, mainly focusing on how underlying energy prices shape electricity costs for residential, commercial, industrial, and transportation sectors.\n\n\n\nEnergy policies can have a profound impact on prices and market stability. We will analyze the effects of past and present energy policies on market behavior and economic outcomes, offering insights into effective policy frameworks.\nEach of these angles will be explored through rigorous data analysis, employing time series methodologies to unpack the intricate relationship between energy markets and economic performance. By examining these perspectives, we aim to build a holistic understanding of the energy-economy nexus and provide actionable insights for policymakers, businesses, and consumers.\n\n\n\n\n\nThe interplay between energy market fluctuations and economic indicators is a focal point of numerous studies, shedding light on how changes in energy prices influence economic growth, inflation, and regional development. This section integrates existing literature that provides the backdrop for our exploration of energy price impacts on the U.S. economy, with a particular focus on studies from the United States and China.\nThe report by the Congressional Budget Office titled The Economic Effects of Recent Increases in Energy Prices examines the response of the U.S. economy to significant energy price shifts from 2004 to 2006. Despite notable increases in crude oil and natural gas prices, the report finds that the overall U.S. economy exhibited resilience, with moderate impacts on GDP, employment, and inflation. This resilience is attributed to robust economic conditions, effective monetary policies, and increased economic flexibility and stability over the years. This study provides a crucial understanding of how the U.S. economy adapts to energy price fluctuations, offering a valuable perspective for our analysis. The graph below from this report illustrates U.S. spending on petroleum as a percentage of the Gross Domestic Product (GDP), showing that, despite fluctuations in energy prices, the overall economic impact has been moderate. However, certain periods have seen significant spikes in energy spending relative to the nation’s economic output.\n\nIn contrast, Liping Wang’s study on The impact of energy price fluctuations on regional economic development based on a panel data model focuses on China, revealing the differential regional impacts of energy price changes on economic growth. Using data from 30 provinces and employing the FMOLS co-integration estimation method, Wang’s findings indicate that energy price variations, particularly in coal, electricity, and oil, have a tangible yet varying impact on China’s regional economies. The study underscores the significance of understanding regional disparities in energy price impacts, which could provide insightful comparisons for analyzing the U.S. context in our project.\nThese studies collectively enrich our investigation, offering comparative insights and methodological approaches to understanding the nuanced relationships between energy prices and economic indicators. By drawing on these studies, our project aims to dissect the specific dynamics within the U.S. energy market and its economic ramifications, enhancing our understanding and contributing to the broader discourse on energy economics.\n\n\n\nHere are the guiding questions that will guide the research by shedding light on the multifaceted nature of the relationship between the energy sector and the economy:\n\nHow have crude oil price fluctuations correlated with changes in the U.S. Gross Domestic Product (GDP)?\nWhat trends can be identified in natural gas prices, and how have they historically impacted the cost of electricity for various consumer sectors?\nIn periods of significant oil price changes, how has the Consumer Price Index (CPI) reacted, particularly with respect to energy-intensive goods and services?\nHow do increases in natural gas prices affect the industrial sector’s energy expenses compared to the residential and commercial sectors?\nWhat is the relationship between crude oil prices and transportation sector electricity costs, and how does this relationship affect broader transportation industry economics?\nCan we identify a lag effect between changes in crude oil and natural gas prices and subsequent adjustments in electricity pricing across different sectors?\nTo what extent do variations in crude oil and natural gas prices explain the year-to-year variability in the U.S. inflation rate?\nHow have renewable energy production trends influenced the electricity pricing strategies of utility companies in the residential sector?\nDuring times of high volatility in energy prices, how resilient has the U.S. economy been in terms of maintaining growth and managing inflation?\nWhat patterns emerge when comparing the energy prices with the economic growth cycles, and what might this imply for future economic planning and energy policy?\n\n\n\n\n[1] Wang, L. (2022). Research on the impact of energy price fluctuations on regional economic development based on panel data model. Resources Policy, 75, 102484. https://doi.org/10.1016/j.resourpol.2021.102484\n[2] Congressional Budget Office. (2006, July). The economic effects of recent increases in energy prices (Pub. No. 2835). The Congress of the United States, Congressional Budget Office. https://www.cbo.gov/system/files?file=2018-10/07-21-energy-dist.pdf\n[3] https://www.eia.gov/totalenergy/data/monthly/\nNext Page: Data Sources →"
  },
  {
    "objectID": "introduction.html#bigger-picture",
    "href": "introduction.html#bigger-picture",
    "title": "Introduction",
    "section": "",
    "text": "Before diving into the intricate details, it is essential to understand the broader landscape. This project aims to link the price dynamics of crude oil and natural gas with their effects on the economy, providing a comprehensive analysis within the global context. Understanding this bigger picture is crucial for grasping the multi-layered relationships between the energy sector and economic development.\n\n\n\nFigure 1: This blueprint represents the project’s scope.\n\n\nThis visual representation will serve as a guide through the thematic explorations of the project, setting the stage for a deep dive into the complex interplay between energy dynamics and economic indicators."
  },
  {
    "objectID": "introduction.html#analytical-angles",
    "href": "introduction.html#analytical-angles",
    "title": "Introduction",
    "section": "",
    "text": "To navigate the complexities of how energy prices influence the U.S. economy, this project will dissect the data through multiple lenses, each offering a unique insight into the dynamics at play. The following analytical angles will structure our exploration:\n\n\nWe will examine the historical trends and volatility in crude oil and natural gas markets. Understanding these patterns is critical in comprehending how energy costs affect the broader economy and predicting future trends.\n\n\n\nA critical angle is the relationship between energy prices and primary economic indicators, like GDP and CPI. This perspective will allow us to measure the real impact of energy market fluctuations on financial health and consumer purchasing power.\n\n\n\nAs the energy sector evolves, so too does its economic impact. We’ll assess how the increasing presence of renewable energy in the national energy portfolio influences the traditional energy market and what that means for the future economy.\n\n\n\nDifferent sectors respond to energy price changes in various ways. We’ll delve into sector-specific data, mainly focusing on how underlying energy prices shape electricity costs for residential, commercial, industrial, and transportation sectors.\n\n\n\nEnergy policies can have a profound impact on prices and market stability. We will analyze the effects of past and present energy policies on market behavior and economic outcomes, offering insights into effective policy frameworks.\nEach of these angles will be explored through rigorous data analysis, employing time series methodologies to unpack the intricate relationship between energy markets and economic performance. By examining these perspectives, we aim to build a holistic understanding of the energy-economy nexus and provide actionable insights for policymakers, businesses, and consumers."
  },
  {
    "objectID": "introduction.html#literature-review",
    "href": "introduction.html#literature-review",
    "title": "Introduction",
    "section": "",
    "text": "The interplay between energy market fluctuations and economic indicators is a focal point of numerous studies, shedding light on how changes in energy prices influence economic growth, inflation, and regional development. This section integrates existing literature that provides the backdrop for our exploration of energy price impacts on the U.S. economy, with a particular focus on studies from the United States and China.\nThe report by the Congressional Budget Office titled The Economic Effects of Recent Increases in Energy Prices examines the response of the U.S. economy to significant energy price shifts from 2004 to 2006. Despite notable increases in crude oil and natural gas prices, the report finds that the overall U.S. economy exhibited resilience, with moderate impacts on GDP, employment, and inflation. This resilience is attributed to robust economic conditions, effective monetary policies, and increased economic flexibility and stability over the years. This study provides a crucial understanding of how the U.S. economy adapts to energy price fluctuations, offering a valuable perspective for our analysis. The graph below from this report illustrates U.S. spending on petroleum as a percentage of the Gross Domestic Product (GDP), showing that, despite fluctuations in energy prices, the overall economic impact has been moderate. However, certain periods have seen significant spikes in energy spending relative to the nation’s economic output.\n\nIn contrast, Liping Wang’s study on The impact of energy price fluctuations on regional economic development based on a panel data model focuses on China, revealing the differential regional impacts of energy price changes on economic growth. Using data from 30 provinces and employing the FMOLS co-integration estimation method, Wang’s findings indicate that energy price variations, particularly in coal, electricity, and oil, have a tangible yet varying impact on China’s regional economies. The study underscores the significance of understanding regional disparities in energy price impacts, which could provide insightful comparisons for analyzing the U.S. context in our project.\nThese studies collectively enrich our investigation, offering comparative insights and methodological approaches to understanding the nuanced relationships between energy prices and economic indicators. By drawing on these studies, our project aims to dissect the specific dynamics within the U.S. energy market and its economic ramifications, enhancing our understanding and contributing to the broader discourse on energy economics."
  },
  {
    "objectID": "introduction.html#guiding-questions",
    "href": "introduction.html#guiding-questions",
    "title": "Introduction",
    "section": "",
    "text": "Here are the guiding questions that will guide the research by shedding light on the multifaceted nature of the relationship between the energy sector and the economy:\n\nHow have crude oil price fluctuations correlated with changes in the U.S. Gross Domestic Product (GDP)?\nWhat trends can be identified in natural gas prices, and how have they historically impacted the cost of electricity for various consumer sectors?\nIn periods of significant oil price changes, how has the Consumer Price Index (CPI) reacted, particularly with respect to energy-intensive goods and services?\nHow do increases in natural gas prices affect the industrial sector’s energy expenses compared to the residential and commercial sectors?\nWhat is the relationship between crude oil prices and transportation sector electricity costs, and how does this relationship affect broader transportation industry economics?\nCan we identify a lag effect between changes in crude oil and natural gas prices and subsequent adjustments in electricity pricing across different sectors?\nTo what extent do variations in crude oil and natural gas prices explain the year-to-year variability in the U.S. inflation rate?\nHow have renewable energy production trends influenced the electricity pricing strategies of utility companies in the residential sector?\nDuring times of high volatility in energy prices, how resilient has the U.S. economy been in terms of maintaining growth and managing inflation?\nWhat patterns emerge when comparing the energy prices with the economic growth cycles, and what might this imply for future economic planning and energy policy?"
  },
  {
    "objectID": "introduction.html#reference",
    "href": "introduction.html#reference",
    "title": "Introduction",
    "section": "",
    "text": "[1] Wang, L. (2022). Research on the impact of energy price fluctuations on regional economic development based on panel data model. Resources Policy, 75, 102484. https://doi.org/10.1016/j.resourpol.2021.102484\n[2] Congressional Budget Office. (2006, July). The economic effects of recent increases in energy prices (Pub. No. 2835). The Congress of the United States, Congressional Budget Office. https://www.cbo.gov/system/files?file=2018-10/07-21-energy-dist.pdf\n[3] https://www.eia.gov/totalenergy/data/monthly/\nNext Page: Data Sources →"
  }
]